"use strict";(self.webpackChunkcommonlands_web=self.webpackChunkcommonlands_web||[]).push([[5209],{32500:function(e,t,i){i.d(t,{I:function(){return x},b:function(){return w}});var n,a,r,o=i(30168),s=i(92026),l=i(6394),c=i(37081),u=i(33280),h=i(94951),d=i(15226),p=i(26461),f=i(116),v=i(82552),_=i(82999),g=i(58406),y=i(98634),m=i(64201),b=i(19253),M=i(25920),S=i(4760);function w(e){var t=new m.kG,i=t.vertex,w=t.fragment;return(0,v.Sv)(i,e),t.include(h.w,e),t.attributes.add(S.T.POSITION,"vec3"),t.attributes.add(S.T.UV0,"vec2"),t.varyings.add("vpos","vec3"),e.hasMultipassTerrain&&t.varyings.add("depth","float"),i.uniforms.add(new _.A("textureCoordinateScaleFactor",(function(e){return(0,s.pC)(e.texture)&&(0,s.pC)(e.texture.descriptor.textureCoordinateScaleFactor)?e.texture.descriptor.textureCoordinateScaleFactor:l.O}))),i.code.add((0,y.H)(n||(n=(0,o.Z)(["\n    void main(void) {\n      vpos = position;\n      ","\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "])),e.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":"")),t.include(u.f5,e),t.include(d.l,e),w.uniforms.add([new b.A("tex",(function(e){return e.texture})),new g.p("opacity",(function(e){return e.opacity}))]),t.varyings.add("vTexCoord","vec2"),e.output===c.H.Alpha?w.code.add((0,y.H)(a||(a=(0,o.Z)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ",") {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",y.H.float(p.F))):(w.include(f.Y),w.code.add((0,y.H)(r||(r=(0,o.Z)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ",") {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ","\n    }\n    "])),e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":"",y.H.float(p.F),e.transparencyPassType===M.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),t}var x=Object.freeze(Object.defineProperty({__proto__:null,build:w},Symbol.toStringTag,{value:"Module"}))},18300:function(e,t,i){i.d(t,{L:function(){return b},b:function(){return g}});var n,a,r=i(30168),o=i(14226),s=i(81949),l=i(88396),c=i(6394),u=i(8084),h=i(82999),d=i(58406),p=i(98634),f=i(8654),v=i(64201),_=i(4760);function g(e){var t=new v.kG;t.include(u.j,e);var i=t.vertex,s=t.fragment;return i.uniforms.add([new f.g("modelView",(function(e,t){return(0,o.w)(m,t.camera.viewMatrix,e.origin)})),new f.g("proj",(function(e,t){return t.camera.projectionMatrix})),new d.p("glowWidth",(function(e,t){return e.glowWidth*t.camera.pixelRatio})),new h.A("pixelToNDC",(function(e,t){return(0,l.s)(y,2/t.camera.fullViewport[2],2/t.camera.fullViewport[3])}))]),t.attributes.add(_.T.START,"vec3"),t.attributes.add(_.T.END,"vec3"),t.attributes.add(_.T.UP,"vec3"),t.attributes.add(_.T.EXTRUDE,"vec2"),t.varyings.add("uv","vec2"),t.varyings.add("vViewStart","vec3"),t.varyings.add("vViewEnd","vec3"),t.varyings.add("vViewPlane","vec4"),i.code.add((0,p.H)(n||(n=(0,r.Z)(["void main() {\nvec3 pos = mix(start, end, extrude.x);\nvec4 viewPos = modelView * vec4(pos, 1);\nvec4 projPos = proj * viewPos;\nvec2 ndcPos = projPos.xy / projPos.w;\nvec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;\nvec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);\nvec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);\nvec2 lxy = abs(sign(projExtrudeDir) - ndcPos);\nndcPos += length(lxy) * projExtrudeDir;\nvec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));\nvec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;\nvViewStart = (modelView * vec4(start, 1)).xyz;\nvViewEnd = (modelView * vec4(end, 1)).xyz;\nvViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));\nfloat xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;\nndcPos.x += xPaddingPixels * pixelToNDC.x;\nuv = ndcPos * 0.5 + 0.5;\ngl_Position = vec4(ndcPos, 0, 1);\n}"])))),s.uniforms.add(new d.p("perScreenPixelRatio",(function(e,t){return t.camera.perScreenPixelRatio}))),s.code.add((0,p.H)(a||(a=(0,r.Z)(["float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {\nvec3 origin = mix(start, end, 0.5);\nvec3 basis = end - origin;\nvec3 posAtOrigin = pos - origin;\nfloat x = dot(normalize(basis), posAtOrigin);\nfloat y = dot(plane.xyz, posAtOrigin);\nfloat dx = max(abs(x) - length(basis), 0.0);\nfloat dy = y;\nfloat dist = length(vec2(dx, dy));\nfloat width = fwidth(y);\nfloat maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;\nfloat pixelDist = dist / min(width, maxPixelDistance);\nreturn abs(pixelDist);\n}\nvoid main() {\nvec3 pos;\nvec3 normal;\nfloat depthDiscontinuityAlpha;\nif (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\ndiscard;\n}\nfloat distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);\nvec4 color = laserlineProfile(distance);\nfloat alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));\ngl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);\n}"])))),t}var y=(0,c.a)(),m=(0,s.c)(),b=Object.freeze(Object.defineProperty({__proto__:null,build:g},Symbol.toStringTag,{value:"Module"}))},83671:function(e,t,i){i.d(t,{L:function(){return X},b:function(){return I},d:function(){return L}});var n,a,r,o,s,l,c,u,h,d,p,f,v,_,g=i(30168),y=i(16889),m=i(88396),b=i(6394),M=i(11186),S=i(71353),w=i(90045),x=i(67077),C=i(85981),O=i(55652),E=i(23470),k=i(8084),A=i(24967),T=i(82999),P=i(49450),R=i(95276),D=i(58406),Z=i(98634),G=i(64201),L=(0,y.Vl)(6);function I(e){var t=new G.kG;t.extensions.add("GL_OES_standard_derivatives"),t.include(A.k),t.include(k.j,e);var i=t.fragment;if(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)if(i.uniforms.add(new D.p("maxPixelDistance",(function(t,i){return e.heightManifoldEnabled?2*i.camera.computeScreenPixelSizeAt(t.heightManifoldTarget):2*i.camera.computeScreenPixelSizeAt(t.lineVerticalPlaneSegment.origin)}))),i.code.add((0,Z.H)(n||(n=(0,g.Z)(["float planeDistancePixels(vec4 plane, vec3 pos) {\nfloat dist = dot(plane.xyz, pos) + plane.w;\nfloat width = fwidth(dist);\ndist /= min(width, maxPixelDistance);\nreturn abs(dist);\n}"])))),e.spherical){var y=function(e,t){return(0,M.m)(e,[0,0,0],t.camera.viewMatrix)};i.uniforms.add([new R.N("heightManifoldOrigin",(function(e,t){return function(e,t,i){(0,M.m)(e,t.heightManifoldTarget,i.camera.viewMatrix)}(N,e,t),y(H,t),(0,M.b)(H,H,N),(0,M.n)(j,H),j[3]=(0,M.l)(H),j})),new P.J("globalOrigin",(function(e,t){return y(N,t)})),new D.p("cosSphericalAngleThreshold",(function(e,t){return 1-Math.max(2,(0,M.i)(t.camera.eye,e.heightManifoldTarget)*t.camera.perRenderPixelRatio)/(0,M.l)(e.heightManifoldTarget)}))]),i.code.add((0,Z.H)(a||(a=(0,g.Z)(["float globeDistancePixels(float posInGlobalOriginLength) {\nfloat dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);\nfloat width = fwidth(dist);\ndist /= min(width, maxPixelDistance);\nreturn abs(dist);\n}\nfloat heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {\nvec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);\nfloat cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);\nvec3 posInGlobalOrigin = globalOrigin - pos;\nfloat posInGlobalOriginLength = length(posInGlobalOrigin);\nfloat sphericalDistance = globeDistancePixels(posInGlobalOriginLength);\nfloat planarDistance = planeDistancePixels(heightPlane, pos);\nreturn cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;\n}"]))))}else i.code.add((0,Z.H)(r||(r=(0,g.Z)(["float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {\nreturn planeDistancePixels(heightPlane, pos);\n}"]))));if(e.pointDistanceEnabled&&(i.uniforms.add(new D.p("maxPixelDistance",(function(e,t){return 2*t.camera.computeScreenPixelSizeAt(e.pointDistanceTarget)}))),i.code.add((0,Z.H)(o||(o=(0,g.Z)(["float sphereDistancePixels(vec4 sphere, vec3 pos) {\nfloat dist = distance(sphere.xyz, pos) - sphere.w;\nfloat width = fwidth(dist);\ndist /= min(width, maxPixelDistance);\nreturn abs(dist);\n}"]))))),e.intersectsLineEnabled&&(i.uniforms.add(new D.p("perScreenPixelRatio",(function(e,t){return t.camera.perScreenPixelRatio}))),i.code.add((0,Z.H)(s||(s=(0,g.Z)(["float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {\nfloat dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);\nreturn abs(dist) - radius;\n}"]))))),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&i.code.add((0,Z.H)(l||(l=(0,g.Z)(["bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {\nvec3 dir = end - start;\nfloat t2 = dot(dir, pos - start);\nfloat l2 = dot(dir, dir);\nreturn t2 >= 0.0 && t2 <= l2;\n}"])))),i.code.add((0,Z.H)(c||(c=(0,g.Z)(["void main() {\nvec3 pos;\nvec3 normal;\nfloat depthDiscontinuityAlpha;\nif (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\ndiscard;\n}\nvec4 color = vec4(0, 0, 0, 0);"])))),e.heightManifoldEnabled){i.uniforms.add([new T.A("angleCutoff",(function(e){return V(e)})),new R.N("heightPlane",(function(e,t){return z(e.heightManifoldTarget,e.renderCoordsHelper.worldUpAtPosition(e.heightManifoldTarget,N),t.camera.viewMatrix)}))]);var m=e.spherical?(0,Z.H)(u||(u=(0,g.Z)(["normalize(globalOrigin - pos)"]))):(0,Z.H)(h||(h=(0,g.Z)(["heightPlane.xyz"])));i.code.add((0,Z.H)(d||(d=(0,g.Z)(["\n    {\n      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, ",")));\n      vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));\n      color = max(color, heightManifoldColor * heightManifoldAlpha);\n    }\n    "])),m))}return e.pointDistanceEnabled&&(i.uniforms.add([new T.A("angleCutoff",(function(e){return V(e)})),new R.N("pointDistanceSphere",(function(e,t){return function(e,t){return(0,M.m)(Y,e.pointDistanceOrigin,t.camera.viewMatrix),Y[3]=(0,M.i)(e.pointDistanceOrigin,e.pointDistanceTarget),Y}(e,t)}))]),i.code.add((0,Z.H)(p||(p=(0,g.Z)(["{\nfloat pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);\nvec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);\nfloat pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));\ncolor = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);\n}"]))))),e.lineVerticalPlaneEnabled&&(i.uniforms.add([new T.A("angleCutoff",(function(e){return V(e)})),new R.N("lineVerticalPlane",(function(e,t){return function(e,t){var i=(0,C.KU)(e.lineVerticalPlaneSegment,.5,N),n=e.renderCoordsHelper.worldUpAtPosition(i,F),a=(0,M.n)(H,e.lineVerticalPlaneSegment.vector),r=(0,M.f)(j,n,a);return(0,M.n)(r,r),z(e.lineVerticalPlaneSegment.origin,r,t.camera.viewMatrix)}(e,t)})),new P.J("lineVerticalStart",(function(e,t){return function(e,t){var i=(0,M.c)(N,e.lineVerticalPlaneSegment.origin);return e.renderCoordsHelper.setAltitude(i,0),(0,M.m)(i,i,t.camera.viewMatrix)}(e,t)})),new P.J("lineVerticalEnd",(function(e,t){return function(e,t){var i=(0,M.a)(N,e.lineVerticalPlaneSegment.origin,e.lineVerticalPlaneSegment.vector);return e.renderCoordsHelper.setAltitude(i,0),(0,M.m)(i,i,t.camera.viewMatrix)}(e,t)}))]),i.code.add((0,Z.H)(f||(f=(0,g.Z)(["{\nif (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {\nfloat lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);\nvec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);\nfloat lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));\ncolor = max(color, lineVerticalColor * lineVerticalAlpha);\n}\n}"]))))),e.intersectsLineEnabled&&(i.uniforms.add([new T.A("angleCutoff",(function(e){return V(e)})),new P.J("intersectsLineStart",(function(e,t){return(0,M.m)(N,e.lineStartWorld,t.camera.viewMatrix)})),new P.J("intersectsLineEnd",(function(e,t){return(0,M.m)(N,e.lineEndWorld,t.camera.viewMatrix)})),new P.J("intersectsLineDirection",(function(e,t){return(0,M.c)(j,e.intersectsLineSegment.vector),j[3]=0,(0,M.n)(N,(0,w.t)(j,j,t.camera.viewMatrix))})),new D.p("intersectsLineRadius",(function(e){return e.intersectsLineRadius}))]),i.code.add((0,Z.H)(v||(v=(0,g.Z)(["{\nif (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {\nfloat intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);\nvec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);\nfloat intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));\ncolor = max(color, intersectsLineColor * intersectsLineAlpha);\n}\n}"]))))),i.code.add((0,Z.H)(_||(_=(0,g.Z)(["gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);\n}"])))),t}function V(e){return(0,m.s)(W,Math.cos(e.angleCutoff),Math.cos(Math.max(0,e.angleCutoff-(0,y.Vl)(2))))}function z(e,t,i){return(0,M.m)(U,e,i),(0,M.c)(j,t),j[3]=0,(0,w.t)(j,j,i),(0,O.Yq)(U,j,B)}var W=(0,b.a)(),N=(0,S.c)(),j=(0,x.c)(),F=(0,S.c)(),H=(0,S.c)(),U=(0,S.c)(),B=(0,O.Ue)(),Y=(0,E.c)(),X=Object.freeze(Object.defineProperty({__proto__:null,build:I,defaultAngleCutoff:L},Symbol.toStringTag,{value:"Module"}))},72511:function(e,t,i){i.d(t,{S:function(){return R},b:function(){return A}});var n,a,r,o,s,l,c,u,h,d,p=i(30168),f=i(67077),v=i(43505),_=i(37081),g=i(33280),y=i(94951),m=i(15226),b=i(26461),M=i(116),S=i(82552),w=i(49450),x=i(95276),C=i(98634),O=i(64201),E=i(25920),k=i(4760);function A(e){var t=new O.kG,i=e.hasMultipassTerrain&&(e.output===_.H.Color||e.output===_.H.Alpha);t.include(y.w,e),t.include(v.A,e),t.include(g.f5,e);var f=t.vertex,A=t.fragment;return A.include(M.Y),(0,S.Sv)(f,e),A.uniforms.add(new x.N("uColor",(function(e){return e.color}))),t.attributes.add(k.T.POSITION,"vec3"),t.varyings.add("vWorldPosition","vec3"),i&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add(k.T.OFFSET,"vec3"),e.shadingEnabled&&((0,S._8)(f),t.attributes.add(k.T.NORMAL,"vec3"),t.varyings.add("vViewNormal","vec3")),f.code.add((0,C.H)(n||(n=(0,p.Z)(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&f.code.add((0,C.H)(a||(a=(0,p.Z)(["vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;"])))),f.code.add((0,C.H)(r||(r=(0,p.Z)(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),i?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),i&&t.include(m.l,e),A.code.add((0,C.H)(o||(o=(0,p.Z)(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),i?"terrainDepthTest(gl_FragCoord, depth);":"")),e.shadingEnabled?(A.uniforms.add(new w.J("shadingDirection",(function(e){return e.shadingDirection}))),A.uniforms.add(new x.N("shadedColor",(function(e){return T(e.shadingTint,e.color)}))),A.code.add((0,C.H)(s||(s=(0,p.Z)(["vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(uColor, shadedColor, shadingFactor);"]))))):A.code.add((0,C.H)(l||(l=(0,p.Z)(["vec4 finalColor = uColor;"])))),A.code.add((0,C.H)(c||(c=(0,p.Z)(["\n      ","\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),e.output===_.H.ObjectAndLayerIdColor?(0,C.H)(u||(u=(0,p.Z)(["finalColor.a = 1.0;"]))):"",C.H.float(b.b),e.output===_.H.Alpha?(0,C.H)(h||(h=(0,p.Z)(["gl_FragColor = vec4(finalColor.a);"]))):"",e.output===_.H.Color?(0,C.H)(d||(d=(0,p.Z)(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.transparencyPassType===E.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),t}function T(e,t){var i=1-e[3],n=e[3]+t[3]*i;return 0===n?(P[3]=n,P):(P[0]=(e[0]*e[3]+t[0]*t[3]*i)/n,P[1]=(e[1]*e[3]+t[1]*t[3]*i)/n,P[2]=(e[2]*e[3]+t[2]*t[3]*i)/n,P[3]=t[3],P)}var P=(0,f.c)(),R=Object.freeze(Object.defineProperty({__proto__:null,build:A},Symbol.toStringTag,{value:"Module"}))},11316:function(e,t,i){i.d(t,{S:function(){return p},b:function(){return d}});var n,a,r=i(30168),o=i(82552),s=i(95276),l=i(58406),c=i(98634),u=i(64201),h=i(4760);function d(e){var t=new u.kG;t.extensions.add("GL_OES_standard_derivatives");var i=t.vertex,d=t.fragment,p=t.attributes,f=t.varyings;return(0,o.Sv)(i,e),p.add(h.T.POSITION,"vec3"),p.add(h.T.UV0,"vec2"),f.add("vUV","vec2"),i.code.add((0,c.H)(n||(n=(0,r.Z)(["void main(void) {\nvUV = uv0;\ngl_Position = proj * view * vec4(position, 1.0);\n}"])))),d.uniforms.add([new s.N("backgroundColor",(function(e){return e.backgroundColor})),new s.N("gridColor",(function(e){return e.gridColor})),new l.p("gridWidth",(function(e){return e.gridWidth}))]),d.code.add((0,c.H)(a||(a=(0,r.Z)(["void main() {\nconst float LINE_WIDTH = 1.0;\nvec2 uvScaled = vUV * gridWidth;\nvec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));\nvec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);\ngrid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);\ngrid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);\nfloat gridFade = max(grid.x, grid.y);\nfloat gridAlpha = gridColor.a * gridFade;\ngl_FragColor =\nvec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +\nvec4(gridColor.rgb, 1.0) * gridAlpha;\n}"])))),t}var p=Object.freeze(Object.defineProperty({__proto__:null,build:d},Symbol.toStringTag,{value:"Module"}))},151:function(e,t,i){function n(){return new Float32Array(4)}function a(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function r(e,t,i,n){var a=new Float32Array(4);return a[0]=e,a[1]=t,a[2]=i,a[3]=n,a}function o(){return n()}function s(){return r(1,1,1,1)}function l(){return r(1,0,0,0)}function c(){return r(0,1,0,0)}function u(){return r(0,0,1,0)}function h(){return r(0,0,0,1)}i.d(t,{c:function(){return a},f:function(){return r}});var d=o(),p=s(),f=l(),v=c(),_=u(),g=h();Object.freeze(Object.defineProperty({__proto__:null,ONES:p,UNIT_W:g,UNIT_X:f,UNIT_Y:v,UNIT_Z:_,ZEROS:d,clone:a,create:n,createView:function(e,t){return new Float32Array(e,t,4)},fromValues:r,ones:s,unitW:h,unitX:l,unitY:c,unitZ:u,zeros:o},Symbol.toStringTag,{value:"Module"}))},96866:function(e,t,i){i.d(t,{B:function(){return v}});var n=i(74165),a=i(15861),r=i(1413),o=i(37762),s=i(80292),l=i(35995),c=i(71907),u=i(33397),h=i(25265),d=i(49861),p=i(22892),f=i(53283);function v(e){var t,i=null!==(t=null===e||void 0===e?void 0:e.origins)&&void 0!==t?t:[void 0];return function(t,n){var a,c=function(e,t,i){var n;if("resource"===(null===e||void 0===e?void 0:e.type))return function(e,t,i){var n=(0,u.Oe)(t,i);return{type:String,read:function(e,t,i){var a=(0,f.r)(e,t,i);return n.type===String?a:"function"==typeof n.type?new n.type({url:a}):void 0},write:{writer:function(t,a,o,c){if(!c||!c.resources)return"string"==typeof t?void(a[o]=(0,f.t)(t,c)):void(a[o]=t.write({},c));var u=function(e){return null==e?null:"string"==typeof e?e:e.url}(t),d=(0,f.t)(u,(0,r.Z)((0,r.Z)({},c),{},{verifyItemRelativeUrls:c&&c.verifyItemRelativeUrls?{writtenUrls:c.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0}),f.M.NO),v=n.type!==String&&(!(0,s.l)(this)||c&&c.origin&&this.originIdOf(i)>(0,h.M9)(c.origin)),m={object:this,propertyName:i,value:t,targetUrl:d,dest:a,targetPropertyName:o,context:c,params:e};c&&c.portalItem&&d&&!(0,l.YP)(d)?v?function(e){var t,i=e.context,n=e.targetUrl,a=e.params,o=e.value,s=e.dest,c=e.targetPropertyName;if(!i.portalItem)return;var u=i.portalItem.resourceFromPath(n),h=y(o,n,i),d=(0,p.B)(h),f=(0,l.Ml)(u.path),v=null!==(t=null===a||void 0===a?void 0:a.compress)&&void 0!==t&&t;d===f?(i.resources&&g((0,r.Z)((0,r.Z)({},e),{},{resource:u,content:h,compress:v,updates:i.resources.toUpdate})),s[c]=n):_(e)}(m):function(e){var t=e.context,i=e.targetUrl,n=e.dest,a=e.targetPropertyName;t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(i),compress:!1}),n[a]=i)}(m):c&&c.portalItem&&(null==d||null!=(0,f.i)(d)||(0,l.jc)(d)||v)?_(m):a[o]=d}}}}(e,t,i);switch(null!==(n=null===e||void 0===e?void 0:e.type)&&void 0!==n?n:"other"){case"other":return{read:!0,write:!0};case"url":return{read:f.a.read,write:f.a.write}}}(e,t,n),v=(0,o.Z)(i);try{for(v.s();!(a=v.n()).done;){var m=a.value,b=(0,d.CJ)(t,m,n);for(var M in c)b[M]=c[M]}}catch(S){v.e(S)}finally{v.f()}}}function _(e){var t,i,n,a=e.targetUrl,o=e.params,s=e.value,u=e.context,h=e.dest,d=e.targetPropertyName;if(u.portalItem){var v=(0,f.p)(a),_=null!==(t=null===v||void 0===v?void 0:v.filename)&&void 0!==t?t:(0,c.D)(),b=null!==(i=null===o||void 0===o?void 0:o.prefix)&&void 0!==i?i:null===v||void 0===v?void 0:v.prefix,M=y(s,a,u),S=(0,l.v_)(b,_),w="".concat(S,".").concat((0,p.B)(M)),x=u.portalItem.resourceFromPath(w);(0,l.jc)(a)&&u.resources&&u.resources.pendingOperations.push(function(e){return m.apply(this,arguments)}(a).then((function(e){x.path="".concat(S,".").concat((0,p.B)(e)),h[d]=x.itemRelativeUrl})).catch((function(){})));var C=null!==(n=null===o||void 0===o?void 0:o.compress)&&void 0!==n&&n;u.resources&&g((0,r.Z)((0,r.Z)({},e),{},{resource:x,content:M,compress:C,updates:u.resources.toAdd})),h[d]=x.itemRelativeUrl}}function g(e){var t=e.object,i=e.propertyName,n=e.updates,a=e.resource,r=e.content,o=e.compress;n.push({resource:a,content:r,compress:o,finish:function(e){!function(e,t,i){"string"==typeof e[t]?e[t]=i.url:e[t].url=i.url}(t,i,e)}})}function y(e,t,i){return"string"==typeof e?{url:t}:new Blob([JSON.stringify(e.toJSON(i))],{type:"application/json"})}function m(){return(m=(0,a.Z)((0,n.Z)().mark((function e(t){var a,r,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(i.bind(i,76200));case 2:return a=e.sent.default,e.next=5,a(t,{responseType:"blob"});case 5:return r=e.sent,o=r.data,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},80292:function(e,t,i){function n(e){return e&&"getAtOrigin"in e&&"originOf"in e}i.d(t,{l:function(){return n}})},45238:function(e,t,i){i.d(t,{EU:function(){return h},Ue:function(){return s},WH:function(){return d},ZZ:function(){return u},qC:function(){return c},uT:function(){return l}});var n=i(16889),a=i(48976),r=i(98131),o=i(11186);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return[e[0],e[1],e[2],e[3]]}function l(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return(0,o.c)(i,e),i[3]=t,i}function c(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return(0,a.s)(f,e,d(e)),(0,a.s)(v,t,d(t)),(0,a.m)(f,v,f),function(e,t){return e[3]=t,e}(i,(0,n.BV)((0,a.g)(i,f)))}function u(e){return e}function h(e){return e[3]}function d(e){return(0,n.Vl)(e[3])}var p=[0,0,1,0],f=(0,r.a)(),v=(0,r.a)();s()},22892:function(e,t,i){i.d(t,{B:function(){return a}});var n=i(35995);function a(e){return r[function(e){return e instanceof Blob?e.type:function(e){var t=(0,n.Ml)(e);return l[t]||o}(e.url)}(e)]||s}var r={},o="text/plain",s=r[o],l={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(var c in l)r[l[c]]=c},35209:function(e,t,i){i.r(t),i.d(t,{DrawGraphicTool3D:function(){return en},ExtentTransformTool:function(){return us},GraphicMoveTool:function(){return vr},GraphicReshapeTool:function(){return Nr},GraphicTransformTool:function(){return so}});var n=i(1413),a=i(15671),r=i(43144),o=i(60136),s=i(29388),l=i(27366),c=i(42537),u=i(92026),h=i(94172),d=i(49861),p=i(25243),f=i(63780),v=i(69912),_=i(11186),g=i(71353),y=i(74509),m=i(64575),b=i(17842),M=(i(32718),i(10064),i(93169)),S=i(93433),w=i(74165),x=i(15861),C=i(85015),O=i(14921),E=i(66978),k=i(58935),A=i(88396),T=i(6394),P=i(69662),R=i(41201),D=i(74177),Z=i(29439),G=i(37762),L=i(51995),I=(i(42877),function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}}),V=function e(t,i,n){for(var a=0,r=i.length;a<r;a++){var o=i[a];Array.isArray(o)?e(t,o,n):null!=o&&!1!==o&&("string"==typeof o&&(o=I(o)),n.push(o))}};i(88367);var z={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"},W=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).x=0,n.y=0,n.text="-",n.fontSize=14,n.anchor="center",n.visible=!0,n.backgroundColor=new L.Z([0,0,0,.6]),n.textColor=new L.Z([255,255,255]),n._textShadowSize=1,n}return(0,r.Z)(i,[{key:"position",get:function(){return[this.x,this.y]},set:function(e){this._set("x",e[0]),this._set("y",e[1])}},{key:"_textShadowColor",get:function(){return this.backgroundColor}},{key:"_textShadow",get:function(){var e=this._textShadowColor.toCss(!1);return"0 0 ".concat(this._textShadowSize,"px ").concat(e)}},{key:"_padding",get:function(){return.5*this.fontSize}},{key:"_borderRadius",get:function(){return this._padding}},{key:"render",value:function(){return function(e,t,i){if(Array.isArray(t))i=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");var n,a;return i&&1===i.length&&"string"==typeof i[0]?n=i[0]:i&&(V(e,i,a=[]),0===a.length&&(a=void 0)),{vnodeSelector:e,properties:t,children:a,text:""===n?void 0:n,domNode:null}}("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this._padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}},{key:"renderCanvas",value:function(e){if(this.visible){var t=e.font.replace(/^(.*?)px/,"");e.font="".concat(this.fontSize,"px ").concat(t);var i=this._padding,n=this._borderRadius,a=e.measureText(this.text).width,r=this.fontSize,o=N[this.anchor];e.textAlign="center",e.textBaseline="middle";var s=a+2*i,l=r+2*i,c=this.x+o.x*s,u=this.y+o.y*l;this._roundedRect(e,c,u,s,l,n),e.fillStyle=this.backgroundColor.toCss(!0),e.fill();var h=this.x+(o.x+.5)*s,d=this.y+(o.y+.5)*l;this._renderTextShadow(e,this.text,h,d),e.fillStyle=this.textColor.toCss(!0),e.fillText(this.text,h,d)}}},{key:"_renderTextShadow",value:function(e,t,i,n){e.lineJoin="miter",e.fillStyle="rgba(".concat(this._textShadowColor.r,", ").concat(this._textShadowColor.g,", ").concat(this._textShadowColor.b,", ").concat(1/j.length,")");var a,r=this._textShadowSize,o=(0,G.Z)(j);try{for(o.s();!(a=o.n()).done;){var s=(0,Z.Z)(a.value,2),l=s[0],c=s[1];e.fillText(t,i+r*l,n+r*c)}}catch(u){o.e(u)}finally{o.f()}}},{key:"_roundedRect",value:function(e,t,i,n,a,r){e.beginPath(),e.moveTo(t,i+r),e.arcTo(t,i,t+r,i,r),e.lineTo(t+n-r,i),e.arcTo(t+n,i,t+n,i+r,r),e.lineTo(t+n,i+a-r),e.arcTo(t+n,i+a,t+n-r,i+a,r),e.lineTo(t+r,i+a),e.arcTo(t,i+a,t,i+a-r,r),e.closePath()}},{key:"_cssClasses",value:function(){var e={"esri-text-overlay-item":!0};for(var t in z)e[z[t]]=this.anchor===t;return e}}]),i}(C.Z);(0,l._)([(0,d.Cb)()],W.prototype,"x",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"y",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"position",null),(0,l._)([(0,d.Cb)()],W.prototype,"text",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"fontSize",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"anchor",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"visible",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"backgroundColor",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"textColor",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"_textShadowSize",void 0),(0,l._)([(0,d.Cb)()],W.prototype,"_textShadowColor",null),(0,l._)([(0,d.Cb)()],W.prototype,"_textShadow",null),(0,l._)([(0,d.Cb)()],W.prototype,"_padding",null),(0,l._)([(0,d.Cb)()],W.prototype,"_borderRadius",null),W=(0,l._)([(0,v.j)("esri.views.overlay.TextOverlayItem")],W);for(var N={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},j=[],F=0;F<360;F+=22.5)j.push([Math.cos(Math.PI*F/180),Math.sin(Math.PI*F/180)]);var H=W,U=i(59418),B={default:15,far:25},Y=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).context=null,n.stagedVertex=null,n.visible=!0,n.edgeDistance="default",n._messagesUnits=null,n._labelInfos=[],n._nextLabelIndex=0,n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this,t=(0,O.vr)(function(){var t=(0,x.Z)((0,w.Z)().mark((function t(i){var n;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,R.ME)("esri/core/t9n/Units");case 2:n=t.sent,(0,E.k_)(i),e._messagesUnits=n;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),i=function(){return(0,u.yw)(e.context,(function(e){return e.editGeometryOperations}))};this.addHandles([(0,h.YP)((function(){return[(0,u.pC)(e.context)&&e.getCameraOrExtent(e.context),e.visible,e._edgeDistancePixels,e.stagedVertex,e._messagesUnits]}),(function(){return e._update()}))].concat((0,S.Z)(["vertex-add","vertex-update","vertex-remove"].map((function(t){return(0,h.on)(i,t,(function(){return e._update()}))}))),[(0,c.kB)((function(){return t.abort()}))]))}},{key:"destroy",value:function(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}},{key:"updating",get:function(){return(0,u.Wi)(this._messagesUnits)}},{key:"test",get:function(){return{labelContents:this._labelInfos.slice(0,this._nextLabelIndex).map((function(e){return e.label.text}))}}},{key:"_edgeDistancePixels",get:function(){return B[this.edgeDistance]}},{key:"_update",value:function(){var e=this;this._nextLabelIndex=0;var t=this.context;if((0,u.Wi)(t))this._destroyUnusedLabels();else{var i=t.editGeometryOperations.data,n=i.components,a=i.geometry,r=i.coordinateHelper;if(a){for(var o=n.length,s=function(){var i=[];if(n[l].iterateVertices((function(e){i.push(r.toXYZ(e.pos))})),0===l&&(0,u.pC)(e.stagedVertex)&&i.push(r.toXYZ(e.stagedVertex)),i.length<2)return"continue";var s=i[0],c=i[i.length-1];"polygon"===a.type&&i.length>2&&!(0,_.F)(s,c)&&i.push(s);var h=1===o&&!(0,P.bu)(i,!1,!1),d=Q,p=J;e.toScreenPointArray(t,s,d);for(var f=1;f<i.length;++f){var v,g=i[f-1],y=i[f];e.toScreenPointArray(t,y,p),e._addLabel(t,g,d,y,p,h),d=(v=[p,d])[0],p=v[1]}},l=0;l<o;++l)s();this._destroyUnusedLabels()}else this._destroyUnusedLabels()}}},{key:"_addLabel",value:function(e,t,i,n,a,r){var o=this._getOrCreateLabel(e).label;if(!this.visible||(0,A.k)(i,a)<3025)o.visible=!1;else{var s=(0,u.pC)(e.graphicState)?e.graphicState.isDraped?"on-the-ground":"absolute-height":(0,y.VW)(e.editGeometryOperations.data.geometry,e.elevationInfo),l=e.editGeometryOperations.data.spatialReference,c=(0,U.MU)(t,n,l,s),h=this._messagesUnits,d=(0,D.R)(e.view);o.text=(0,u.pC)(h)&&(0,u.pC)(c)?(0,k.N9)(h,c,d):"",o.visible=!0;var p=a[0]-i[0],f=a[1]-i[1];r?(0,A.s)(X,-f,p):(0,A.s)(X,f,-p),(0,A.f)(X,X),(0,A.b)(X,X,this._edgeDistancePixels),(0,A.l)(q,i,a,.5),(0,A.j)(q,q,X),o.position=[q[0],q[1]],Math.abs(X[0])>Math.abs(X[1])?o.anchor=X[0]>0?"left":"right":o.anchor=-X[1]<0?"top":"bottom"}}},{key:"_getOrCreateLabel",value:function(e){var t;if(this._labelInfos.length>this._nextLabelIndex)return this._labelInfos[this._nextLabelIndex++];var i=new H({fontSize:10,anchor:"center"});null===(t=e.view.overlay)||void 0===t||t.items.add(i);var n={label:i};return this._labelInfos.push(n),this._nextLabelIndex=this._labelInfos.length,n}},{key:"_destroyUnusedLabels",value:function(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}},{key:"_destroyLabel",value:function(e){var t=e.label;(0,u.yw)(this.context,(function(e){var i;return null===(i=e.view.overlay)||void 0===i?void 0:i.items.remove(t)})),t.destroy()}}]),i}(C.Z);(0,l._)([(0,d.Cb)()],Y.prototype,"context",void 0),(0,l._)([(0,d.Cb)()],Y.prototype,"stagedVertex",void 0),(0,l._)([(0,d.Cb)()],Y.prototype,"visible",void 0),(0,l._)([(0,d.Cb)()],Y.prototype,"edgeDistance",void 0),(0,l._)([(0,d.Cb)()],Y.prototype,"updating",null),(0,l._)([(0,d.Cb)()],Y.prototype,"_messagesUnits",void 0),(0,l._)([(0,d.Cb)()],Y.prototype,"_edgeDistancePixels",null),Y=(0,l._)([(0,v.j)("esri.views.interactive")],Y);var X=(0,T.a)(),q=(0,T.a)(),Q=(0,b.s1)(),J=(0,b.s1)(),K=i(11208),$=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"getCameraOrExtent",value:function(e){return e.view.state.camera}},{key:"toScreenPointArray",value:function(e,t){var i=e.view,n=e.elevationInfo,a=e.editGeometryOperations,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,b.s1)(),o=a.data.coordinateHelper.spatialReference;return(0,K.RS)(t,o,n,i,ee),i.state.camera.projectToScreen(ee,r),r}}]),i}(Y);$=(0,l._)([(0,v.j)("esri.views.3d.interactive.SegmentLabels3D")],$);var ee=(0,g.c)(),te=i(79803),ie=i(11752),ne=i(61120),ae=i(90045),re=i(151),oe=i(70444),se=i(95773),le=i(85981),ce=i(40885),ue=i(79056),he=i(26279),de=i(78289),pe=i(78485),fe=function(){function e(t){(0,a.Z)(this,e),this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=he.eZ.Outline}return(0,r.Z)(e,[{key:"destroy",value:function(){this._destroyResources()}},{key:"resources",get:function(){return(0,u.pC)(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}},{key:"renderGroup",get:function(){return this._renderGroup},set:function(e){var t;this._renderGroup=e;var i=null===(t=(0,u.WG)(this._resources))||void 0===t?void 0:t.layerView;i&&(i.renderGroup=e)}},{key:"recreate",value:function(){this.attached&&this._createResources()}},{key:"recreateGeometry",value:function(){this._resourceFactory.recreateGeometry?(0,u.Wi)(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}},{key:"_createOrDestroyResources",value:function(){this._attached?(0,u.Wi)(this._resources)&&this._createResources():this._destroyResources()}},{key:"_createResources",value:function(){var e;this._destroyResources();var t=this._resourceFactory.createResources(),i=new ve({view:this._resourceFactory.view,renderGroup:this._renderGroup}),n=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;this._resources={layerView:new ve({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:t,geometriesAdded:!1},n&&(this._resources.drapeSourceRenderer=n.registerGeometryDrapeSource(i)),this._syncGeometriesToRenderer()}},{key:"_destroyResources",value:function(){var e;if(!(0,u.Wi)(this._resources)){this._ensureRenderGeometriesRemoved();var t=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;t&&t.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}}},{key:"_syncGeometriesToRenderer",value:function(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}},{key:"_ensureRenderGeometriesRemoved",value:function(){(0,u.Wi)(this._resources)||(0,u.Wi)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,de.T.UPDATE),this._resources.geometriesAdded=!1)}},{key:"_ensureRenderGeometriesAdded",value:function(){(0,u.Wi)(this._resources)||(0,u.Wi)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,de.T.UPDATE),this._resources.geometriesAdded=!0)}}]),e}(),ve=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).drapeSourceType=he.Lw.Features,n.updatePolicy=pe.j.SYNC,n.renderGroup=he.eZ.Outline,n}return(0,r.Z)(i)}((0,ue.IG)(C.Z));(0,l._)([(0,d.Cb)({constructOnly:!0})],ve.prototype,"view",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],ve.prototype,"drapeSourceType",void 0),(0,l._)([(0,d.Cb)()],ve.prototype,"renderGroup",void 0),ve=(0,l._)([(0,v.j)("DrapedVisualElementLayerView")],ve);var _e=function(){function e(t){var i=this;(0,a.Z)(this,e),this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this._handle=(0,h.YP)((function(){return i.view.ready}),(function(e){i._resourcesCreated&&(e?i._createResources():i._destroyResources())}))}return(0,r.Z)(e,[{key:"applyProps",value:function(e){var t=!1;for(var i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}},{key:"destroy",value:function(){this.attached=!1,this._handle.remove()}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}},{key:"onAttachedChange",value:function(e){}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}},{key:"_createResources",value:function(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}},{key:"_destroyResources",value:function(){this.destroyResources(),this._resourcesCreated=!1}}]),e}(),ge=i(79100),ye=i(66327),me=i(76873),be=i(97882),Me=function(){function e(t){(0,a.Z)(this,e),this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1}return(0,r.Z)(e,[{key:"destroy",value:function(){this._destroyResources()}},{key:"object",get:function(){return(0,u.pC)(this._resources)?this._resources.object:null}},{key:"resources",get:function(){return(0,u.pC)(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this._syncVisible())}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}},{key:"recreate",value:function(){this.attached&&this._createResources()}},{key:"recreateGeometry",value:function(){if(this._resourceFactory.recreateGeometry){var e=this._resourceFactory.view._stage;if(!(0,u.Wi)(this._resources)&&e){var t=this._resources.object;this._resources.external.forEach((function(t){t.type!==ge.U.Mesh&&t.type!==ge.U.Line&&t.type!==ge.U.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((function(t){t.type!==ge.U.Mesh&&t.type!==ge.U.Line&&t.type!==ge.U.Point||e.add(t)}))}}else this.recreate()}},{key:"_createOrDestroyResources",value:function(){this._attached?this._resources||this._createResources():this._destroyResources()}},{key:"_createResources",value:function(){this._destroyResources();var e=this._resourceFactory,t=e.view,i=t._stage;if(i){var n=new be.F({pickable:!1,updatePolicy:pe.j.SYNC});i.add(n);var a=new ye.T({castShadow:!1}),r=e.createResources(a,n);r.forEach((function(e){i.add(e),e instanceof me.x&&i.loadImmediate(e)})),i.add(a),n.add(a);var o=e.cameraChanged,s=o?(0,h.YP)((function(){return t.state.camera}),(function(e){return o(e)}),h.nn):null;this._resources={layer:n,object:a,external:r,cameraHandle:s},this._syncVisible()}}},{key:"_destroyResources",value:function(){var e;if(!(0,u.Wi)(this._resources)){var t=this._resourceFactory.view._stage;t&&(t.remove(this._resources.object),t.remove(this._resources.layer),this._resources.external.forEach((function(e){return t.remove(e)}))),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}}},{key:"_syncVisible",value:function(){(0,u.Wi)(this._resources)||(this._resources.object.visible=this._visible)}}]),e}(),Se=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n,r=e.view,o=e.isDraped;return(0,a.Z)(this,i),(n=t.call(this,r))._isDraped=!1,n.object3dResources=new Me(n.createObject3DResourceFactory(r)),n.drapedResources=new fe(n.createDrapedResourceFactory(r)),n.isDraped=null!==o&&void 0!==o&&o,n}return(0,r.Z)(i,[{key:"isDraped",get:function(){return this._isDraped},set:function(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}},{key:"renderGroup",get:function(){return this.drapedResources.renderGroup},set:function(e){this.drapedResources.renderGroup=e}},{key:"createResources",value:function(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}},{key:"destroyResources",value:function(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}},{key:"recreate",value:function(){this.object3dResources.recreate(),this.drapedResources.recreate()}},{key:"recreateGeometry",value:function(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}},{key:"destroy",value:function(){this.object3dResources.destroy(),this.drapedResources.destroy(),(0,ie.Z)((0,ne.Z)(i.prototype),"destroy",this).call(this)}},{key:"updateVisibility",value:function(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}]),i}(_e),we=i(50951),xe=i(50256),Ce=i(55158),Oe=i(88699),Ee=i(80658),ke=i(4760),Ae=i(82144),Te=i(31132),Pe=i(27627),Re=i(18300),De=i(8548),Ze=i(36207),Ge=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"initializeProgram",value:function(e){return new Pe.$(e.rctx,i.shader.get().build(this.configuration),Le)}},{key:"initializePipeline",value:function(){return(0,Ze.sm)({blending:(0,Ze.if)(De.zi.ONE,De.zi.ONE_MINUS_SRC_ALPHA),colorWrite:Ze.BK})}}]),i}(Te.A);Ge.shader=new Ae.J(Re.L,(function(){return i.e(7515).then(i.bind(i,97515))}));var Le=new Map([[ke.T.START,0],[ke.T.END,1],[ke.T.UP,2],[ke.T.EXTRUDE,3]]),Ie=i(44070),Ve=function(){function e(t){(0,a.Z)(this,e),this._renderCoordsHelper=t,this._buffers=null,this._origin=(0,g.c)(),this._dirty=!1,this._count=0,this._vao=null}return(0,r.Z)(e,[{key:"vertices",set:function(e){var t,i=(0,Oe.bg)(3*e.length),n=0,a=(0,G.Z)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;i[n++]=r[0],i[n++]=r[1],i[n++]=r[2]}}catch(o){a.e(o)}finally{a.f()}this.buffers=[i]}},{key:"buffers",set:function(e){if(this._buffers=e,this._buffers.length>0){var t=this._buffers[0],i=3*Math.floor(t.length/3/2);(0,_.s)(this._origin,t[i+0],t[i+1],t[i+2])}else(0,_.s)(this._origin,0,0,0);this._dirty=!0}},{key:"origin",get:function(){return this._origin}},{key:"draw",value:function(e){var t=this._ensureVAO(e);(0,u.pC)(t)&&(e.bindVAO(t),e.drawArrays(De.MX.TRIANGLES,0,this._count))}},{key:"dispose",value:function(){(0,u.pC)(this._vao)&&this._vao.dispose()}},{key:"_ensureVAO",value:function(e){return(0,u.Wi)(this._buffers)?null:((0,u.Wi)(this._vao)&&(this._vao=this._createVAO(e,this._buffers)),this._ensureVertexData(this._vao,this._buffers),this._vao)}},{key:"_createVAO",value:function(e,t){var i=this._createDataBuffer(t);return this._dirty=!1,new Ee.U(e,Le,{data:(0,xe.K)(Ne)},{data:Ie.f.createVertex(e,De.l1.STATIC_DRAW,i)})}},{key:"_ensureVertexData",value:function(e,t){var i;if(this._dirty){var n=this._createDataBuffer(t);null!==(i=e.vertexBuffers.data)&&void 0!==i&&i.setData(n),this._dirty=!1}}},{key:"_numberOfRenderVertices",value:function(e){return 2*(e.length/3-1)*3}},{key:"_createDataBuffer",value:function(e){var t=this,i=e.reduce((function(e,i){return e+t._numberOfRenderVertices(i)}),0);this._count=i;var n,a=Ne.createBuffer(i),r=this._origin,o=0,s=0,l=(0,G.Z)(e);try{for(l.s();!(n=l.n()).done;){for(var c=n.value,u=0;u<c.length;u+=3){var h=(0,_.s)(We,c[u+0],c[u+1],c[u+2]);0===u?s=this._renderCoordsHelper.getAltitude(h):this._renderCoordsHelper.setAltitude(h,s);var d=this._renderCoordsHelper.worldUpAtPosition(h,ze),p=o+2*u,f=(0,_.b)(We,h,r);if(u<c.length-3){a.up.setVec(p,d),a.up.setVec(p+3,d),a.up.setVec(p+5,d);for(var v=0;v<6;v++)a.start.setVec(p+v,f);a.extrude.setValues(p+0,0,-1),a.extrude.setValues(p+1,1,-1),a.extrude.setValues(p+2,1,1),a.extrude.setValues(p+3,0,-1),a.extrude.setValues(p+4,1,1),a.extrude.setValues(p+5,0,1)}if(u>0){a.up.setVec(p-2,d),a.up.setVec(p-4,d),a.up.setVec(p-5,d);for(var g=-6;g<0;g++)a.end.setVec(p+g,f)}}o+=this._numberOfRenderVertices(c)}}catch(y){l.e(y)}finally{l.f()}return a.buffer}}]),e}(),ze=(0,g.c)(),We=(0,g.c)(),Ne=(0,Ce.U$)().vec3f(ke.T.START).vec3f(ke.T.END).vec3f(ke.T.UP).vec2f(ke.T.EXTRUDE),je=i(32534),Fe=i(93822),He=i(22909),Ue=i(33559),Be=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).contrastControlEnabled=!1,e}return(0,r.Z)(i)}(Ue.m);(0,l._)([(0,Ue.o)()],Be.prototype,"contrastControlEnabled",void 0);var Ye=i(16889),Xe=i(98634),qe=i(7566),Qe=i(83671),Je=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).innerColor=(0,g.f)(1,1,1),e.innerWidth=1,e.glowColor=(0,g.f)(1,.5,0),e.glowWidth=8,e.glowFalloff=8,e.globalAlpha=.75,e.globalAlphaContrastBoost=2,e.angleCutoff=(0,Ye.Vl)(6),e.pointDistanceOrigin=(0,g.c)(),e.pointDistanceTarget=(0,g.c)(),e.lineVerticalPlaneSegment=(0,le.Ue)(),e.intersectsLineSegment=(0,le.Ue)(),e.intersectsLineRadius=3,e.heightManifoldTarget=(0,g.c)(),e.lineStartWorld=(0,g.c)(),e.lineEndWorld=(0,g.c)(),e}return(0,r.Z)(i)}(Xe.K),Ke=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"initializeProgram",value:function(e){return new Pe.$(e.rctx,i.shader.get().build(this.configuration),qe.i)}},{key:"initializePipeline",value:function(){return(0,Ze.sm)({blending:(0,Ze.if)(De.zi.ONE,De.zi.ONE_MINUS_SRC_ALPHA),colorWrite:Ze.BK})}}]),i}(Te.A);Ke.shader=new Ae.J(Qe.L,(function(){return i.e(5693).then(i.bind(i,45693))}));var $e=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).heightManifoldEnabled=!1,e.pointDistanceEnabled=!1,e.lineVerticalPlaneEnabled=!1,e.intersectsLineEnabled=!1,e.spherical=!1,e}return(0,r.Z)(i)}(Be);(0,l._)([(0,Ue.o)()],$e.prototype,"heightManifoldEnabled",void 0),(0,l._)([(0,Ue.o)()],$e.prototype,"pointDistanceEnabled",void 0),(0,l._)([(0,Ue.o)()],$e.prototype,"lineVerticalPlaneEnabled",void 0),(0,l._)([(0,Ue.o)()],$e.prototype,"intersectsLineEnabled",void 0),(0,l._)([(0,Ue.o)()],$e.prototype,"spherical",void 0);var et,tt=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{contrastControlEnabled:!1};(0,a.Z)(this,e),this._config=i,this._technique=null,this._heightManifoldEnabled=!1,this._pointDistanceEnabled=!1,this._lineVerticalPlaneEnabled=!1,this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._viewingMode=we.JY.Local,this._pathVerticalPlaneEnabled=!1,this._pathVerticalPlaneData=null,this._pathTechnique=null,this.canRender=!0,this._passParameters=(0,He.Uf)(t,new Je)}return(0,r.Z)(e,[{key:"renderSlots",get:function(){return[this._config.contrastControlEnabled?Fe.r.LASERLINES_CONTRAST_CONTROL:Fe.r.LASERLINES]}},{key:"needsLinearDepth",get:function(){return!0}},{key:"heightManifoldEnabled",get:function(){return this._heightManifoldEnabled},set:function(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this._requestRender())}},{key:"heightManifoldTarget",get:function(){return this._passParameters.heightManifoldTarget},set:function(e){(0,_.c)(this._passParameters.heightManifoldTarget,e),this._requestRender()}},{key:"pointDistanceEnabled",get:function(){return this._pointDistanceEnabled},set:function(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this._requestRender())}},{key:"pointDistanceTarget",get:function(){return this._passParameters.pointDistanceTarget},set:function(e){(0,_.c)(this._passParameters.pointDistanceTarget,e),this._requestRender()}},{key:"pointDistanceOrigin",get:function(){return this._passParameters.pointDistanceOrigin},set:function(e){(0,_.c)(this._passParameters.pointDistanceOrigin,e),this._requestRender()}},{key:"lineVerticalPlaneEnabled",get:function(){return this._lineVerticalPlaneEnabled},set:function(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this._requestRender())}},{key:"lineVerticalPlaneSegment",get:function(){return this._passParameters.lineVerticalPlaneSegment},set:function(e){(0,le.JG)(e,this._passParameters.lineVerticalPlaneSegment),this._requestRender()}},{key:"intersectsLineEnabled",get:function(){return this._intersectsLineEnabled},set:function(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this._requestRender())}},{key:"intersectsLineSegment",get:function(){return this._passParameters.intersectsLineSegment},set:function(e){(0,le.JG)(e,this._passParameters.intersectsLineSegment),this._requestRender()}},{key:"intersectsLineRadius",get:function(){return this._passParameters.intersectsLineRadius},set:function(e){e!==this._passParameters.intersectsLineRadius&&(this._passParameters.intersectsLineRadius=e,this._requestRender())}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this._requestRender())}},{key:"viewingMode",get:function(){return this._viewingMode},set:function(e){e!==this._viewingMode&&(this._viewingMode=e,this._requestRender())}},{key:"pathVerticalPlaneEnabled",get:function(){return this._pathVerticalPlaneEnabled},set:function(e){e!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=e,(0,u.pC)(this._pathVerticalPlaneData)&&this._requestRender())}},{key:"pathVerticalPlaneVertices",set:function(e){(0,u.Wi)(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new Ve(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this._requestRender()}},{key:"pathVerticalPlaneBuffers",set:function(e){(0,u.Wi)(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new Ve(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this._requestRender()}},{key:"setParameters",value:function(e){(0,He.LO)(this._passParameters,e)&&this._requestRender()}},{key:"initializeRenderContext",value:function(e){this._context=e;var t=e.renderContext.rctx;this._quadVAO=(0,je.ow)(t),this._techniqueRepository=e.techniqueRepository,this._techniqueConfig=new $e;var i=new Be;i.contrastControlEnabled=this._config.contrastControlEnabled,this._pathTechnique=this._techniqueRepository.acquire(Ge,i)}},{key:"uninitializeRenderContext",value:function(){this._quadVAO=(0,u.M2)(this._quadVAO),this._technique=(0,u.RY)(this._technique),this._pathVerticalPlaneData=(0,u.M2)(this._pathVerticalPlaneData),this._pathTechnique=(0,u.RY)(this._pathTechnique)}},{key:"prepareTechnique",value:function(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._techniqueConfig.spherical=this._viewingMode===we.JY.Global,this._technique=this._techniqueRepository.releaseAndAcquire(Ke,this._techniqueConfig,this._technique),this._technique):this._pathTechnique}},{key:"render",value:function(e,t){(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(e,t),this.pathVerticalPlaneEnabled&&this._renderPath(e)}},{key:"_renderUnified",value:function(e,t){var i=e.rctx;this._updatePassParameters(e),i.bindTechnique(t,this._passParameters,e.bindParameters),i.bindVAO(this._quadVAO),i.drawArrays(De.MX.TRIANGLE_STRIP,0,4)}},{key:"_renderPath",value:function(e){if(!(0,u.Wi)(this._pathVerticalPlaneData)&&!(0,u.Wi)(this._pathTechnique)){var t=e.rctx,i=this._pathTechnique;t.bindTechnique(i,(0,n.Z)((0,n.Z)({},this._passParameters),{},{origin:this._pathVerticalPlaneData.origin}),e.bindParameters),this._pathVerticalPlaneData.draw(e.rctx)}}},{key:"_updatePassParameters",value:function(e){if(this._intersectsLineEnabled){var t=e.bindParameters.camera;if(this._intersectsLineInfinite){if((0,oe.iL)((0,ce.re)(this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector),it),it.c0=-Number.MAX_VALUE,!(0,se.zq)(t.frustum,it))return;(0,oe.Ws)(it,this._passParameters.lineStartWorld),(0,oe.S$)(it,this._passParameters.lineEndWorld)}else(0,_.c)(this._passParameters.lineStartWorld,this._passParameters.intersectsLineSegment.origin),(0,_.a)(this._passParameters.lineEndWorld,this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector)}}},{key:"_requestRender",value:function(){this._context&&this._context.requestRender()}}]),e}(),it=(0,oe.Ue)(),nt=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e.view))._angleCutoff=Qe.d,n._style={},n._heightManifoldTarget=(0,g.c)(),n._heightManifoldEnabled=!1,n._intersectsLine=(0,le.Ue)(),n._intersectsLineEnabled=!1,n._intersectsLineInfinite=!1,n._lineVerticalPlaneSegment=null,n._pathVerticalPlaneBuffers=null,n._pointDistanceLine=null,n.applyProps(e),n}return(0,r.Z)(i,[{key:"testData",get:function(){return this._renderer}},{key:"createResources",value:function(){this._ensureRenderer()}},{key:"destroyResources",value:function(){this._disposeRenderer()}},{key:"updateVisibility",value:function(){this._syncRenderer(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance()}},{key:"angleCutoff",get:function(){return this._angleCutoff},set:function(e){this._angleCutoff!==e&&(this._angleCutoff=e,this._syncAngleCutoff())}},{key:"style",get:function(){return this._style},set:function(e){this._style=e,this._syncStyle()}},{key:"heightManifoldTarget",get:function(){return this._heightManifoldEnabled?this._heightManifoldTarget:null},set:function(e){(0,u.pC)(e)?((0,_.c)(this._heightManifoldTarget,e),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1,this._syncRenderer(),this._syncHeightManifold()}},{key:"intersectsWorldUpAtLocation",set:function(e){if((0,u.Wi)(e))this.intersectsLine=null;else{var t=this.view.renderCoordsHelper.worldUpAtPosition(e,at);this.intersectsLine=(0,le.al)(e,t),this.intersectsLineInfinite=!0}}},{key:"intersectsLine",get:function(){return this._intersectsLineEnabled?this._intersectsLine:null},set:function(e){(0,u.pC)(e)?((0,le.JG)(e,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1,this._syncIntersectsLine(),this._syncRenderer()}},{key:"intersectsLineInfinite",get:function(){return this._intersectsLineInfinite},set:function(e){this._intersectsLineInfinite=e,this._syncIntersectsLineInfinite()}},{key:"lineVerticalPlaneSegment",get:function(){return this._lineVerticalPlaneSegment},set:function(e){this._lineVerticalPlaneSegment=(0,u.pC)(e)?(0,le.JG)(e):null,this._syncLineVerticalPlane(),this._syncRenderer()}},{key:"pathVerticalPlane",get:function(){return this._pathVerticalPlaneBuffers},set:function(e){this._pathVerticalPlaneBuffers=e,this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncRenderer()}},{key:"pointDistanceLine",get:function(){return this._pointDistanceLine},set:function(e){this._pointDistanceLine=(0,u.pC)(e)?{origin:(0,g.a)(e.origin),target:e.target?(0,g.a)(e.target):null}:null,this._syncPointDistance(),this._syncRenderer()}},{key:"_syncRenderer",value:function(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||(0,u.pC)(this._pointDistanceLine)||(0,u.pC)(this._pathVerticalPlaneBuffers))?this._ensureRenderer():this._disposeRenderer()}},{key:"_ensureRenderer",value:function(){(0,u.pC)(this._renderer)||(this._renderer=new tt({renderCoordsHelper:this.view.renderCoordsHelper},{contrastControlEnabled:!0}),this._renderer.viewingMode=this.view.state.viewingMode,this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this._renderer.renderSlots,this._renderer))}},{key:"_syncStyle",value:function(){(0,u.Wi)(this._renderer)||(this._renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this._renderer.intersectsLineRadius=this._style.intersectsLineRadius))}},{key:"_syncAngleCutoff",value:function(){(0,u.Wi)(this._renderer)||this._renderer.setParameters({angleCutoff:this._angleCutoff})}},{key:"_syncHeightManifold",value:function(){(0,u.Wi)(this._renderer)||(this._renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this._renderer.heightManifoldTarget=this._heightManifoldTarget))}},{key:"_syncIntersectsLine",value:function(){(0,u.Wi)(this._renderer)||(this._renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this._renderer.intersectsLineSegment=this._intersectsLine))}},{key:"_syncIntersectsLineInfinite",value:function(){(0,u.Wi)(this._renderer)||(this._renderer.intersectsLineInfinite=this._intersectsLineInfinite)}},{key:"_syncPathVerticalPlane",value:function(){(0,u.Wi)(this._renderer)||(this._renderer.pathVerticalPlaneEnabled=(0,u.pC)(this._pathVerticalPlaneBuffers)&&this.visible,(0,u.pC)(this._pathVerticalPlaneBuffers)&&(this._renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}},{key:"_syncLineVerticalPlane",value:function(){(0,u.Wi)(this._renderer)||(this._renderer.lineVerticalPlaneEnabled=(0,u.pC)(this._lineVerticalPlaneSegment)&&this.visible,(0,u.pC)(this._lineVerticalPlaneSegment)&&(this._renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}},{key:"_syncPointDistance",value:function(){if(!(0,u.Wi)(this._renderer)){var e=this._pointDistanceLine,t=(0,u.pC)(e);this._renderer.pointDistanceEnabled=t&&null!=e.target&&this.visible,t&&(this._renderer.pointDistanceOrigin=e.origin,null!=e.target&&(this._renderer.pointDistanceTarget=e.target))}}},{key:"_disposeRenderer",value:function(){(0,u.pC)(this._renderer)&&this.view._stage&&(this.view._stage.removeRenderPlugin(this._renderer),this._renderer=null)}}]),i}(_e),at=(0,g.c)(),rt=i(1937),ot=i(70619),st=i(56529),lt=i(39077),ct=i(58901),ut=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._ray=(0,ce.Ue)(),n._isWorldDown=!1,n._start=(0,g.c)(),n._end=(0,g.f)(1,0,0),n._width=1,n._color=(0,re.f)(1,0,1,1),n._polygonOffset=!1,n._writeDepthEnabled=!0,n._innerWidth=0,n._innerColor=(0,re.f)(1,1,1,1),n._stipplePattern=null,n._stippleOffColor=null,n._stipplePreferContinuous=!0,n._falloff=0,n._extensionType=et.LINE,n._laserlineStyle=null,n._laserlineEnabled=!1,n._renderOccluded=st.yD.OccludeAndTransparent,n._fadedExtensions=_t,n._laserline=new nt({view:n.view}),n.applyProps(e),n}return(0,r.Z)(i,[{key:"destroy",value:function(){this._laserline.destroy(),(0,ie.Z)((0,ne.Z)(i.prototype),"destroy",this).call(this)}},{key:"createObject3DResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(e){return t._createObject3DResources(e)},destroyResources:function(e){return t._destroyExternalResources(e)},recreateGeometry:function(e,i){return t._recreateObject3DGeometry(e,i)},cameraChanged:function(){return t._updateGeometry()}}}},{key:"createDrapedResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(){return t._createDrapedResources()},destroyResources:function(e){return t._destroyExternalResources(e)},recreateGeometry:function(e){return t._recreateDrapedGeometry(e)}}}},{key:"updateVisibility",value:function(e){(0,ie.Z)((0,ne.Z)(i.prototype),"updateVisibility",this).call(this,e),this._laserline.visible=e}},{key:"onAttachedChange",value:function(){this._laserline.attached=this._laserlineAttached}},{key:"setStartEndFromWorldDownAtLocation",value:function(e){this._isWorldDown=!0,(0,_.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,_.b)(this._end,e,this._end),(0,ce.zk)(this._start,this._end,this._ray),this._updateGeometry()}},{key:"start",get:function(){return this._start},set:function(e){this._isWorldDown=!1,(0,_.k)(this._start,e)||((0,_.c)(this._start,e),(0,ce.zk)(this._start,this._end,this._ray),this._updateGeometry())}},{key:"end",get:function(){return this._end},set:function(e){this._isWorldDown=!1,(0,_.k)(this._end,e)||((0,_.c)(this._end,e),(0,ce.zk)(this._start,this._end,this._ray),this._updateGeometry())}},{key:"width",get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,this._updateMaterial())}},{key:"color",get:function(){return this._color},set:function(e){(0,ae.g)(e,this._color)||((0,ae.c)(this._color,e),this._updateMaterial())}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}},{key:"writeDepthEnabled",get:function(){return this._writeDepthEnabled},set:function(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}},{key:"innerWidth",get:function(){return this._innerWidth},set:function(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(e){(0,ae.g)(e,this._innerColor)||((0,ae.c)(this._innerColor,e),this._updateMaterial())}},{key:"stipplePattern",get:function(){return this._stipplePattern},set:function(e){var t=(0,u.pC)(e)!==(0,u.pC)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(e){((0,u.Wi)(e)||(0,u.Wi)(this._stippleOffColor)||!(0,ae.g)(e,this._stippleOffColor))&&(this._stippleOffColor=(0,u.pC)(e)?(0,re.c)(e):null,this._updateMaterial())}},{key:"stipplePreferContinuous",get:function(){return this._stipplePreferContinuous},set:function(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}},{key:"falloff",get:function(){return this._falloff},set:function(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}},{key:"extensionType",get:function(){return this._extensionType},set:function(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}},{key:"_laserlineAttached",get:function(){return this._laserlineEnabled&&(0,u.pC)(this._laserlineStyle)&&this.attached&&!this.isDraped}},{key:"laserlineStyle",get:function(){return this._laserlineStyle},set:function(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,(0,u.pC)(e)&&(this._laserline.style=e)}},{key:"laserlineEnabled",get:function(){return this._laserlineEnabled},set:function(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"_normalizedRenderOccluded",get:function(){return this.isDraped&&this._renderOccluded===st.yD.OccludeAndTransparentStencil?st.yD.OccludeAndTransparent:this._renderOccluded}},{key:"fadedExtensions",get:function(){return this._fadedExtensions},set:function(e){this._fadedExtensions=(0,u.Pt)(e,_t),this.recreateGeometry()}},{key:"_updateMaterial",value:function(){var e,t,i=this.materialParameters;null!==(e=(0,u.WG)(this.object3dResources.resources))&&void 0!==e&&e.material.setParameters(i),null===(t=(0,u.WG)(this.drapedResources.resources))||void 0===t||t.material.setParameters(i)}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,writeDepth:this._writeDepthEnabled}}},{key:"_createObject3DResources",value:function(e){var t=new ct.U(this.materialParameters),i=new Array;return this._createObject3DGeometry(t,e,i),{material:t,geometries:i,forEach:function(e){e(t),i.forEach(e)}}}},{key:"_destroyExternalResources",value:function(e){e.geometries=[],e.material.dispose()}},{key:"_recreateObject3DGeometry",value:function(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}},{key:"_createObject3DGeometry",value:function(e,t,i){var n=this._createGeometry(e);i.push(n),t.addGeometry(n),this._updateVerticesObject3D(t)}},{key:"_createDrapedResources",value:function(){var e=new ct.U(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}},{key:"_recreateDrapedGeometry",value:function(e){e.geometries=[this._createDrapedGeometry(e.material)]}},{key:"_createDrapedGeometry",value:function(e){var t=this._createGeometry(e);this._updateVerticesDraped(t);var i=new lt.z(t,{boundingInfo:t.boundingInfo});return i.computeBoundingSphere(i.transformation,i.boundingSphere),i}},{key:"_createGeometry",value:function(e){var t=this.extensionType===et.FADED,i=t?[(0,g.c)(),(0,g.c)(),(0,g.c)(),(0,g.c)()]:[(0,g.c)(),(0,g.c)()];return(0,ot.rh)(e,i,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}},{key:"_updateGeometry",value:function(){if(this.isDraped)this.drapedResources.recreateGeometry();else{var e=(0,u.WG)(this.object3dResources.object);e&&this._updateVerticesObject3D(e)}}},{key:"_updateVerticesObject3D",value:function(e){var t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}},{key:"_updateVerticesDraped",value:function(e){this._updateVertexAttributesDraped(e,this._lineSegment)}},{key:"_lineSegment",get:function(){return this._extensionType===et.FADED?this._updateLineSegmentFinite(ft):this._updateLineSegmentInfinite(this._extensionType,ft)}},{key:"_updateLineSegmentFinite",value:function(e){return(0,le.zk)(this._start,this._end,e)}},{key:"_updateLineSegmentInfinite",value:function(e,t){var i=this.view.state.camera;switch((0,oe.iL)(this._ray,ht),e){case et.LINE:ht.c0=-Number.MAX_VALUE;break;case et.RAY:case et.GROUND_RAY:var n=this._ray.origin,a=(0,u.Pt)(this.view.elevationProvider.getElevation(n[0],n[1],n[2],this.view.renderCoordsHelper.spatialReference,"ground"),0),r=this.view.renderCoordsHelper.getAltitude(n);this._isWorldDown&&r<a&&(0,_.o)(ht.ray.direction,ht.ray.direction),this._extensionType===et.GROUND_RAY&&null!=a&&(ht.c1=Math.abs(r-a))}if(!(0,se.zq)(i.frustum,ht))return this._updateLineSegmentFinite(t);var o=(0,oe.Ws)(ht,dt),s=(0,oe.S$)(ht,pt);return(0,le.zk)(o,s,t)}},{key:"_updateVertexAttributesObject3D",value:function(e,t){var i,n=null===(i=e.geometries[0].getMutableAttribute(ke.T.POSITION))||void 0===i?void 0:i.data;if(n){var a,r=0,o=(0,G.Z)(this._lineVertices(t));try{for(o.s();!(a=o.n()).done;){var s=a.value;n[r++]=s[0],n[r++]=s[1],n[r++]=s[2]}}catch(l){o.e(l)}finally{o.f()}e.geometryVertexAttrsUpdated(e.geometries[0])}}},{key:"_updateVertexAttributesDraped",value:function(e,t){var i,n=null===(i=e.getMutableAttribute(ke.T.POSITION))||void 0===i?void 0:i.data;if(n){var a,r=0,o=(0,G.Z)(this._lineVertices(t));try{for(o.s();!(a=o.n()).done;){var s=a.value;n[r++]=s[0],n[r++]=s[1],n[r++]=rt.Rn}}catch(l){o.e(l)}finally{o.f()}e.invalidateBoundingInfo()}}},{key:"_lineVertices",value:(0,w.Z)().mark((function e(t){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.extensionType!==et.FADED){e.next=11;break}return e.next=3,(0,le.KU)(t,-this.fadedExtensions.start,dt);case 3:return e.next=5,(0,le.KU)(t,0,dt);case 5:return e.next=7,(0,le.KU)(t,1,dt);case 7:return e.next=9,(0,le.KU)(t,1+this.fadedExtensions.end,dt);case 9:e.next=15;break;case 11:return e.next=13,(0,le.KU)(t,0,dt);case 13:return e.next=15,(0,le.KU)(t,1,dt);case 15:case"end":return e.stop()}}),e,this)}))}]),i}(Se),ht=(0,oe.Ue)(),dt=(0,g.c)(),pt=(0,g.c)(),ft=(0,le.Ue)();!function(e){e[e.LINE=0]="LINE",e[e.RAY=1]="RAY",e[e.GROUND_RAY=2]="GROUND_RAY",e[e.FADED=3]="FADED"}(et||(et={}));var vt=1/3,_t={start:vt,end:vt},gt=i(65618),yt=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._location=(0,g.c)(),n._direction=(0,g.f)(1,0,0),n._width=1,n._offset=1,n._length=18,n._color=(0,re.f)(1,0,1,1),n._renderOccluded=st.yD.OccludeAndTransparent,n.applyProps(e),n}return(0,r.Z)(i,[{key:"createObject3DResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(e){return t._createObject3DResources(e)},destroyResources:function(e){return t._destroyObject3DResources(e)},recreateGeometry:function(e,i){return t._recreateObject3DGeometry(e,i)},cameraChanged:function(){return t._updateGeometry()}}}},{key:"createDrapedResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(){return t._createDrapedResources()},destroyResources:function(e){return t._destroyDrapedResources(e)},recreateGeometry:function(e){return t._recreateDrapedGeometry(e)}}}},{key:"location",get:function(){return this._location},set:function(e){(0,_.k)(this._location,e)||((0,_.c)(this._location,e),this._updateGeometry())}},{key:"direction",get:function(){return this._direction},set:function(e){(0,_.k)(this._direction,e)||((0,_.c)(this._direction,e),this._updateGeometry())}},{key:"setDirectionFromPoints",value:function(e,t){(0,_.n)(this._direction,(0,_.b)(this._direction,t,e)),this._updateGeometry()}},{key:"width",get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,this._updateMaterial())}},{key:"offset",get:function(){return this._offset},set:function(e){e!==this._offset&&(this._offset=e,this._updateGeometry())}},{key:"length",get:function(){return this._length},set:function(e){e!==this._length&&(this._length=e,this._updateGeometry())}},{key:"color",get:function(){return this._color},set:function(e){(0,ae.g)(e,this._color)||((0,ae.c)(this._color,e),this._updateMaterial())}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"_createObject3DResources",value:function(e){var t=new ct.U(this.materialParameters),i=new Array;return this._createObject3DGeometry(t,e,i),{material:t,geometries:i,forEach:function(e){e(t),i.forEach(e)}}}},{key:"_destroyObject3DResources",value:function(e){e.geometries.length=0,e.material.dispose()}},{key:"_recreateObject3DGeometry",value:function(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}},{key:"_createObject3DGeometry",value:function(e,t,i){var n=this._createGeometries(e),a=(0,Z.Z)(n,2),r=a[0],o=a[1];t.addGeometry(r),t.addGeometry(o),i.push(r),i.push(o),this._updateVerticesObject3D(t)}},{key:"_createDrapedResources",value:function(){var e=this,t=new ct.U(this.materialParameters),i=(0,h.YP)((function(){return e.view.state.contentPixelRatio}),(function(){e.drapedResources.recreateGeometry()}));return{material:t,geometries:this._createDrapedGeometry(t),pixelRatioHandle:i}}},{key:"_destroyDrapedResources",value:function(e){e.pixelRatioHandle.remove(),e.geometries=[],e.material.dispose()}},{key:"_recreateDrapedGeometry",value:function(e){e.geometries=this._createDrapedGeometry(e.material)}},{key:"_createDrapedGeometry",value:function(e){var t=this._createGeometries(e);this._updateVerticesDraped(t);var i,n=t.map((function(e){return new lt.z(e,{boundingInfo:e.boundingInfo})})),a=(0,G.Z)(n);try{for(a.s();!(i=a.n()).done;){var r=i.value;r.computeBoundingSphere(r.transformation,r.boundingSphere)}}catch(o){a.e(o)}finally{a.f()}return n}},{key:"_createGeometries",value:function(e){return[(0,ot.rh)(e,[(0,g.c)(),(0,g.c)()]),(0,ot.rh)(e,[(0,g.c)(),(0,g.c)()])]}},{key:"_updateMaterial",value:function(){var e,t,i=this.materialParameters;null!==(e=(0,u.WG)(this.object3dResources.resources))&&void 0!==e&&e.material.setParameters(i),null===(t=(0,u.WG)(this.drapedResources.resources))||void 0===t||t.material.setParameters(i)}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}},{key:"_updateGeometry",value:function(){if(this.isDraped)this.drapedResources.recreateGeometry();else{var e=(0,u.WG)(this.object3dResources.object);e&&this._updateVerticesObject3D(e)}}},{key:"_updateVerticesObject3D",value:function(e){var t=this.view.state.camera;t.projectToScreen(this.location,wt),(0,_.a)(mt,this.location,this.direction),t.projectToScreen(mt,xt),(0,A.f)(xt,(0,A.a)(xt,xt,wt)),this._updateVertexAttributesObject3D(t,e,0,wt,xt,1),this._updateVertexAttributesObject3D(t,e,1,wt,xt,-1)}},{key:"_updateVertexAttributesObject3D",value:function(e,t,i,n,a,r){var o,s=t.geometries[i],l=null===(o=s.getMutableAttribute(ke.T.POSITION))||void 0===o?void 0:o.data;if(l){var c=this._computeStartEnd(a,n,r,this.offset,this.width,this.length),u=c.start,h=c.end;e.unprojectFromScreen((0,b.c$)(u),mt),l[0]=mt[0],l[1]=mt[1],l[2]=mt[2],e.unprojectFromScreen((0,b.c$)(h),mt),l[3]=mt[0],l[4]=mt[1],l[5]=mt[2],t.geometryVertexAttrsUpdated(s)}}},{key:"_updateVerticesDraped",value:function(e){var t=this.view,i=t.basemapTerrain.overlayManager,n=t.state.contentPixelRatio,a=this.location,r=this.width,o=this.length,s=this.offset,l=Ct;l.spatialReference=(0,u.Wg)(i.renderer.spatialReference),l.x=a[0],l.y=a[1];var c=i.overlayPixelSizeInMapUnits(l)*n,h=r*c,d=o*c,p=s*c;this._updateVertexAttributesDraped(e[0],h,d,p,-1),this._updateVertexAttributesDraped(e[1],h,d,p,1)}},{key:"_updateVertexAttributesDraped",value:function(e,t,i,n,a){var r,o=null===(r=e.getMutableAttribute(ke.T.POSITION))||void 0===r?void 0:r.data;if(o){var s=this.location,l=this.direction,c=this._computeStartEnd(l,s,a,n,t,i),u=c.start,h=c.end;o[0]=u[0],o[1]=u[1],o[2]=rt.Rn,o[3]=h[0],o[4]=h[1],o[5]=rt.Rn,e.invalidateBoundingInfo()}}},{key:"_computeStartEnd",value:function(e,t,i,n,a,r){var o=(0,A.b)(bt,(0,A.s)(bt,e[1]*i,e[0]*-i),n+a/2),s=(0,A.j)(Mt,(0,A.j)(Mt,(0,A.j)(Mt,t,(0,A.b)(Mt,e,r/2)),o),o);return{start:s,end:(0,A.j)(St,s,(0,A.b)(St,e,-r))}}}]),i}(Se),mt=(0,g.c)(),bt=(0,T.a)(),Mt=(0,T.a)(),St=(0,T.a)(),wt=(0,b.s1)(),xt=(0,b.s1)(),Ct=(0,gt.Tx)(0,0,void 0,null),Ot=i(67077),Et=i(41414),kt=i(11185),At=i(69691),Tt=i(78935),Pt=i(67794),Rt=i(48800),Dt=function(){function e(t){var i=this;(0,a.Z)(this,e),this.view=null,this._geometry=null,this._size=3,this._color=(0,Ot.f)(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=(0,Ot.f)(1,1,1,1),this._elevationInfo=null,this._resources=new Me({view:t.view,createResources:function(e){return i._createResources(e)},destroyResources:function(e){return i._destroyResources(e)},recreateGeometry:function(e,t){e.geometry=i._recreateGeometry(t,e.material)}});var n=!0;for(var r in t){var o;r in this?"attached"===r?n=null!==(o=t[r])&&void 0!==o&&o:this[r]=t[r]:console.error("Cannot set unknown property",r)}this.attached=n}return(0,r.Z)(e,[{key:"destroy",value:function(){this._resources.destroy()}},{key:"visible",get:function(){return this._resources.visible},set:function(e){this._resources.visible=e}},{key:"attached",get:function(){return this._resources.attached},set:function(e){this._resources.attached=e}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this._resources.recreateGeometry()}},{key:"size",get:function(){return this._size},set:function(e){if(e!==this._size){var t=this._preferredTextureSize;this._size=e,t<this._preferredTextureSize?(0,u.pC)(this._resources)&&this._resources.recreate():this._updateSizeAttribute()}}},{key:"color",get:function(){return this._color},set:function(e){(0,ae.g)(e,this._color)||((0,ae.c)(this._color,e),this._updateMaterial())}},{key:"pixelSnappingEnabled",get:function(){return this._pixelSnappingEnabled},set:function(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}},{key:"primitive",get:function(){return this._primitive},set:function(e){this._primitive!==e&&(this._primitive=e,(0,u.pC)(this._resources)&&this._resources.recreate())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(e){(0,ae.g)(e,this._outlineColor)||((0,ae.c)(this._outlineColor,e),this._updateMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this._resources&&this._resources.recreateGeometry()}},{key:"_updateMaterial",value:function(){var e=this._resources.resources;(0,u.Wi)(e)||e.material.setParameters(this._materialParameters(e.texture.id))}},{key:"_updateSizeAttribute",value:function(){var e=this._resources.resources,t=this._resources.object;if(!(0,u.Wi)(e)&&!(0,u.Wi)(t)){var i=e.geometry;if(!(0,u.Wi)(i)){var n=i.getMutableAttribute(ke.T.SIZE).data,a=this._geometrySize;n[0]=a,n[1]=a,t.geometryVertexAttrsUpdated(t.geometries[0])}}}},{key:"_materialParameters",value:function(e){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:Gt,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:e,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}}},{key:"_geometrySize",get:function(){return this._size/Zt}},{key:"_recreateGeometry",value:function(e,t){var i=this._createRenderGeometry(t);return(0,u.pC)(i)&&e.addGeometry(i),i}},{key:"_createResources",value:function(e){var t=(0,Pt.cU)(this._primitive,this._preferredTextureSize),i=new Rt.A(this._materialParameters(t.id)),n=this._recreateGeometry(e,i);return{material:i,texture:t,geometry:n,forEach:function(e){e(t),e(i),(0,u.pC)(this.geometry)&&e(this.geometry)}}}},{key:"_destroyResources",value:function(e){e.geometry=null,e.material.dispose(),e.texture.dispose()}},{key:"_preferredTextureSize",get:function(){return(0,Ye.uZ)((0,Ye.Sf)(2*this._geometrySize),16,128)}},{key:"calculateMapBounds",value:function(e){if((0,u.Wi)(this._resources.resources)||(0,u.Wi)(this._resources.resources.geometry))return!1;var t=this._resources.resources.geometry.vertexAttributes.get(ke.T.POSITION);return(0,te.SH)(t.data,this.view.renderCoordsHelper.spatialReference,Lt,this.view.spatialReference),(0,Et.G1)(e,Lt),!0}},{key:"_createRenderGeometry",value:function(e){var t=this.geometry;if((0,u.Wi)(t))return null;var i=this.view,n=i.renderCoordsHelper,a=i.elevationProvider,r=(0,At.w7)(t,a,Tt.o.fromElevationInfo(this.elevationInfo),n),o=(0,_.s)(kt.WM.get(),t.x,t.y,r),s=kt.WM.get();(0,te.SH)(o,t.spatialReference,s,n.spatialReference);var l=this._geometrySize;return(0,ot.dV)(e,null,s,null,[l,l],[0,0,0,1])}}]),e}(),Zt=Pt.Ns,Gt=[Zt/2,Zt/2,1-Zt/2,1-Zt/2],Lt=(0,g.c)(),It=i(14226),Vt=i(81949),zt=i(91526),Wt=i(95774),Nt=i(66832),jt=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._maxSize=0,n._position=(0,g.c)(),n._up=(0,g.c)(),n._right=(0,g.c)(),n._renderOccluded=st.yD.OccludeAndTransparent,n._color=(0,Ot.f)(1,0,0,1),n._outlineColor=(0,Ot.f)(0,0,0,1),n._outlineSize=0,n._size=32,n._outlineRenderOccluded=st.yD.Opaque,n.applyProps(e),n}return(0,r.Z)(i,[{key:"createObject3DResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(e){return t._createObject3DResources(e)},destroyResources:function(e){return t._destroyObject3DResources(e)},cameraChanged:function(){return t._updateTransformObject3D()}}}},{key:"createDrapedResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(){return t._createDrapedResources()},destroyResources:function(e){return t._destroyDrapedResources(e)}}}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}},{key:"color",get:function(){return this._color},set:function(e){(0,ae.c)(this._color,e),this._updateQuadMaterial()}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(e){(0,ae.c)(this._outlineColor,e),this._updateOutlineMaterial()}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(e){var t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}},{key:"size",get:function(){return this._size},set:function(e){e!==this._size&&(this._size=e,this._updateTransform())}},{key:"outlineRenderOccluded",get:function(){return this._outlineRenderOccluded},set:function(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}},{key:"geometry",set:function(e){var t=e.previous,i=e.center,n=e.next;this._maxSize=Math.min((0,_.i)(i,t),(0,_.i)(i,n))/3,(0,_.n)(this._up,(0,_.b)(this._up,t,i)),(0,_.n)(this._right,(0,_.b)(this._right,n,i)),(0,_.c)(this._position,i),this.recreateGeometry()}},{key:"_createObject3DResources",value:function(e){var t=new Nt.E(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new ct.U(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,i),{quadMaterial:t,outlineMaterial:i,forEach:function(e){e(t),i&&e(i)}}}},{key:"_destroyObject3DResources",value:function(e){var t;e.quadMaterial.dispose(),null===(t=e.outlineMaterial)||void 0===t||t.dispose()}},{key:"_createObject3DGeometries",value:function(e,t,i){if(!(0,_.k)(this._up,g.Z)||!(0,_.k)(this._right,g.Z)){var n,a=this._createGeometries(t,i),r=(0,G.Z)(a);try{for(r.s();!(n=r.n()).done;){var o=n.value;e.addGeometry(o)}}catch(s){r.e(s)}finally{r.f()}this._updateTransformObject3D(e)}}},{key:"_createDrapedResources",value:function(){var e=this,t=new Nt.E(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new ct.U(this._outlineMaterialParameters),n=this._createGeometries(t,i).map((function(e){return new lt.z(e,{boundingInfo:e.boundingInfo})}));return this._setTransformDraped(n),{quadMaterial:t,outlineMaterial:i,geometries:n,pixelRatioHandle:(0,h.YP)((function(){return e.view.state.contentPixelRatio}),(function(){e.drapedResources.recreateGeometry()}))}}},{key:"_destroyDrapedResources",value:function(e){var t;e.pixelRatioHandle.remove(),e.geometries=[],null!==(t=e.outlineMaterial)&&void 0!==t&&t.dispose(),e.quadMaterial.dispose()}},{key:"_createGeometries",value:function(e,t){var i=this._getVertices(),n=i.up,a=i.right,r=i.corner,o=this._quadGeometryData(n,a,r,e);return t?[o,(0,ot.rh)(t,[n,r,a])]:[o]}},{key:"_getVertices",value:function(){var e=this._up,t=this._right,i=(0,_.a)(kt.WM.get(),e,t);return this.isDraped&&(e=(0,_.c)(kt.WM.get(),e),t=(0,_.c)(kt.WM.get(),t),e[2]=0,t[2]=0,i[2]=0),{up:e,right:t,corner:i}}},{key:"_updateTransform",value:function(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}},{key:"_updateTransformObject3D",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,u.WG)(this.object3dResources.object);if(e){var t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),n=Math.min(this._maxSize,i);(0,It.f)(Ft,this._position),(0,It.k)(Ft,Ft,[n,n,n]),e.transformation=Ft}}},{key:"_setTransformDraped",value:function(e){if(0!==e.length){var t=this.view,i=t.basemapTerrain.overlayManager,n=t.state.contentPixelRatio,a=this._position,r=this._size,o=(0,_.c)(kt.WM.get(),a);o[2]=rt.Rn;var s=Ht;s.spatialReference=(0,u.Wg)(i.renderer.spatialReference),s.x=o[0],s.y=o[1];var l=r*(i.overlayPixelSizeInMapUnits(s)*n),c=Math.min(this._maxSize,l);(0,It.f)(Ft,o),(0,It.k)(Ft,Ft,[c,c,1]);var h,d=(0,G.Z)(e);try{for(d.s();!(h=d.n()).done;){h.value.updateTransformation((function(e){(0,It.c)(e,Ft)}))}}catch(p){d.e(p)}finally{d.f()}}}},{key:"_quadGeometryData",value:function(e,t,i,n){return new Wt.Z(n,[[ke.T.POSITION,new zt.a([0,0,0].concat((0,S.Z)(t),(0,S.Z)(e),(0,S.Z)(i)),3,!0)]],[[ke.T.POSITION,[0,1,2,1,2,3]]])}},{key:"_quadMaterialParameters",get:function(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}},{key:"_updateQuadMaterial",value:function(){var e,t;null!==(e=(0,u.WG)(this.object3dResources.resources))&&void 0!==e&&e.quadMaterial.setParameters(this._quadMaterialParameters),null===(t=(0,u.WG)(this.drapedResources.resources))||void 0===t||t.quadMaterial.setParameters(this._quadMaterialParameters)}},{key:"_outlineMaterialParameters",get:function(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}},{key:"_updateOutlineMaterial",value:function(){var e,t,i,n;null!==(e=(0,u.WG)(this.object3dResources.resources))&&void 0!==e&&null!==(t=e.outlineMaterial)&&void 0!==t&&t.setParameters(this._outlineMaterialParameters),null===(i=(0,u.WG)(this.drapedResources.resources))||void 0===i||null===(n=i.outlineMaterial)||void 0===n||n.setParameters(this._outlineMaterialParameters)}}]),i}(Se),Ft=(0,Vt.c)(),Ht=(0,gt.Tx)(0,0,void 0,null),Ut=i(76014),Bt=i(80371),Yt=i(1700),Xt=i(64674),qt=i(38561),Qt=i(53397),Jt=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"sortUniqueHints",value:function(e){return e.sort((function(e,t){return(t instanceof Qt.w?t.length:0)-(e instanceof Qt.w?e.length:0)}))}},{key:"visualizeIntersectionPoint",value:function(e,t){var i=t.spatialReference,n=t.view;return(0,c.ed)(new Dt({view:n,primitive:"circle",geometry:(0,Yt.SH)(e.intersectionPoint,i),elevationInfo:e.isDraped?y.tR:y.jG,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:L.Z.toUnitRGBA(Ut.c.orange),pixelSnappingEnabled:!1}))}},{key:"visualizePoint",value:function(e,t){var i=t.view,n=t.spatialReference,a=this._alignPoint(e.point,e.domain,t);return(0,c.ed)(new Dt({view:i,primitive:"circle",geometry:(0,Yt.SH)(a,n),elevationInfo:this._hintElevationInfo(e,t),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:L.Z.toUnitRGBA(Ut.c.orange),pixelSnappingEnabled:!1}))}},{key:"visualizeLine",value:function(e,t){var i=t.view,n=t.spatialReference,a=this._alignPoint(e.lineStart,e.domain,t),r=this._alignPoint(e.lineEnd,e.domain,t);return(0,c.ed)(this._createLineSegmentHint(e.type,a,r,n,this._hintElevationInfo(e,t),i,e.isDraped,e.fadeLeft,e.fadeRight))}},{key:"visualizeParallelSign",value:function(e,t){var i=t.view,n=t.spatialReference,a=e.isDraped,r=this._hintElevationInfo(e,t),o=this._alignPoint(e.lineStart,e.domain,t),s=this._alignPoint(e.lineEnd,e.domain,t),l=Kt(o,n,r,i,a),u=Kt(s,n,r,i,a),h=(0,_.h)(u,l,u,.5),d=new yt({view:i,attached:!1,offset:Ut.c.parallelLineHintOffset,length:Ut.c.parallelLineHintLength,width:Ut.c.parallelLineHintWidth,color:L.Z.toUnitRGBA(Ut.c.orange),location:h,renderOccluded:a?st.yD.OccludeAndTransparent:st.yD.Opaque,isDraped:a,renderGroup:he.eZ.SnappingHint});return d.setDirectionFromPoints(l,h),d.attached=!0,(0,c.ed)(d)}},{key:"visualizeRightAngleQuad",value:function(e,t){var i=t.view,n=t.spatialReference,a=this._hintElevationInfo(e,t),r=e.isDraped,o=this._alignPoint(e.previousVertex,e.domain,t),s=this._alignPoint(e.centerVertex,e.domain,t),l=this._alignPoint(e.nextVertex,e.domain,t),u=Kt(o,n,a,i,r),h=Kt(s,n,a,i,r),d=Kt(l,n,a,i,r);return(0,c.ed)(new jt({view:i,attached:!0,color:r?L.Z.toUnitRGBA(Ut.c.orangeTransparent):L.Z.toUnitRGBA(Ut.c.orange),renderOccluded:r?st.yD.OccludeAndTransparent:st.yD.Transparent,outlineRenderOccluded:r?st.yD.OccludeAndTransparent:st.yD.Opaque,outlineColor:L.Z.toUnitRGBA(Ut.c.orange),outlineSize:Ut.c.rightAngleHintOutlineSize,size:Ut.c.rightAngleHintSize,isDraped:r,geometry:{previous:u,center:h,next:d},renderGroup:he.eZ.SnappingHint}))}},{key:"_createLineSegmentHint",value:function(e,t,i,n,a,r){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],c=Kt(t,n,a,r,o),u=Kt(i,n,a,r,o),h=new ut({view:r,extensionType:et.FADED,start:c,end:u,isDraped:o,color:L.Z.toUnitRGBA(Ut.c.orange),renderOccluded:o?st.yD.OccludeAndTransparent:st.yD.Opaque,renderGroup:he.eZ.SnappingHint});switch(e){case Xt.ze.TARGET:h.width=Ut.c.lineHintWidthTarget,h.fadedExtensions={start:0,end:Ut.c.lineHintFadedExtensions};break;case Xt.ze.REFERENCE_EXTENSION:h.width=Ut.c.lineHintWidthReference,h.fadedExtensions={start:0,end:0};break;case Xt.ze.REFERENCE:h.width=Ut.c.lineHintWidthReference,h.fadedExtensions={start:s?Ut.c.lineHintFadedExtensions:0,end:l?Ut.c.lineHintFadedExtensions:0}}return h.attached=!0,h}},{key:"_alignPoint",value:function(e,t,i){var n=this._getSelfSnappingZ(t,i);return(0,u.Wi)(n)?e:(0,Yt.$G)(e[0],e[1],n)}},{key:"_hintElevationInfo",value:function(e,t){return(0,u.pC)(this._getSelfSnappingZ(e.domain,t))?(0,u.Wg)(t.selfSnappingZ).elevationInfo:e.isDraped?y.tR:y.jG}},{key:"_getSelfSnappingZ",value:function(e,t){var i=t.selfSnappingZ;return e===Bt.B.SELF&&(0,u.pC)(i)?i.value:null}}]),i}(qt.a);function Kt(e,t,i,n,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,g.c)();if(a){var o=n.basemapTerrain.overlayManager.renderer.spatialReference;(0,te.SH)(e,t,r,o)}else(0,K.RS)(e,t,i,n,r);return r}var $t=i(97326),ei=i(86950),ti=i(86700),ii={main:new L.Z([255,127,0]),selected:new L.Z([255,255,255]),staged:new L.Z([12,207,255]),outline:new L.Z([0,0,0,.5]),selectedOutline:new L.Z([255,255,255])},ni=.3;function ai(e,t){var i=e.clone();return i.a*=t,i}function ri(e,t){var i=e.clone(),n=(0,ei._Y)(i);n.s*=t;var a=(0,ei.xr)(n);return i.r=a.r,i.g=a.g,i.b=a.b,i}function oi(e,t){if(t)for(var i in t)e[i]=t[i]}var si=(0,r.Z)((function e(t){(0,a.Z)(this,e),this.color=ii.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=st.yD.Opaque,oi(this,t)})),li=function(){function e(t){(0,a.Z)(this,e),this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=ii.main,this.outlineColor=ii.outline,this.renderOccluded=st.yD.Opaque,this.hoverOutlineColor=ii.selectedOutline,oi(this,t)}return(0,r.Z)(e,[{key:"apply",value:function(e,t){var i=this[e];t.setParameters({color:yi(i),transparent:"color"!==e||i.a<1,renderOccluded:this.renderOccluded})}}]),e}(),ci=function(){function e(t){(0,a.Z)(this,e),this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.color=ai(ii.main,.5),this.hoverColor=ii.main,this.renderOccluded=st.yD.Transparent,this.minSquaredEdgeLength=900,oi(this,t)}return(0,r.Z)(e,[{key:"apply",value:function(e,t){var i=this[e];t.setParameters({color:yi(i),transparent:i.a<1,renderOccluded:this.renderOccluded})}}]),e}(),ui=(0,r.Z)((function e(t){(0,a.Z)(this,e),this.vertex=new li({color:ii.main,outlineColor:ii.outline}),this.edge=new li({color:ri(ai(ii.main,2/3),.5),outlineColor:ai(ii.outline,.5),size:8,collisionPadding:8}),this.selected=new li({color:ii.selected,outlineColor:ii.outline}),this.edgeOffset=new ci,oi(this,t)})),hi=function(){function e(t){(0,a.Z)(this,e),this.color=ii.selected,this.width=1.5,this.stipplePattern=(0,ti.z5)(5),this.stippleOffColor=ii.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=ii.selected,this.renderOccluded=st.yD.OccludeAndTransparent,oi(this,t)}return(0,r.Z)(e,[{key:"apply",value:function(e){e.color=yi(this.color),e.width=this.width,e.stipplePattern=this.stipplePattern,e.stippleOffColor=yi(this.stippleOffColor),e.falloff=this.falloff,e.innerWidth=this.innerWidth,e.innerColor=yi(this.innerColor),e.renderOccluded=this.renderOccluded}}]),e}(),di=function(){function e(t){(0,a.Z)(this,e),this.color=ii.selected,this.size=4,this.outlineSize=1,this.outlineColor=ii.outline,this.shape="square",oi(this,t)}return(0,r.Z)(e,[{key:"apply",value:function(e){e.color=yi(this.color),e.size=this.size,e.outlineSize=this.outlineSize,e.outlineColor=yi(this.outlineColor),e.primitive=this.shape}}]),e}(),pi=function(){function e(t){(0,a.Z)(this,e),this.innerColor=ii.selected,this.innerWidth=1,this.glowColor=ii.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=ni,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=ii.main,oi(this,t)}return(0,r.Z)(e,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i={glowColor:L.Z.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:L.Z.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*t,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=i:e.laserlineStyle=i}}]),e}(),fi=(0,r.Z)((function e(t){(0,a.Z)(this,e),this.outline=new hi({color:ii.outline,renderOccluded:st.yD.OccludeAndTransparentStencil,stippleOffColor:ii.selected,stipplePattern:(0,ti.z5)(5),width:1.5,innerWidth:0}),this.staged=new hi({color:ii.selected,renderOccluded:st.yD.OccludeAndTransparentStencil,innerColor:ii.staged,stippleOffColor:ii.outline,stipplePattern:(0,ti.z5)(5),width:1.5}),this.shadowStyle=new pi({globalAlpha:ni,glowColor:ii.main,glowFalloff:8,glowWidth:8,innerColor:ii.selected,innerWidth:1}),oi(this,t)})),vi=(0,r.Z)((function e(t){(0,a.Z)(this,e),this.outline=new di({color:ii.selected,outlineColor:ii.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new pi({globalAlpha:ni,glowColor:ii.main,glowFalloff:1.5,glowWidth:6,innerColor:ii.selected,innerWidth:1,radius:2}),oi(this,t)})),_i=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this)).extensionType=et.GROUND_RAY,oi((0,$t.Z)(n),e),n}return(0,r.Z)(i)}(hi),gi=(0,r.Z)((function e(t){(0,a.Z)(this,e),this.lineGraphics=new fi,this.pointGraphics=new vi,this.heightPlane=new pi({globalAlpha:ni,glowColor:ii.main,glowFalloff:8,glowWidth:8,innerColor:ii.selected,innerWidth:1}),this.heightBox=new pi({globalAlpha:ni,glowColor:ii.main,glowFalloff:8,glowWidth:8,innerColor:ii.selected,innerWidth:0,heightFillColor:ii.main}),this.zVerticalLine=new _i({color:ai(ii.main,.5),falloff:2,innerColor:ai(ii.selected,0),renderOccluded:st.yD.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:et.GROUND_RAY}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,oi(this,t)}));function yi(e){return(0,Ot.b)(L.Z.toUnitRGBA(e))}var mi=new(function(){function e(t){(0,a.Z)(this,e),this.visualElements=new gi,this.reshapeManipulators=new ui,this.zManipulator=new si,oi(this,t)}return(0,r.Z)(e,[{key:"colorToVec4",value:function(e){return yi(e)}}]),e}()),bi=i(91505),Mi=i(79685),Si=i(78081),wi=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n,r;return(0,a.Z)(this,i),(r=t.call(this,e))._attachmentOrigin=(0,gt.Tx)(0,0,0,null),r._attachmentOriginDirty=!0,r.events=new bi.Z,r._geometry=null,r._width=1,r._color=(0,re.f)(1,0,1,1),r._innerWidth=0,r._innerColor=(0,re.f)(1,1,1,1),r._stipplePattern=null,r._stippleOffColor=null,r._falloff=0,r._elevationInfo=null,r._laserlineStyle=null,r._laserlineEnabled=!1,r._renderOccluded=st.yD.OccludeAndTransparentStencil,r._attachmentOrigin.spatialReference=e.view.spatialReference,r._laserline=new nt({view:e.view}),r.applyProps(e),r.attached=null===(n=e.attached)||void 0===n||n,r}return(0,r.Z)(i,[{key:"destroy",value:function(){this._laserline.destroy(),(0,ie.Z)((0,ne.Z)(i.prototype),"destroy",this).call(this)}},{key:"createObject3DResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(e){return t._createObject3DResources(e)},destroyResources:function(e){return t._destroyExternalResources(e)},recreateGeometry:function(e,i){e.geometries.length=0,t._recreateGeometry(i,e.material,e.geometries)}}}},{key:"createDrapedResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(){return t._createDrapedResources()},destroyResources:function(e){return t._destroyExternalResources(e)},recreateGeometry:function(e){e.geometries=t._createRenderGeometriesDraped(e.material),t._attachmentOriginChanged()}}}},{key:"_laserlineAttached",get:function(){return this.attached&&this.visible&&(0,u.pC)(this._laserlineStyle)&&!this.isDraped&&this.laserlineEnabled}},{key:"onAttachedChange",value:function(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"width",get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,this._updateMaterial())}},{key:"color",get:function(){return this._color},set:function(e){(0,ae.g)(e,this._color)||((0,ae.c)(this._color,e),this._updateMaterial())}},{key:"innerWidth",get:function(){return this._innerWidth},set:function(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(e){(0,ae.g)(e,this._innerColor)||((0,ae.c)(this._innerColor,e),this._updateMaterial())}},{key:"stipplePattern",get:function(){return this._stipplePattern},set:function(e){var t=(0,u.pC)(e)!==(0,u.pC)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(e){e&&this._stippleOffColor&&(0,ae.g)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,re.c)(e):null,this._updateMaterial())}},{key:"falloff",get:function(){return this._falloff},set:function(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this.recreateGeometry()}},{key:"laserlineStyle",get:function(){return this._laserlineStyle},set:function(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,(0,u.pC)(e)&&(this._laserline.style=e)}},{key:"laserlineEnabled",get:function(){return this._laserlineEnabled},set:function(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"attachmentOrigin",get:function(){var e;if(!this._attachmentOriginDirty)return this._attachmentOrigin;var t=null===(e=(0,u.WG)(this.object3dResources.resources))||void 0===e?void 0:e.geometries;if(!t||0===t.length)return null;(0,_.s)(Oi,0,0,0);var i,n=0,a=(0,G.Z)(t);try{for(a.s();!(i=a.n()).done;){i.value.computeAttachmentOrigin(Ci)&&((0,_.a)(Oi,Oi,Ci),n++)}}catch(r){a.e(r)}finally{a.f()}return 0===n?null:((0,_.g)(Oi,Oi,1/n),this.view.renderCoordsHelper.fromRenderCoords(Oi,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}},{key:"_updateMaterial",value:function(){(0,u.pC)(this.object3dResources.resources)&&this.object3dResources.resources.material.setParameters(this._materialParameters),(0,u.pC)(this.drapedResources.resources)&&this.drapedResources.resources.material.setParameters(this._materialParameters)}},{key:"_isClosed",get:function(){return(0,u.pC)(this.geometry)&&"polygon"===this.geometry.type}},{key:"_materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded}}},{key:"_normalizedRenderOccluded",get:function(){return this.isDraped&&this._renderOccluded===st.yD.OccludeAndTransparentStencil?st.yD.OccludeAndTransparent:this._renderOccluded}},{key:"_recreateGeometry",value:function(e,t,i){this._createRenderGeometries(t,i);var n,a=(0,G.Z)(i);try{for(a.s();!(n=a.n()).done;){var r=n.value;e.addGeometry(r)}}catch(o){a.e(o)}finally{a.f()}this._attachmentOriginChanged()}},{key:"_attachmentOriginChanged",value:function(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}},{key:"_destroyExternalResources",value:function(e){e.geometries=[],e.material.dispose()}},{key:"_createObject3DResources",value:function(e){var t=new ct.U(this._materialParameters),i=new Array;return this._recreateGeometry(e,t,i),{material:t,geometries:i,forEach:function(e){e(t),i.forEach(e)}}}},{key:"_createDrapedResources",value:function(){var e=new ct.U(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}},{key:"_createRenderGeometriesDraped",value:function(e){var t=this.geometry;if((0,u.Wi)(t)||(0,u.Wi)(this.view.basemapTerrain.spatialReference))return[];var i,n=(0,Si.r)(t,this.view.basemapTerrain.spatialReference),a=[],r=(0,G.Z)(n.lines);try{for(r.s();!(i=r.n()).done;){var o=i.value.position,s={overlayInfo:{spatialReference:this.view.basemapTerrain.spatialReference,renderCoordsHelper:this.view.renderCoordsHelper},attributeData:{position:o},removeDuplicateStartEnd:this._isClosed},l=new lt.z((0,Mi.Y)(e,s)),c=(0,Et.cS)(xi);(0,Et.G1)(c,o),(0,ae.s)(l.boundingSphere,.5*(c[0]+c[3]),.5*(c[1]+c[4]),0,.5*Math.sqrt((c[3]-c[0])*(c[3]-c[0])+(c[4]-c[1])*(c[4]-c[1]))),a.push(l)}}catch(h){r.e(h)}finally{r.f()}return a}},{key:"calculateMapBounds",value:function(e){if((0,u.Wi)(this.object3dResources.resources))return!1;var t,i=this.view.renderCoordsHelper,n=(0,G.Z)(this.object3dResources.resources.geometries);try{for(n.s();!(t=n.n()).done;){var a=t.value.vertexAttributes.get(ke.T.POSITION),r=(0,Oe.bg)(a.data.length);(0,te.CM)(a.data,i.spatialReference,0,r,this.view.spatialReference,0,a.data.length/3),(0,Et.G1)(e,r)}}catch(o){n.e(o)}finally{n.f()}return!0}},{key:"_createRenderGeometries",value:function(e,t){var i,n=this.geometry;if(!(0,u.Wi)(n)){var a,r=(0,Si.V)(n,this.view.elevationProvider,this.view.renderCoordsHelper,Tt.o.fromElevationInfo(null!==(i=this.elevationInfo)&&void 0!==i?i:new m.Z({mode:(0,y.VW)(n,null)}))),o=new Array,s=(0,G.Z)(r.lines);try{for(s.s();!(a=s.n()).done;){var l=a.value,c=l.position,h={mapPositions:l.mapPositions,attributeData:{position:c},removeDuplicateStartEnd:this._isClosed};t.push((0,Mi.Y)(e,h)),o.push(c)}}catch(d){s.e(d)}finally{s.f()}this._laserline.pathVerticalPlane=o}}}]),i}(Se),xi=(0,Et.Ue)(),Ci=(0,g.c)(),Oi=(0,g.c)(),Ei=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e.view))._resources=null,n._transform=(0,Vt.c)(),n}return(0,r.Z)(i,[{key:"object",get:function(){return(0,u.pC)(this._resources)?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(e){(0,It.c)(this._transform,e),(0,u.pC)(this._resources)&&(this._resources.object.transformation=this._transform)}},{key:"recreate",value:function(){this.attached&&this.createResources()}},{key:"recreateGeometry",value:function(){if(!(0,u.Wi)(this._resources)){var e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}}},{key:"createResources",value:function(){this.destroyResources();var e=this.view._stage;if(e){var t=new be.F({pickable:!1,updatePolicy:pe.j.SYNC});e.add(t);var i=new ye.T({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((function(t){return e.add(t)})),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}}},{key:"destroyResources",value:function(){var e=this.view._stage;!(0,u.Wi)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((function(t){e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}},{key:"updateVisibility",value:function(e){(0,u.Wi)(this._resources)||(this._resources.object.visible=e)}}]),i}(_e);var ki=i(68401),Ai=i(25158),Ti=i(37081),Pi=i(23620),Ri=i(97731),Di=i(33236),Zi=i(78041),Gi=i(25920),Li=i(8883),Ii=i(72511),Vi=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"initializeProgram",value:function(e){return new Pe.$(e.rctx,i.shader.get().build(this.configuration),Wi)}},{key:"_setPipelineState",value:function(e){var t=this.configuration,i=e===Gi.A.NONE,n=e===Gi.A.FrontFace;return(0,Ze.sm)({blending:t.output!==Ti.H.Color&&t.output!==Ti.H.Alpha||!t.transparent?null:i?Zi.wu:(0,Zi.j7)(e),culling:(0,Ze.zp)(t.cullFace),depthTest:{func:n?De.wb.LESS:t.shadingEnabled?De.wb.LEQUAL:De.wb.LESS},depthWrite:i?t.writeDepth?Ze.LZ:null:(0,Zi.K5)(e),colorWrite:Ze.BK,polygonOffset:i||n?null:Zi.E0})}},{key:"initializePipeline",value:function(){return this._setPipelineState(this.configuration.transparencyPassType)}}]),i}(Te.A);Vi.shader=new Ae.J(Ii.S,(function(){return i.e(6556).then(i.bind(i,36556))}));var zi=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).output=Ti.H.Color,e.cullFace=ki.Vr.None,e.transparencyPassType=Gi.A.NONE,e.hasSlicePlane=!1,e.transparent=!1,e.writeDepth=!0,e.screenSizeEnabled=!0,e.shadingEnabled=!0,e.hasMultipassTerrain=!1,e.cullAboveGround=!1,e}return(0,r.Z)(i)}(Li.W);(0,l._)([(0,Ue.o)({count:Ti.H.COUNT})],zi.prototype,"output",void 0),(0,l._)([(0,Ue.o)({count:ki.Vr.COUNT})],zi.prototype,"cullFace",void 0),(0,l._)([(0,Ue.o)({count:Gi.A.COUNT})],zi.prototype,"transparencyPassType",void 0),(0,l._)([(0,Ue.o)()],zi.prototype,"hasSlicePlane",void 0),(0,l._)([(0,Ue.o)()],zi.prototype,"transparent",void 0),(0,l._)([(0,Ue.o)()],zi.prototype,"writeDepth",void 0),(0,l._)([(0,Ue.o)()],zi.prototype,"screenSizeEnabled",void 0),(0,l._)([(0,Ue.o)()],zi.prototype,"shadingEnabled",void 0),(0,l._)([(0,Ue.o)()],zi.prototype,"hasMultipassTerrain",void 0),(0,l._)([(0,Ue.o)()],zi.prototype,"cullAboveGround",void 0);var Wi=new Map([[ke.T.POSITION,0],[ke.T.NORMAL,1],[ke.T.OFFSET,2]]),Ni=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e,new Fi)).supportsEdges=!0,n._configuration=new zi,n._vertexAttributeLocations=Wi,n}return(0,r.Z)(i,[{key:"getConfiguration",value:function(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}},{key:"intersect",value:function(e,t,i,n,a,r){var o=this;if(this.parameters.screenSizeEnabled){var s=e.vertexAttributes.get(ke.T.OFFSET),l={applyToVertex:function(e,t,n,a){var r=(0,_.s)(Ui,s.data[3*a+0],s.data[3*a+1],s.data[3*a+2]),l=(0,_.s)(Bi,e,t,n);return(0,_.g)(r,r,o.parameters.screenSizeScale*i.camera.computeRenderPixelSizeAt(r)),(0,_.a)(l,l,r),[l[0],l[1],l[2]]},applyToAabb:function(e){var t=(0,Et.be)(e,Ui);return(0,Et.bA)(e,o.parameters.screenSizeScale*i.camera.computeRenderPixelSizeAt(t))}};(0,He.Bw)(e,i,n,a,l,r)}else(0,He.Bw)(e,i,n,a,void 0,r)}},{key:"requiresSlot",value:function(e,t){if(t===Ti.H.Highlight)return e===Fe.r.OPAQUE_MATERIAL;if(t===Ti.H.Color||t===Ti.H.Alpha||t===Ti.H.ObjectAndLayerIdColor){var i=Fe.r.OPAQUE_MATERIAL;return this.parameters.transparent&&(i=this.parameters.writeDepth?Fe.r.TRANSPARENT_MATERIAL:Fe.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===i||e===Fe.r.DRAPED_MATERIAL}return!1}},{key:"createGLMaterial",value:function(e){return new ji(e)}},{key:"createBufferWriter",value:function(){return new Hi(this.parameters.screenSizeEnabled)}}]),i}(st.F5),ji=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"beginSlot",value:function(e){return this.ensureTechnique(Vi,e)}}]),i}(Pi.Z),Fi=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).color=(0,Ot.f)(1,1,1,1),e.shadingTint=(0,Ot.f)(0,0,0,.25),e.shadingDirection=(0,_.n)((0,g.c)(),[.5,-.5,-.5]),e.screenSizeScale=14,e.transparent=!1,e.writeDepth=!0,e.hasSlicePlane=!1,e.cullFace=ki.Vr.None,e.screenSizeEnabled=!1,e.shadingEnabled=!0,e}return(0,r.Z)(i)}(st.Mt),Hi=function(){function e(t){(0,a.Z)(this,e),this.screenSizeEnabled=t;var i=(0,Ce.U$)().vec3f(ke.T.POSITION).vec3f(ke.T.NORMAL);this.screenSizeEnabled&&i.vec3f(ke.T.OFFSET),this.vertexBufferLayout=i}return(0,r.Z)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get(ke.T.POSITION).length}},{key:"write",value:function(e,t,i,n,a){if((0,Di.NK)(i,this.vertexBufferLayout,e,t,n,a),this.screenSizeEnabled){if(!i.vertexAttributes.has(ke.T.OFFSET))throw new Error("".concat(ke.T.OFFSET," vertex attribute required for screenSizeEnabled ShadedColorMaterial"));var r=i.vertexAttributes.get(ke.T.OFFSET),o=i.indices.get(ke.T.OFFSET);(0,Ri.hu)(3===r.size);var s=n.getField(ke.T.OFFSET,Ai.ct);if(!s)throw new Error("unable to acquire view for "+ke.T.OFFSET);(0,Di.ho)(o,r.data,t,s,a)}}}]),e}(),Ui=(0,g.c)(),Bi=(0,g.c)(),Yi=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).view=null,n._renderOccluded=st.yD.OccludeAndTransparent,n._vertices=null,n._spatialReference=null,n._color=mi.colorToVec4(mi.reshapeManipulators.vertex.color),n._size=mi.reshapeManipulators.vertex.size,n._outlineColor=mi.colorToVec4(mi.reshapeManipulators.vertex.outlineColor),n._outlineSize=mi.reshapeManipulators.vertex.outlineSize,n._elevationInfo=null,n.applyProps(e),n}return(0,r.Z)(i,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial(),this._updateOutlineMaterial())}},{key:"vertices",get:function(){return this._vertices},set:function(e){this._vertices=e,this.recreateGeometry()}},{key:"spatialReference",get:function(){return this._spatialReference},set:function(e){this._spatialReference=e,this.recreateGeometry()}},{key:"color",get:function(){return this._color},set:function(e){(0,ae.g)(e,this._color)||((0,ae.c)(this._color,e),this._updateMaterial())}},{key:"size",get:function(){return this._size},set:function(e){e!==this._size&&(this._size=e,this._updateMaterial())}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(e){(0,ae.g)(e,this._outlineColor)||((0,ae.c)(this._outlineColor,e),this._updateOutlineMaterial())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateOutlineMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this.recreateGeometry()}},{key:"_vertexMaterialParameters",get:function(){return{color:this._color,transparent:this._color[3]<1,screenSizeScale:this.size,renderOccluded:this._renderOccluded}}},{key:"_vertexOutlineMaterialParameters",get:function(){return{color:this._outlineColor,transparent:this._outlineColor[3]<1,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}},{key:"_updateMaterial",value:function(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}},{key:"_updateOutlineMaterial",value:function(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}},{key:"_createRenderGeometries",value:function(){var e=this.vertices;if((0,u.Wi)(e)||0===e.length)return[];for(var t=function(e,t,i,n,a){var r=(0,Oe.bg)(3*e.length),o=(0,Oe.bg)(r.length);e.forEach((function(e,t){r[3*t+0]=e[0],r[3*t+1]=e[1],r[3*t+2]=e.length>2?e[2]:0}));var s=(0,At.rR)(r,t,0,o,0,r,0,r.length/3,i,n,a),l=null!=s;return{numVertices:e.length,position:r,mapPositions:o,projectionSuccess:l,sampledElevation:s}}(e,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,Tt.o.fromElevationInfo(this.elevationInfo)),i=[],n=t.numVertices,a=t.position,r=0;r<n;++r){var o=(0,_.s)(Xi,a[3*r+0],a[3*r+1],a[3*r+2]),s=qi(this._vertexMaterial,.5,o),l=qi(this._vertexOutlineMaterial,.5,o);i.push({vertexGeometry:s,vertexOutlineGeometry:l})}return i}},{key:"createGeometries",value:function(e){var t,i=this._createRenderGeometries(),n=(0,G.Z)(i);try{for(n.s();!(t=n.n()).done;){var a=t.value,r=a.vertexGeometry,o=a.vertexOutlineGeometry;e.addGeometry(r),e.addGeometry(o)}}catch(s){n.e(s)}finally{n.f()}}},{key:"createExternalResources",value:function(){this._vertexMaterial=new Ni((0,n.Z)((0,n.Z)({},this._vertexMaterialParameters),{},{writeDepth:!0,cullFace:ki.Vr.Back,screenSizeEnabled:!0})),this._vertexOutlineMaterial=new Ni((0,n.Z)((0,n.Z)({},this._vertexOutlineMaterialParameters),{},{transparent:!0,writeDepth:!0,cullFace:ki.Vr.Front,screenSizeEnabled:!0,shadingEnabled:!1}))}},{key:"destroyExternalResources",value:function(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}},{key:"forEachExternalMaterial",value:function(e){e(this._vertexMaterial),e(this._vertexOutlineMaterial)}}]),i}(Ei),Xi=(0,g.c)();function qi(e,t,i){return(0,ot.PI)(e,t,16,16,{offset:i})}var Qi=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).tracking=!1,n.displaying=!1,n.isDraped=!1,n}return(0,r.Z)(i)}(bi.Z.EventedAccessor);(0,l._)([(0,d.Cb)({constructOnly:!0})],Qi.prototype,"graphic",void 0),(0,l._)([(0,d.Cb)()],Qi.prototype,"tracking",void 0),(0,l._)([(0,d.Cb)()],Qi.prototype,"displaying",void 0),(0,l._)([(0,d.Cb)()],Qi.prototype,"isDraped",void 0),Qi=(0,l._)([(0,v.j)("esri.views.3d.layers.graphics.GraphicState")],Qi);var Ji=i(73982),Ki=i(71719),$i=i(46640),en=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._activeVertexVisualElement=null,n._createGraphicState=null,n._outlineVisualElement=null,n._verticesVisualElement=null,n._verticalLineVisualElement=null,n.geometryType=null,n.type="draw-3d",n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this.elevationInfo,t=e.mode,i=e.offset;this.internalGraphicsLayer.elevationInfo=new m.Z({mode:t,offset:i})}},{key:"normalizeCtorArgs",value:function(e){if(!e.elevationInfo){var t,i=null===(t=e.hasZ)||void 0===t||t;return(0,n.Z)((0,n.Z)({},e),{},{elevationInfo:(0,y.mF)(i)})}return e}},{key:"initializeGraphic",value:function(e){var t=this,i=this._createGraphicState=new Qi({graphic:e});return(0,c.AL)([this.view.maskOccludee(e),this.view.trackGraphicState(i),(0,h.YP)((function(){return{element:t._outlineVisualElement,isDraped:i.isDraped}}),(function(e){var t=e.element,i=e.isDraped;(0,u.yw)(t,(function(e){return e.isDraped=i}))}),h.nn)])}},{key:"makeDrawOperation",value:function(){var e=this.geometryType,t="circle"!==e&&"rectangle"!==e;return new Ki.w({view:this.view,manipulators:this.manipulators,geometryType:(0,Ji.I)(e),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new $i.iW(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new $i.aL(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new Jt,segmentLabels:t?new $:null,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions,isDraped:(0,u.pC)(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===(0,y.Zz)(this.hasZ,this.elevationInfo)})}},{key:"onActiveVertexChanged",value:function(e){var t=this,i=this.view;return(0,u.pC)(this._activeVertexVisualElement)?(this._activeVertexVisualElement.vertices=[e],this._updateVerticalLineVisualElement(e),null):(this._activeVertexVisualElement=new Yi({view:i,spatialReference:i.spatialReference,vertices:[e],elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:mi.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._activeVertexVisualElement.color=mi.colorToVec4(mi.reshapeManipulators.selected.color),this._activeVertexVisualElement.attached=!0,this._verticalLineVisualElement=new ut({view:i,extensionType:mi.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:st.yD.OccludeAndTransparent}),mi.visualElements.zVerticalLine.apply(this._verticalLineVisualElement),(0,c.kB)((function(){t._activeVertexVisualElement=(0,u.SC)(t._activeVertexVisualElement),t._verticalLineVisualElement=(0,u.SC)(t._verticalLineVisualElement)})))}},{key:"_updateVerticalLineVisualElement",value:function(e){var t=this._verticalLineVisualElement;if(!(0,u.Wi)(t)){var i=this.view,n=i.renderCoordsHelper,a=i.elevationProvider;(0,_.s)(nn,e[0],e[1],e[2]),tn.setFromElevationInfo(this.elevationInfo),nn[2]=(0,At.w7)(nn,a,tn,n),n.toRenderCoords(nn,this.view.spatialReference,nn)?(t.setStartEndFromWorldDownAtLocation(nn),t.attached=!0):t.attached=!1}}},{key:"onOutlineChanged",value:function(e){var t=this;if((0,u.pC)(this._outlineVisualElement))return this._outlineVisualElement.geometry=e,null;var i=this.internalGraphicsLayer.elevationInfo;return this._outlineVisualElement=new wi({view:this.view,geometry:e,elevationInfo:i,isDraped:(0,u.pC)(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===(0,y.Zz)(this.hasZ,i),attached:!1}),mi.visualElements.lineGraphics.outline.apply(this._outlineVisualElement),mi.visualElements.lineGraphics.shadowStyle.apply(this._outlineVisualElement),this._outlineVisualElement.attached=!0,this._outlineVisualElement.laserlineEnabled=!0,(0,c.kB)((function(){t._outlineVisualElement=(0,u.SC)(t._outlineVisualElement)}))}},{key:"onRegularVerticesChanged",value:function(e){var t=this;return(0,u.pC)(this._verticesVisualElement)?(this._verticesVisualElement.vertices=e,null):(this._verticesVisualElement=new Yi({view:this.view,spatialReference:this.view.spatialReference,vertices:e,elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:mi.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._verticesVisualElement.attached=!0,(0,c.kB)((function(){t._verticesVisualElement=(0,u.SC)(t._verticesVisualElement)})))}}]),i}(Ji.T);(0,l._)([(0,d.Cb)({constructOnly:!0})],en.prototype,"elevationInfo",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],en.prototype,"geometryType",void 0),(0,l._)([(0,d.Cb)()],en.prototype,"type",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],en.prototype,"view",void 0),en=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],en);var tn=new Tt.o,nn=(0,g.c)(),an=i(40281),rn=i(41691),on=i(47898),sn=i(37818),ln=(i(59486),i(41644)),cn=i(23879),un=i(22753),hn=i(11873),dn=i(83448),pn=i(65156),fn=i(55652),vn=i(77648);function _n(e,t,i){return function(e,t,i){var n=(0,b.Wv)((0,A.c)(kt.WM.get(),t));if(n[2]=0,!e.unprojectFromRenderScreen(n,i.origin))return null;var a=(0,b.Wv)((0,A.c)(kt.WM.get(),t));a[2]=1;var r=e.unprojectFromRenderScreen(a,kt.WM.get());return(0,u.Wi)(r)?null:((0,_.b)(i.direction,r,i.origin),i)}(e,e.screenToRender(t,(0,b.Wv)(kt.WM.get())),i)}var gn=i(86755),yn=i(99034),mn=i(585),bn=function(){function e(t){var i;for(var n in(0,a.Z)(this,e),this.metadata=void 0,this._camera=new gn.V,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,Vt.c)(),this._worldFrame=null,this._renderLocation=(0,g.c)(),this._renderLocationDirty=!0,this._location=new mn.Z({x:0,y:0,z:0}),this._elevationAlignedLocation=new mn.Z,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=yn.jg.None,this._focused=!1,this.events=new bi.Z.EventEmitter,this._screenLocation={screenPointArray:(0,b.s1)(),renderScreenPointArray:(0,b.J$)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=t.view.spatialReference,t)this[n]=t[n];var r=null===(i=this.view.state)||void 0===i?void 0:i.camera;r&&this._camera.copyFrom(r)}return(0,r.Z)(e,[{key:"destroy",value:function(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}},{key:"_stage",get:function(){var e;return null===(e=this.view)||void 0===e?void 0:e._stage}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}},{key:"renderObjects",get:function(){return this._renderObjects},set:function(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}},{key:"available",get:function(){return this._available},set:function(e){e!==this._available&&(this._available=e,this._updateEngineObject())}},{key:"disableDisplay",value:function(){var e=this;return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:(0,cn.IH)((function(){e._noDisplayCount--,0===e._noDisplayCount&&e._updateEngineObject()}))}}},{key:"radius",get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}},{key:"worldSized",get:function(){return this._worldSized},set:function(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}},{key:"modelTransform",get:function(){return this._modelTransform},set:function(e){Mn(e)&&(this._screenLocationDirty=!0),(0,It.c)(this._modelTransform,e),this._updateEngineObject()}},{key:"renderLocation",get:function(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,Vt.c)()),function(e,t,i){switch(e.viewingMode){case"local":return(0,It.i)(i),!0;case"global":var n=(0,dn.Iu)(e.renderCoordsHelper.spatialReference);(0,te.PR)(t,0,An,0,n.radius),(0,te.yH)((0,Ye.Vl)(An[0]),(0,Ye.Vl)(An[1]),i)}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation},set:function(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}},{key:"location",get:function(){return this._location},set:function(e){(0,sn.WG)(e,this._location),this._notifyLocationChanged()}},{key:"_notifyLocationChanged",value:function(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"elevationAlignedLocation",get:function(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation},set:function(e){(0,sn.WG)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"_updateElevationAlignedLocation",value:function(){var e=(0,u.pC)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,sn.D)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}},{key:"grabbableForEvent",value:function(){return!0}},{key:"grabbing",get:function(){return this._grabbing},set:function(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"hovering",get:function(){return this._hovering},set:function(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}},{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this._updateEngineObject())}},{key:"updateStateEnabled",value:function(e,t){t?this.state|=e:this.state&=~e}},{key:"_setFocused",value:function(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}},{key:"focused",get:function(){return this._focused}},{key:"screenLocation",get:function(){return this._ensureScreenLocation(),this._screenLocation}},{key:"_ensureScreenLocation",value:function(){if(this._screenLocationDirty){var e;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,Mn(this._modelTransform)){var t=this._calculateModelTransformOffset(Zn);e=(0,_.a)(t,t,this.renderLocation)}else e=this.renderLocation;this._camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}},{key:"applyObjectTransform",get:function(){return this._applyObjectTransform},set:function(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"attached",get:function(){return this._attached}},{key:"intersectionDistance",value:function(e,t){if(!this.available)return null;var i=(0,b.md)(e,Sn),n=this._getCollisionRadius(t),a=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,A.k)(this.screenLocation.screenPointArray,i)<n*n)return this.screenLocation.renderScreenPointArray[2]+a;break;case"line":var r=this.collisionType.paths,o=this._getWorldToScreenObjectScale(),s=this._calculateObjectTransform(o,En),l=n*this.screenLocation.pixelSize,c=_n(this._camera,i,xn);if((0,u.Wi)(c))return null;var h,d=(0,G.Z)(r);try{for(d.s();!(h=d.n()).done;){var p=h.value;if(0!==p.length)for(var f=(0,_.m)(An,p[0],s),v=1;v<p.length;v++){var y=(0,_.m)(Tn,p[v],s),m=(0,le.Gr)((0,le.zk)(f,y,wn),c);if(null!=m&&m<l*l){var M=(0,_.a)(kt.WM.get(),f,y);(0,_.g)(M,M,.5);var S=(0,b.So)(kt.WM.get());return this._camera.projectToRenderScreen(M,S),S[2]+a}(0,_.c)(f,y)}}}catch(ie){d.e(ie)}finally{d.f()}break;case"disc":var w,x=this.collisionType.direction,C=null!==(w=this.collisionType.offset)&&void 0!==w?w:g.Z,O=this._getWorldToScreenObjectScale(),E=this._calculateObjectTransform(O,En),k=n*this.screenLocation.pixelSize,T=_n(this._camera,i,xn);if((0,u.Wi)(T))return null;var P=(0,un.f)(Cn,E),R=(0,_.t)(Rn,x,P),D=(0,_.m)(Dn,C,E);(0,fn.Yq)(D,R,kn);var Z=Pn;if((0,fn.BR)(kn,T,Z)&&(0,_.d)(Z,D)<k*k)return this.screenLocation.renderScreenPointArray[2]+a;break;case"ribbon":var L=this.collisionType,I=L.paths,V=L.direction,z=this._getWorldToScreenObjectScale(),W=this._calculateObjectTransform(z,En),N=n*this._camera.computeScreenPixelSizeAt(this.renderLocation),j=_n(this._camera,i,xn);if((0,u.Wi)(j))return null;var F=(0,un.f)(Cn,W),H=(0,_.t)(Rn,V,F),U=this._calculateModelTransformPosition(Dn);(0,fn.Yq)(U,H,kn);var B=Pn;if(!(0,fn.BR)(kn,j,B))break;var Y,X=(0,G.Z)(I);try{for(X.s();!(Y=X.n()).done;){var q=Y.value;if(0!==q.length)for(var Q=(0,_.m)(An,q[0],W),J=1;J<q.length;J++){var K=(0,_.m)(Tn,q[J],W),$=(0,le.Jk)((0,le.zk)(Q,K,wn),B);if(null!=$&&$<N*N){var ee=(0,_.a)(kt.WM.get(),Q,K);(0,_.g)(ee,ee,.5);var te=(0,b.So)(kt.WM.get());return this._camera.projectToRenderScreen(ee,te),te[2]+a}(0,_.c)(Q,K)}}}catch(ie){X.e(ie)}finally{X.f()}break;default:(0,ln.Bg)(this.collisionType)}return null}},{key:"attach",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}},t=this._stage;if(t){var i=e.manipulator3D;if((0,u.Wi)(i.engineLayerId)){var n=new be.F({pickable:!1,updatePolicy:pe.j.SYNC});t.add(n),i.engineLayerId=n.id,this._engineLayer=n}else(null===t||void 0===t?void 0:t.getObject)&&(this._engineLayer=t.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,(0,u.Wi)(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,te.Up)(this._location.spatialReference,this.view.spatialReference)||(this.location=new mn.Z({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}}},{key:"detach",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}}).manipulator3D;e.engineLayerReferences--;var t=0===e.engineLayerReferences;t&&(e.engineLayerId=null),this._removeResourcesFromStage(t),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}},{key:"onViewChange",value:function(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"onElevationChange",value:function(e){(0,te.nF)(this.location,Gn,e.spatialReference)&&(0,pn.Qn)(e.extent,Gn)&&this._notifyLocationChanged()}},{key:"_evaluateElevationAlignment",value:function(){if(!(0,u.Wi)(this.elevationInfo)){var e=null,t=0,i=(0,u.Pt)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":e=(0,u.Pt)((0,vn.KO)(this.view.elevationProvider,this.location,"ground"),0);break;case"relative-to-ground":t=(0,u.Pt)((0,vn.KO)(this.view.elevationProvider,this.location,"ground"),0)+i;break;case"relative-to-scene":t=(0,u.Pt)((0,vn.KO)(this.view.elevationProvider,this.location,"scene"),0)+i;break;case"absolute-height":t=i}return t!==this._elevation.offset||e!==this._elevation.override?(this._elevation.offset=t,void(this._elevation.override=e)):void 0}}},{key:"_updateEngineObject",value:function(){if(this._attached)if(this.available){var e=this._getWorldToScreenObjectScale(),t=En;if(!0===this.autoScaleRenderObjects){var i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);var n,a=this._ensureEngineResources().objectsByState,r=(this.focused?yn.Q9.Focused:yn.Q9.Unfocused)|(this.selected?yn.Q9.Selected:yn.Q9.Unselected),o=this._noDisplayCount>0,s=(0,G.Z)(a);try{for(s.s();!(n=s.n()).done;){var l=n.value,c=l.stateMask,u=l.objects;if(o){var h,d=(0,G.Z)(u);try{for(d.s();!(h=d.n()).done;){h.value.visible=!1}}catch(S){d.e(S)}finally{d.f()}}else{var p=(c&yn.Q9.All)!==yn.Q9.None,f=(c&yn.jg.All)!==yn.jg.None,v=!p||(r&c)==(c&yn.Q9.All),_=!f||(this.state&c)==(c&yn.jg.All);if(v&&_){var g,y=(0,G.Z)(u);try{for(y.s();!(g=y.n()).done;){var m=g.value;m.visible=!0,m.transformation=t}}catch(S){y.e(S)}finally{y.f()}}else{var b,M=(0,G.Z)(u);try{for(M.s();!(b=M.n()).done;){b.value.visible=!1}}catch(S){M.e(S)}finally{M.f()}}}}}catch(S){s.e(S)}finally{s.f()}}else this._removeResourcesFromStage()}},{key:"_ensureEngineResources",value:function(){if((0,u.Wi)(this._engineResources)){var e=(0,u.Wg)(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((function(e){var n=e.geometry.material;i.has(n)||(t.push(n),i.add(n))}));var n=new Map;this._renderObjects.forEach((function(e){var t=new ye.T({castShadow:!1,geometries:[e.geometry]}),i=n.get(e.stateMask)||[];i.push(t),n.set(e.stateMask,i)}));var a=[];n.forEach((function(e,t){return a.push({stateMask:t,objects:e})})),this._engineResources={objectsByState:a,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}},{key:"_addResourcesToStage",value:function(){var e=this,t=this._stage;if(!this._engineResourcesAddedToStage&&!(0,u.Wi)(this._engineResources)&&t){var i=this._engineResources,n=i.objectsByState,a=i.layer;i.materials.forEach((function(i){var n=(0,u.Wg)(e._materialIdReferences),a=n.get(i.id)||0;0===a&&t.add(i),n.set(i.id,a+1)})),n.forEach((function(e){var i=e.objects;a.addMany(i),t.addMany(i)})),this._engineResourcesAddedToStage=!0}}},{key:"_removeResourcesFromStage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this._stage;if(this._engineResourcesAddedToStage&&!(0,u.Wi)(this._engineResources)&&i){var n=this._engineResources,a=n.objectsByState,r=n.layer,o=n.materials;a.forEach((function(e){var t=e.objects;r.removeMany(t),i.removeMany(t)})),o.forEach((function(t){var n=(0,u.Wg)(e._materialIdReferences),a=n.get(t.id);1===a?(i.remove(t),n.delete(t.id)):n.set(t.id,a-1)})),t&&i.remove(r),this._engineResourcesAddedToStage=!1}}},{key:"_getCollisionRadius",value:function(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}},{key:"_getFocusedSize",value:function(e,t){return e*(t?this.focusMultiplier:1)}},{key:"_getWorldToScreenObjectScale",value:function(){return this._worldSized?1:this.screenLocation.pixelSize}},{key:"_calculateModelTransformPosition",value:function(e){var t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,On);return(0,_.s)(e,i[12],i[13],i[14])}},{key:"_calculateModelTransformOffset",value:function(e){var t=this._calculateModelTransformPosition(e);return(0,_.b)(e,t,this.renderLocation)}},{key:"_calculateObjectTransform",value:function(e,t){return(0,It.s)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&(0,It.m)(t,t,this._worldFrame),(0,It.m)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,(0,u.pC)(this._applyObjectTransform)&&this._applyObjectTransform(t),t}},{key:"test",get:function(){var e=!1;if((0,u.pC)(this._engineResources))for(var t in this._engineResources.objectsByState){var i,n=this._engineResources.objectsByState[t],a=(0,G.Z)(n.objects);try{for(a.s();!(i=a.n()).done;){if(i.value.visible){e=!0;break}}}catch(r){a.e(r)}finally{a.f()}if(e)break}return{areAnyResourcesVisible:e}}}]),e}();function Mn(e){return 0!==e[12]||0!==e[13]||0!==e[14]}var Sn=(0,b.s1)(),wn=(0,le.Ue)(),xn=(0,ce.Ue)(),Cn=(0,hn.c)(),On=(0,Vt.c)(),En=(0,Vt.c)(),kn=(0,fn.Ue)(),An=(0,g.c)(),Tn=(0,g.c)(),Pn=(0,g.c)(),Rn=(0,g.c)(),Dn=(0,g.c)(),Zn=(0,g.c)(),Gn=new mn.Z({x:0,y:0,z:0,spatialReference:null}),Ln=(0,r.Z)((function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yn.Q9.None;(0,a.Z)(this,e),this.geometry=t,this.stateMask=i})),In=i(96387),Vn=i(17363),zn=i(12594),Wn=i(64642),Nn=i(11983),jn=i(50411),Fn=i(32500),Hn=(Xe.K,function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"initializeProgram",value:function(e){return new Pe.$(e.rctx,i.shader.get().build(this.configuration),qe.i)}},{key:"_setPipelineState",value:function(e,t){var i=this.configuration,n=e===Gi.A.NONE,a=e===Gi.A.FrontFace;return(0,Ze.sm)({blending:i.output!==Ti.H.Color&&i.output!==Ti.H.Alpha||!i.transparent?null:n?Un:(0,Zi.j7)(e),culling:(0,Ze.zp)(i.cullFace),depthTest:{func:(0,Zi.Bh)(e)},depthWrite:n?i.writeDepth?Ze.LZ:null:(0,Zi.K5)(e),colorWrite:Ze.BK,stencilWrite:i.hasOccludees?jn.s3:null,stencilTest:i.hasOccludees?t?jn.eD:jn.RY:null,polygonOffset:n||a?null:(0,Zi.je)(i.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(e,t){return t?this._occludeePipelineState:(0,ie.Z)((0,ne.Z)(i.prototype),"getPipelineState",this).call(this,e,t)}}]),i}(Te.A));Hn.shader=new Ae.J(Fn.I,(function(){return i.e(8957).then(i.bind(i,18957))}));var Un=(0,Ze.if)(De.zi.ONE,De.zi.ONE_MINUS_SRC_ALPHA),Bn=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).output=Ti.H.Color,e.cullFace=ki.Vr.None,e.hasSlicePlane=!1,e.transparent=!1,e.enableOffset=!0,e.writeDepth=!0,e.hasOccludees=!1,e.transparencyPassType=Gi.A.NONE,e.hasMultipassTerrain=!1,e.cullAboveGround=!1,e}return(0,r.Z)(i)}(Li.W);(0,l._)([(0,Ue.o)({count:Ti.H.COUNT})],Bn.prototype,"output",void 0),(0,l._)([(0,Ue.o)({count:ki.Vr.COUNT})],Bn.prototype,"cullFace",void 0),(0,l._)([(0,Ue.o)()],Bn.prototype,"hasSlicePlane",void 0),(0,l._)([(0,Ue.o)()],Bn.prototype,"transparent",void 0),(0,l._)([(0,Ue.o)()],Bn.prototype,"enableOffset",void 0),(0,l._)([(0,Ue.o)()],Bn.prototype,"writeDepth",void 0),(0,l._)([(0,Ue.o)()],Bn.prototype,"hasOccludees",void 0),(0,l._)([(0,Ue.o)({count:Gi.A.COUNT})],Bn.prototype,"transparencyPassType",void 0),(0,l._)([(0,Ue.o)()],Bn.prototype,"hasMultipassTerrain",void 0),(0,l._)([(0,Ue.o)()],Bn.prototype,"cullAboveGround",void 0);var Yn=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e,new qn)).supportsEdges=!0,n._configuration=new Bn,n}return(0,r.Z)(i,[{key:"getConfiguration",value:function(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<Zi.ve,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}},{key:"requiresSlot",value:function(e,t){return(t===Ti.H.Color||t===Ti.H.Alpha||t===Ti.H.Highlight)&&(e===Fe.r.DRAPED_MATERIAL||(t===Ti.H.Highlight?e===Fe.r.OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?Fe.r.TRANSPARENT_MATERIAL:Fe.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:Fe.r.OPAQUE_MATERIAL)))}},{key:"createGLMaterial",value:function(e){return new Xn(e)}},{key:"createBufferWriter",value:function(){return new zn.G(Wn.W1)}}]),i}(Nn.c),Xn=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){return(0,a.Z)(this,i),t.call(this,(0,n.Z)((0,n.Z)({},e),e.material.parameters))}return(0,r.Z)(i,[{key:"_updateParameters",value:function(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(Hn,e)}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e))}},{key:"beginSlot",value:function(e){return this._output!==Ti.H.Color&&this._output!==Ti.H.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}}]),i}(Vn.F),qn=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).transparent=!1,e.writeDepth=!0,e.hasSlicePlane=!1,e.cullFace=ki.Vr.None,e.hasOccludees=!1,e.opacity=1,e.textureId=null,e.initTextureTransparent=!0,e}return(0,r.Z)(i)}(st.Mt),Qn=i(24231);function Jn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:st.yD.OccludeAndTransparent,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(0,Ot.f)(e[0],e[1],e[2],e.length>3?e[3]:1),a=e[3]<1;return i?new Ni({color:n,transparent:a,writeDepth:!0,cullFace:ki.Vr.Back,renderOccluded:t}):new Nt.E({color:n,transparent:a,writeDepth:!0,cullFace:ki.Vr.Back,renderOccluded:t})}function Kn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:st.yD.OccludeAndTransparent,i=(0,Ot.f)(e[0],e[1],e[2],4===e.length?e[3]:1);return new Nt.E({color:i,transparent:!0,writeDepth:!0,cullFace:ki.Vr.Front,renderOccluded:t})}var $n=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1,calloutColor:(0,g.f)(1,.5,0)});function ea(e,t){var i=new bn({view:e,autoScaleRenderObjects:!1,collisionPriority:1,metadata:t.metadata});return function(e,t){var i,n,a,r,o,s,l,c,u=null!==(i=t.material)&&void 0!==i?i:new Yn({transparent:!0,writeDepth:!1,textureId:null===(n=t.texture)||void 0===n?void 0:n.id,renderOccluded:st.yD.Opaque}),h=null!==(a=t.focusMultiplier)&&void 0!==a?a:$n.focusMultiplier,d=null!==(r=t.calloutLength)&&void 0!==r?r:$n.calloutLength,p=$n.discRadius*(null!==(o=t.discScale)&&void 0!==o?o:1),f=p*h,v=function(e,t){var i=[0,1,2,2,3,0];return new Wt.Z(t,[[ke.T.POSITION,new zt.a([d-e,-e,0,d+e,-e,0,d+e,e,0,d-e,e,0],3,!0)],[ke.T.UV0,new zt.a([0,0,1,0,1,1,0,1],2,!0)]],[[ke.T.POSITION,i],[ke.T.UV0,i]])},_=$n.calloutColor,g=null!==(s=t.calloutWidth)&&void 0!==s?s:$n.calloutWidth,y=new(g>1?ct.U:Qn.Y)({width:g,color:(0,Ot.f)(_[0],_[1],_[2],null!==(l=t.calloutOpacity)&&void 0!==l?l:1),renderOccluded:st.yD.OccludeAndTransparent}),m=(0,ot.rh)(y,[[0,0,0],[d-p,0,0]]),b=(0,ot.rh)(y,[[0,0,0],[d-f,0,0]]),M=null!==(c=t.customStateMask)&&void 0!==c?c:yn.jg.None;e.collisionType={type:"disc",direction:[0,0,1],offset:[d,0,0]},e.focusMultiplier=h,e.metadata=t.metadata,e.radius=p,e.renderObjects=[new Ln(v(p,u),yn.Q9.Unfocused|M),new Ln(m,yn.Q9.Unfocused|M),new Ln(v(f,u),yn.Q9.Focused|M),new Ln(b,yn.Q9.Focused|M)]}(i,t),i}var ta=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function ia(e,t,i,n){var a=(0,_.b)(kt.WM.get(),e,i),r=na(a,(0,_.f)(kt.WM.get(),n,a),i,kt.MP.get());(0,It.a)(r,r);var o=(0,_.m)(kt.WM.get(),t,r);return Math.atan2(o[1],o[0])}function na(e,t,i,n){var a=(0,_.n)(kt.WM.get(),e),r=(0,_.n)(kt.WM.get(),t),o=(0,_.f)(kt.WM.get(),a,r);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=0,n[4]=r[0],n[5]=r[1],n[6]=r[2],n[7]=0,n[8]=o[0],n[9]=o[1],n[10]=o[2],n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n}function aa(e,t){var i=e.getViewForGraphic(t);return(0,u.pC)(i)&&"computeAttachmentOrigin"in i?i.computeAttachmentOrigin(t,e.spatialReference):null}function ra(e,t,i){var n=aa(e,i);(0,u.pC)(n)?t.elevationAlignedLocation=n:function(e,t){if((0,u.Wi)(t))return;var i="mesh"===t.type?t.anchor:(0,In.zE)(t);(0,u.Wi)(i)||(e.location=(0,sn.kB)(i))}(t,i.geometry)}var oa,sa,la=i(77498);function ca(e){return"on-the-ground"!==(arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,y.RL)(e)).mode&&!((0,u.Wi)(e.geometry)||!e.geometry.hasZ)}!function(e){e[e.NONE=0]="NONE",e[e.ANY=1]="ANY",e[e.Z=2]="Z",e[e.XY=4]="XY"}(oa||(oa={})),function(e){e[e.TRANSLATE_Z=0]="TRANSLATE_Z",e[e.TRANSLATE_XY=1]="TRANSLATE_XY",e[e.SCALE=2]="SCALE",e[e.ROTATE=3]="ROTATE",e[e.SCALE_ROTATE=4]="SCALE_ROTATE"}(sa||(sa={}));var ua=function(){function e(){(0,a.Z)(this,e),this.grabbingState=oa.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null}return(0,r.Z)(e,[{key:"update",value:function(e){var t=this;this.grabbingState=oa.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,e.forEachManipulator((function(e,i){if(i===sa.TRANSLATE_Z&&(t.zManipulator=e),e instanceof bn&&(e.selected&&(0===t.numSelected&&(t.firstSelected=e),t.numSelected++),(0,u.Wi)(t.firstGrabbedXY)&&e.grabbing&&i===sa.TRANSLATE_XY&&(t.firstGrabbedXY=e)),e.grabbing)switch(t.grabbingState|=oa.ANY,i){case sa.TRANSLATE_Z:t.grabbingState|=oa.Z;break;case sa.TRANSLATE_XY:t.grabbingState|=oa.XY}}))}}]),e}();function ha(e){var t=e.view,i=e.graphic,n=new Qi({graphic:i}),a=function(e,t){var i=e.view,n=e.graphic,a=new wi({view:i,geometry:pa(n)?n.geometry:null,elevationInfo:(0,y.RL)(n),attached:!1});mi.visualElements.lineGraphics.shadowStyle.apply(a);var r=function(){a.attached=t.displaying};mi.visualElements.lineGraphics.outline.apply(a);var o=[(0,h.YP)((function(){return t.displaying}),r),(0,h.YP)((function(){return t.isDraped}),(function(e){a.isDraped=e})),t.on("changed",(function(){return a.geometry=pa(n)?n.geometry:null})),(0,c.ed)(a)];return r(),{visualElement:a,remove:function(){return(0,c.AL)(o).remove()}}}(e,n),r=[a,da(e,a.visualElement,n),t.maskOccludee(i),t.trackGraphicState(n)];return{visualElement:a.visualElement,remove:function(){return(0,c.AL)(r).remove()}}}function da(e,t,i){var n=e.graphic,a=e.view,r=[],o=(0,y.RL)(n),s="on-the-ground"===o.mode||!o.offset&&"absolute-height"!==o.mode,l=new ua,d=new ut({view:a,extensionType:mi.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:st.yD.OccludeAndTransparent});mi.visualElements.pointGraphics.shadowStyle.apply(d);var p=(0,Ye.Vl)(mi.visualElements.heightPlaneAngleCutoff),f=new nt({view:a,attached:!1,angleCutoff:p});mi.visualElements.heightPlane.apply(f);var v=1,g=1,m=function(){if(l.update(e),!i.displaying||s&&(i.isDraped||!pa(n)||!n.geometry.hasZ))return t.laserlineEnabled=!1,d.attached=!1,void(f.attached=!1);t.laserlineEnabled=!0;var a=l.grabbingState&oa.XY?mi.visualElements.laserlineAlphaMultiplier:1;a!==v&&(v=a,mi.visualElements.lineGraphics.shadowStyle.apply(t,a),mi.visualElements.pointGraphics.shadowStyle.apply(d,a));var r=l.grabbingState&oa.Z?mi.visualElements.laserlineAlphaMultiplier:1;r!==g&&(g=r,mi.visualElements.heightPlane.apply(f,r)),function(e,t){var i=1===t.numSelected?t.firstSelected:t.numSelected>1&&(0,u.pC)(t.firstGrabbedXY)?t.firstGrabbedXY:null;(0,u.pC)(i)?(e.setStartEndFromWorldDownAtLocation(i.renderLocation),e.attached=!0):e.attached=!1}(d,l),function(e,t,i,n){if(n.numSelected>0){(0,_.s)(fa,0,0,0);var a=0;e.forEachManipulator((function(e,t){t===sa.TRANSLATE_XY&&e.selected&&e instanceof bn&&((0,_.a)(fa,fa,e.renderLocation),a++)})),a>0?(i.heightManifoldTarget=(0,_.g)(fa,fa,1/a),i.attached=!0):i.attached=!1}else{var r=t.attachmentOrigin;(0,u.pC)(r)&&e.view.renderCoordsHelper.toRenderCoords(r,fa)?(i.heightManifoldTarget=fa,i.attached=!0):i.attached=!1}}(e,t,f,l)};mi.visualElements.zVerticalLine.apply(d),r.push(i.on("changed",m),(0,h.YP)((function(){return i.displaying}),m),t.events.on("attachment-origin-changed",m),(0,c.ed)(d),(0,c.ed)(f));var b=[],M=function(){(0,c.AL)(b).remove(),b.length=0,e.forEachManipulator((function(e){return b.push(e.events.on("grab-changed",m))})),e.forEachManipulator((function(e){return b.push(e.events.on("select-changed",m))})),m()};return M(),r.push(e.onManipulatorsChanged(M),(0,c.iU)((function(){return(0,c.AL)(b)}))),(0,c.AL)(r)}function pa(e){return(0,u.pC)(e.geometry)&&("polygon"===e.geometry.type||"polyline"===e.geometry.type)}var fa=(0,g.c)();function va(e){var t=e.view,i=e.graphic,n=new Qi({graphic:i}),a=[],r=function(e,t,i){var n=e.view,a=e.graphic,r=new Dt({view:n,geometry:_a(a),elevationInfo:(0,y.RL)(a),attached:!1});return function(e,t,i,n){var a=function(){return t.attached=i.displaying};(function(e,t,i,n){var a=e.view,r=e.graphic,o=null,s=function(e){(0,u.pC)(o)&&(o.remove(),o=null),i.isDraped&&(0,u.pC)(e)&&(o=function(e,t,i){var n=e.elevationProvider.spatialReference;(0,te.KC)(t,ga,n);var a=ga[0],r=ga[1];return e.elevationProvider.on("elevation-change",(function(e){(0,pn.jE)(e.extent,a,r)&&i()}))}(a,e,(function(){t.geometry=e})))},l=function(){var e=_a(r);s(e),t.geometry=e};n.push(i.on("changed",l),(0,c.iU)((function(){return o}))),l()})(e,t,i,n),mi.visualElements.pointGraphics.outline.apply(t),n.push((0,h.YP)((function(){return i.displaying}),a,h.nn))}(e,r,t,i),i.push((0,c.ed)(r)),r}(e,n,a);return function(e,t,i,n){var a=e.view,r=e.graphic,o=new ut({view:a,extensionType:mi.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:st.yD.OccludeAndTransparent});mi.visualElements.zVerticalLine.apply(o);var s=new nt({view:a,intersectsLineInfinite:!0,attached:!1});mi.visualElements.pointGraphics.shadowStyle.apply(s);var l=(0,Ye.Vl)(mi.visualElements.heightPlaneAngleCutoff),d=new nt({view:a,attached:!1,angleCutoff:l});mi.visualElements.heightPlane.apply(d);var p=(0,y.RL)(e.graphic),f=Tt.o.fromElevationInfo(p),v="on-the-ground"===p.mode||!p.offset&&"absolute-height"!==p.mode,g=new ua,m=1,b=1,M=function(){g.update(e);var i=_a(r),l=v&&(t.isDraped||(0,u.Wi)(i)||!i.hasZ),c=!0;if(!l&&(0,u.pC)(i)){var h=(0,At.w7)(i,a.elevationProvider,f,a.renderCoordsHelper);(0,_.s)(ga,i.x,i.y,h),(0,te.SH)(ga,i.spatialReference,ga,a.renderCoordsHelper.spatialReference),o.setStartEndFromWorldDownAtLocation(ga),s.intersectsWorldUpAtLocation=ga}else c=!1;var p=g.grabbingState&oa.Z?mi.visualElements.laserlineAlphaMultiplier:1;p!==m&&(m=p,mi.visualElements.heightPlane.apply(d,p));var y=(0,Et.cS)(ya);!l&&t.displaying&&n.calculateMapBounds(y)&&(0,te.SH)((0,Et.KE)(y,ga),a.spatialReference,ga,a.renderCoordsHelper.spatialReference)?(d.heightManifoldTarget=ga,d.attached=!0):d.attached=!1;var M=g.grabbingState&oa.XY?mi.visualElements.laserlineAlphaMultiplier:1;M!==b&&(b=M,mi.visualElements.pointGraphics.shadowStyle.apply(s,M));var S=c&&t.displaying&&!l;s.attached=S,o.attached=S};i.push((0,h.YP)((function(){return[t.displaying,t.isDraped]}),M),t.on("changed",M)),e.forEachManipulator((function(e){i.push(e.events.on("grab-changed",M))})),i.push((0,c.ed)(s)),i.push((0,c.ed)(o)),i.push((0,c.ed)(d)),M()}(e,n,a,r),a.push(t.trackGraphicState(n)),{visualElement:r,remove:function(){(0,c.AL)(a).remove()}}}function _a(e){var t=e.geometry;return(0,u.Wi)(t)?null:"point"===t.type?t:"mesh"===t.type?t.anchor.clone():null}var ga=(0,g.c)(),ya=(0,Et.Ue)();function ma(e){switch((0,u.Wg)(e.graphic.geometry).type){case"point":case"mesh":return va(e);case"polygon":case"polyline":return ha(e);default:return null}}var ba,Ma=[1,.5,0],Sa=70,wa=Math.ceil(Sa/3*2),xa=160,Ca=5*Math.PI/12,Oa=1*Math.PI/3,Ea=10,ka=3,Aa=i(100),Ta=function(){function e(){(0,a.Z)(this,e),this._available=!0}return(0,r.Z)(e,[{key:"location",set:function(e){this._forEachManipulator3D((function(t){return t.location=e}))}},{key:"elevationAlignedLocation",set:function(e){this._forEachManipulator3D((function(t){return t.elevationAlignedLocation=e}))}},{key:"elevationInfo",set:function(e){this._forEachManipulator3D((function(t){return t.elevationInfo=e}))}},{key:"renderLocation",get:function(){var e;return this._forEachManipulator3D((function(t){e||(e=t.renderLocation)})),e}},{key:"available",get:function(){return this._available},set:function(e){this._available=e,this._forEachManipulator3D((function(t){return t.available=e}))}},{key:"hovering",get:function(){return this.someManipulator((function(e){return e.hovering}))}},{key:"grabbing",get:function(){return this.someManipulator((function(e){return e.grabbing}))}},{key:"dragging",get:function(){return this.someManipulator((function(e){return e.dragging}))}},{key:"hasManipulator",value:function(e){return this.someManipulator((function(t){return t===e}))}},{key:"someManipulator",value:function(e){var t=!1;return this.forEachManipulator((function(i){!t&&e(i)&&(t=!0)})),t}},{key:"_forEachManipulator3D",value:function(e){this.forEachManipulator((function(t,i){t instanceof bn&&e(t,i)}))}}]),e}(),Pa=i(40927),Ra=(i(88153),i(54463),i(76783),i(74229));function Da(e,t){return Za(e,(function(){return t}))}function Za(e,t){var i=(0,g.c)(),a=(0,g.c)(),r=!1;return function(o){var s=t(o);if("start"===o.action){var l=(0,b.md)(o.screenStart,(0,b.c$)(kt.qW.get())),c=_n(e.state.camera,l,Na);(0,u.pC)(c)&&(r=(0,fn.BR)(s,c,i))}if(!r)return null;var h=(0,b.md)(o.screenEnd,(0,b.c$)(kt.qW.get())),d=_n(e.state.camera,h,Na);return(0,u.Wi)(d)?null:(0,fn.BR)(s,d,a)?(0,n.Z)((0,n.Z)({},o),{},{renderStart:i,renderEnd:a,plane:s,ray:d}):null}}function Ga(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=null;return function(s){if("start"===s.action&&(o=e.sceneIntersectionHelper.intersectElevationFromScreen((0,b.s1)(s.screenStart.x,s.screenStart.y),t,i,r),(0,u.pC)(o)&&(0,u.pC)(a)&&!(0,te.nF)(o,o,a)))return null;if((0,u.Wi)(o))return null;var l=e.sceneIntersectionHelper.intersectElevationFromScreen((0,b.s1)(s.screenEnd.x,s.screenEnd.y),t,i,r);return(0,u.pC)(l)?(0,u.pC)(a)&&!(0,te.nF)(l,l,a)?null:(0,n.Z)((0,n.Z)({},s),{},{mapStart:o,mapEnd:l}):null}}(e,i,(0,y.Ou)(t,e,i),a,r)}function La(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return Ga(e,i,(0,y.RL)(t),n,a)}function Ia(e,t,i){var n=null,a=new Ra.hM;return a.next(Da(e,function(e,t){var i=za,n=Wa,a=(0,fn.Ue)();e.renderCoordsHelper.worldUpAtPosition(t,i);var r=(0,_.f)(a,i,(0,_.b)(n,t,e.state.camera.eye));return(0,_.f)(r,r,i),(0,fn.Yq)(t,r,a)}(e,t))).next(function(e,t){var i=(0,g.c)(),n=(0,_.l)(t);e.renderCoordsHelper.worldUpAtPosition(t,i);var a=(0,g.c)(),r=(0,g.c)(),o=function(a){return(0,_.b)(a,a,t),(0,Pa.nF)(i,a,a),"global"===e.viewingMode&&(0,_.l)(a)*Math.sign((0,_.e)(i,a))<.001-n&&(0,_.b)(a,(0,_.g)(a,i,.001),t),(0,_.a)(a,a,t),a};return function(e){return e.renderStart=o((0,_.c)(a,e.renderStart)),e.renderEnd=o((0,_.c)(r,e.renderEnd)),e}}(e,t)).next(Va(e,i)).next((function(e){e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,n=e})),function(e){return n=null,a.execute(e),n}}function Va(e,t){var i=e.renderCoordsHelper;return function(e){var a=i.fromRenderCoords(e.renderStart,t),r=i.fromRenderCoords(e.renderEnd,t);return(0,u.pC)(a)&&(0,u.pC)(r)?(0,n.Z)((0,n.Z)({},e),{},{mapStart:a,mapEnd:r}):null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(ba||(ba={}));var za=(0,g.c)(),Wa=(0,g.c)(),Na=(0,ce.Ue)();function ja(e,t,i,n){var a=e.graphic,r=function(e,i){return t({action:e,graphic:a,dxScreen:i.screenDeltaX,dyScreen:i.screenDeltaY})};return i((function(e,t,i){return t.next((function(e){return"start"===e.action&&r("start",e),e})).next((0,Ra.a9)(a,n)).next((function(e){switch(e.action){case"start":case"update":(e.translationX||e.translationY||e.translationZ)&&r("update",e);break;case"end":r("end",e)}return e})),{steps:t,cancel:i=i.next((0,Ra.bD)(a)).next((function(e){return r("end",{screenDeltaX:0,screenDeltaY:0}),e}))}}))}function Fa(e){if((0,u.Wi)(e)||"polyline"!==e.type&&"polygon"!==e.type)return 0;var t=("polyline"===e.type?e.paths:e.rings)[0];if(!t||t.length<2)return 0;var i=t[0],n=t[1];return Math.atan2(n[1]-i[1],n[0]-i[0])}function Ha(e){if((0,u.Wi)(e)||(0,u.Wi)(e.axis))return 1;var t=e.mapStart,i=e.mapEnd,n=e.axis,a=[i.x-t.x,i.y-t.y];return a[0]*n[0]+a[1]*n[1]>0?1:-1}var Ua,Ba=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this))._handles=new Aa.Z,n._arrowManipulatorInfos=new Array,n._opaqueMaterial=n._createMaterial(),n._transparentMaterial=n._createMaterial(.5),n._angle=0,n._scale=1,n._radius=Sa,n._updateAfterDrag=!1,n.events=new bi.Z,n._tool=e.tool,n._view=e.view,null!=e.radius&&(n._radius=e.radius),n._createManipulators(),n.forEachManipulator((function(e){return n._tool.manipulators.add(e)})),n}return(0,r.Z)(i,[{key:"orthogonalAvailable",set:function(e){this._arrowManipulatorInfos[1].manipulator.available=e,this._arrowManipulatorInfos[3].manipulator.available=e}},{key:"destroy",value:function(){var e=this;this._handles=(0,u.SC)(this._handles),this.forEachManipulator((function(t){e._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0}},{key:"forEachManipulator",value:function(e){var t,i=(0,G.Z)(this._arrowManipulatorInfos);try{for(i.s();!(t=i.n()).done;){e(t.value.manipulator,sa.TRANSLATE_XY)}}catch(n){i.e(n)}finally{i.f()}}},{key:"createGraphicDragPipeline",value:function(e,t,i){var n=this,a=t.graphic,r=(0,y.RL)(a),o=(0,u.Wg)(a.geometry).spatialReference;return ja(t,i,(function(t){return n.createDragPipeline((function(i,n,a,r,o){var s;return n=(s=e(i,n,a,r,o)).steps,a=s.cancel,t(i,n,a)}),r,o,a)}),this._view.state.viewingMode)}},{key:"createDragPipeline",value:function(e,t,i,a){var r=this;return(0,c.AL)(this._arrowManipulatorInfos.map((function(o,s){var l=o.manipulator;return(0,Ra.Xd)(l,(function(o,l,c,u,h){var d=l.next((function(e){return(0,n.Z)((0,n.Z)({},e),{},{manipulatorType:sa.TRANSLATE_XY})})).next((0,Ra.kY)(r._view,o.elevationAlignedLocation)).next(Ga(r._view,o.elevationAlignedLocation,t,i,a)).next((0,Ra.M2)(o.location,r.angle+(s+1)*Math.PI*.5)).next((0,Ra.zh)());e(o,d,c,u,h)}))})))}},{key:"angle",get:function(){return this._angle},set:function(e){this._angle=e,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}},{key:"displayScale",get:function(){return this._scale},set:function(e){this._scale=e,this._updateManipulatorTransform()}},{key:"radius",get:function(){return this._radius},set:function(e){this._radius!==e&&(this._radius=e,this._updateManipulators())}},{key:"_updateManipulators",value:function(){for(var e=0;e<this._arrowManipulatorInfos.length;e++)this._updateArrowManipulator(this._arrowManipulatorInfos[e],e);this._updateManipulatorTransform()}},{key:"_updateArrowManipulator",value:function(e,t){var i=e.manipulator,n=e.transform,a=this._radius/Sa,r=54*a,o=r*Math.sqrt(3)/2,s=(0,ot.DA)(this._opaqueMaterial,o,r/2,r/2,.02);(0,ot.mx)(s,(0,It.f)(kt.MP.get(),(0,_.s)(kt.WM.get(),0,-o/3,0))),i.renderObjects=[new Ln(s,yn.Q9.Focused),new Ln(s.instantiate({material:this._transparentMaterial}),yn.Q9.Unfocused)],i.radius=o/3*2*1.2;var l=(0,It.b)(kt.MP.get(),t*Math.PI/2),c=(0,It.f)(kt.MP.get(),(0,_.s)(kt.WM.get(),0,100*a,0));(0,It.m)(n,l,c)}},{key:"_createManipulators",value:function(){for(var e=0;e<4;e++){var t=this._createArrowManipulator(e);this._arrowManipulatorInfos.push(t)}this._updateManipulatorTransform()}},{key:"_updateManipulatorTransform",value:function(){var e=this.angle,t=(0,It.d)(kt.MP.get(),e,(0,g.f)(0,0,1));if(!(0,u.Wi)(t)){var i,n=(0,It.E)(kt.MP.get(),(0,_.s)(kt.WM.get(),this.displayScale,this.displayScale,this.displayScale)),a=(0,It.m)(kt.MP.get(),n,t),r=(0,G.Z)(this._arrowManipulatorInfos);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=(0,It.m)(kt.MP.get(),a,o.transform);o.manipulator.modelTransform=s}}catch(l){r.e(l)}finally{r.f()}}}},{key:"_createArrowManipulator",value:function(e){var t=this,i=new bn({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,g.f)(0,0,1)}}),n={manipulator:i,transform:(0,Vt.c)()};return this._updateArrowManipulator(n,e),this._handles.add(i.events.on("drag",(function(e){t._updateAfterDrag&&"end"===e.action&&!t.dragging&&(t._updateManipulatorTransform(),t._updateAfterDrag=!1)}))),n}},{key:"_createMaterial",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=L.Z.toUnitRGBA(ii.main);return t[3]*=e,new Nt.E({color:t,transparent:1!==e,cullFace:ki.Vr.Back,renderOccluded:st.yD.Transparent})}},{key:"test",get:function(){return{arrowManipulators:this._arrowManipulatorInfos.map((function(e){return e.manipulator}))}}}]),i}(Ta),Ya=function(){function e(){(0,a.Z)(this,e),this._view=null,this._elevationInfo=null,this._lastDragEvent=null,this._next=null,this._enabled=!1}return(0,r.Z)(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){if(this._enabled!==e&&(0,u.pC)(this._lastDragEvent)&&(0,u.pC)(this._next)){var t=this._lastDragEvent.mapEnd,i=this._snap(this._lastDragEvent.screenEnd);if((0,u.pC)(i)){var n={action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===e?i:t,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd};this._next.execute(n)}}this._enabled=e}},{key:"_snap",value:function(e){var t=(0,u.pC)(this._view)?this._view.toMap(e,{exclude:[]}):null;return(0,u.pC)(t)&&(0,u.pC)(this._view)&&(t.z=(0,y.Ou)(t,this._view,this._elevationInfo)),t}},{key:"createDragEventPipelineStep",value:function(e,t){var i=this;this._view=e,this._elevationInfo=t,this._lastDragEvent=null;var a=new Ra.hM;return this._next=a,[function(e){if(i._lastDragEvent="end"!==e.action?(0,n.Z)({},e):null,i._enabled){var t=i._snap(e.screenEnd);return(0,u.pC)(t)?{action:e.action,mapStart:e.mapStart,mapEnd:t,screenStart:e.screenStart,screenEnd:e.screenEnd}:null}return{action:e.action,mapStart:e.mapStart,mapEnd:e.mapEnd,screenStart:e.screenStart,screenEnd:e.screenEnd}},a]}}]),e}(),Xa=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this))._snapToScene=new Ya,n._discMaterial=n._createMaterial(),n._discMaterialTransparent=n._createMaterial(.5),n._scale=1,n._radius=Sa,n._view=e.view,n._tool=e.tool,null!=e.snapToScene&&(n.snapToScene=e.snapToScene),null!=e.radius&&(n._radius=e.radius),n._createManipulator(),n.forEachManipulator((function(e){return n._tool.manipulators.add(e)})),n}return(0,r.Z)(i,[{key:"destroy",value:function(){var e=this;this.forEachManipulator((function(t){e._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}},{key:"forEachManipulator",value:function(e){e(this._manipulator,sa.TRANSLATE_XY)}},{key:"displayScale",get:function(){return this._scale},set:function(e){this._scale=e,this._updateManipulatorTransform()}},{key:"snapToScene",get:function(){return this._snapToScene.enabled},set:function(e){this._snapToScene.enabled=e}},{key:"radius",get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateManipulator())}},{key:"createGraphicDragPipeline",value:function(e,t,i){var n=this,a=t.graphic,r=(0,y.RL)(a),o=(0,u.Wg)(a.geometry).spatialReference;return ja(t,i,(function(t){return n.createDragPipeline((function(i,n,a,r,o){var s;return n=(s=e(i,n,a,r,o)).steps,a=s.cancel,t(i,n,a)}),r,o,a)}),this._view.state.viewingMode)}},{key:"createDragPipeline",value:function(e,t,i,a){var r=this,o=this._view;return(0,Ra.Xd)(this._manipulator,(function(s,l,c,u,h){var d,p=(d=l.next((0,Ra.kY)(o,s.elevationAlignedLocation)).next(Ga(o,s.elevationAlignedLocation,t,i,a))).next.apply(d,(0,S.Z)(r._snapToScene.createDragEventPipelineStep(o,t))).next((function(e){return(0,n.Z)((0,n.Z)({},e),{},{manipulatorType:sa.TRANSLATE_XY})})).next((0,Ra.zh)());e(s,p,c,u,h)}))}},{key:"_updateManipulatorTransform",value:function(){var e=(0,It.E)(kt.MP.get(),(0,_.s)(kt.WM.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=e}},{key:"_createManipulator",value:function(){var e=this._view;this._manipulator=new bn({view:e,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,g.f)(0,0,1)},worldOriented:!0}),this._updateManipulator()}},{key:"_updateManipulator",value:function(){var e=(0,ot.nb)(this._discMaterial,.02,1,128,(0,g.f)(0,0,1),(0,g.f)(0,0,0));e.transformation=(0,It.E)((0,Vt.c)(),(0,g.f)(this._radius,this._radius,this._radius)),this._manipulator.renderObjects=[new Ln(e,yn.Q9.Focused),new Ln(e.instantiate({material:this._discMaterialTransparent}),yn.Q9.Unfocused)],this._manipulator.radius=this._radius/Sa*80}},{key:"_createMaterial",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=L.Z.toUnitRGBA(ii.main);return t[3]*=e,new Nt.E({color:t,transparent:1!==e,cullFace:ki.Vr.Back,renderOccluded:st.yD.Transparent})}},{key:"test",get:function(){return{discManipulator:this._manipulator}}}]),i}(Ta),qa=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this))._radius=Sa,n.events=new bi.Z,n._tool=e.tool,n._view=e.view,null!=e.radius&&(n._radius=e.radius),n._createManipulator(),n.forEachManipulator((function(e){return n._tool.manipulators.add(e)})),n}return(0,r.Z)(i,[{key:"destroy",value:function(){var e=this;this.forEachManipulator((function(t){e._tool.manipulators.remove(t),t.destroy()}))}},{key:"forEachManipulator",value:function(e){e(this._manipulator,sa.TRANSLATE_Z)}},{key:"createGraphicDragPipeline",value:function(e,t,i){var n=this,a=(0,u.Wg)(t.graphic.geometry).spatialReference;return ja(t,i,(function(t){return n.createDragPipeline((function(i,n,a,r,o){var s;return n=(s=e(i,n,a,r,o)).steps,a=s.cancel,t(i,n,a)}),a)}),this._view.state.viewingMode)}},{key:"createDragPipeline",value:function(e,t){var i=this._view;return(0,Ra.Xd)(this._manipulator,(function(a,r,o,s,l){var c=r.next((function(e){return(0,n.Z)((0,n.Z)({},e),{},{manipulatorType:sa.TRANSLATE_Z})})).next(Ia(i,a.renderLocation,t)).next((0,Ra.zh)());e(a,c,o,s,l)}))}},{key:"radius",get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateManipulator())}},{key:"_updateManipulator",value:function(){var e=this._radius/Sa,t=mi.zManipulator.height*e,i=mi.zManipulator.coneHeight*e,n=mi.zManipulator.coneWidth*e,a=mi.zManipulator.width*e,r=[(0,g.f)(0,0,0),(0,g.f)(0,0,t)],o=[(0,g.f)(0,0,0),(0,g.f)(0,0,t+i)],s=function(e){var i=(0,Vt.c)();if((0,It.w)(i,i,[0,0,t]),(0,It.r)(i,i,Math.PI/2),e){var a=1+2*e/n;(0,It.k)(i,i,[a,a,a])}return i}(0),l=function(e,t){var i=(0,ei._j)(mi.zManipulator.color,t);return[i.r/255,i.g/255,i.b/255,mi.zManipulator.color.a*e]},c=Jn(l(1,.25),st.yD.Occlude),u=Jn(l(1,0),st.yD.Occlude),h=Jn(l(.7,0),mi.zManipulator.renderOccluded),d=Jn(l(.85,0),mi.zManipulator.renderOccluded),p=(0,ot.PD)(c,r,a/2,16,!1),f=(0,ot.QL)(c,i,n/2,16,!1);f.transformation=s,this._manipulator.renderObjects=[new Ln(f,yn.Q9.Unfocused),new Ln(p,yn.Q9.Unfocused),new Ln(f.instantiate({material:u}),yn.Q9.Focused),new Ln(p.instantiate({material:u}),yn.Q9.Focused),new Ln(f.instantiate({material:h}),yn.Q9.Unfocused),new Ln(p.instantiate({material:h}),yn.Q9.Unfocused),new Ln(f.instantiate({material:d}),yn.Q9.Focused),new Ln(p.instantiate({material:d}),yn.Q9.Focused)],this._manipulator.radius=a/2+2,this._manipulator.collisionType={type:"line",paths:[o]}}},{key:"_createManipulator",value:function(){var e=this,t=new bn({view:this._view,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});t.applyObjectTransform=function(t){var i=e._view.state.camera,n=Qa;e._view.renderCoordsHelper.toRenderCoords(e._manipulator.elevationAlignedLocation,n);var a=(0,_.j)(i.eye,n),r=i.computeRenderPixelSizeAtDist(a),o=(0,_.b)(Ja,n,i.eye);(0,_.n)(o,o);var s=Ka;e._view.renderCoordsHelper.worldUpAtPosition(Qa,s);var l=Math.abs((0,_.e)(o,s)),c=(0,_.f)(Ja,o,s),u=(0,_.f)(Ja,c,s),h=(0,Ye.uZ)(l,.01,1),d=1-Math.sqrt(1-h*h)/h/i.fullWidth,p=e._radius/Sa,f=mi.zManipulator.width*p;(0,_.g)(u,(0,_.n)(u,u),(1/d-1)*a+r*f),t[12]-=Ja[0],t[13]-=Ja[1],t[14]-=Ja[2]},this._manipulator=t,this._updateManipulator()}},{key:"test",get:function(){return{manipulator:this._manipulator}}}]),i}(Ta),Qa=(0,g.c)(),Ja=(0,g.c)(),Ka=(0,g.c)(),$a=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;(0,a.Z)(this,i),(n=t.call(this))._handles=new Aa.Z,n._interactive=!0;var r=e.tool,o=e.view,s=e.snapToScene,l=e.radius;return n._view=o,n.xyManipulation=new Xa({tool:r,view:o,snapToScene:s,radius:l}),n.xyAxisManipulation=new Ba({tool:r,view:o,radius:l}),n.zManipulation=new qa({tool:r,view:o,radius:l}),n.xyManipulation.available=e.xyAvailable,n.xyAxisManipulation.available=e.xyAxisAvailable,n.zManipulation.available=e.zAvailable,n._autoHideXYAxis(),n.forEachManipulator((function(e){return n._handles.add(e.events.on("grab-changed",(function(){return n._updateManipulatorInteractivity()})))})),n}return(0,r.Z)(i,[{key:"destroy",value:function(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()}},{key:"createGraphicDragPipeline",value:function(e,t,i){return(0,c.AL)([this.xyManipulation.createGraphicDragPipeline((function(t,i,n,a,r){return e(Ua.XY,t,i,n,a,r)}),t,i),this.xyAxisManipulation.createGraphicDragPipeline((function(t,i,n,a,r){return e(Ua.XY_AXIS,t,i,n,a,r)}),t,i),this.zManipulation.createGraphicDragPipeline((function(t,i,n,a,r){return e(Ua.Z,t,i,n,a,r)}),t,i)])}},{key:"createDragPipeline",value:function(e,t,i,n){return(0,c.AL)([this.xyManipulation.createDragPipeline((function(t,i,n,a,r){return e(Ua.XY,t,i,n,a,r)}),t,i,n),this.xyAxisManipulation.createDragPipeline((function(t,i,n,a,r){return e(Ua.XY_AXIS,t,i,n,a,r)}),t,i,n),this.zManipulation.createDragPipeline((function(t,i,n,a,r){return e(Ua.Z,t,i,n,a,r)}),i)])}},{key:"snapToScene",set:function(e){this.xyManipulation.snapToScene=e}},{key:"angle",set:function(e){this.xyAxisManipulation.angle=e}},{key:"interactive",set:function(e){this._interactive!==e&&(this._interactive=e,this._updateManipulatorInteractivity())}},{key:"radius",set:function(e){this.xyAxisManipulation.radius=e,this.xyManipulation.radius=e,this.zManipulation.radius=e}},{key:"displayScale",set:function(e){this.xyManipulation.displayScale=e,this.xyAxisManipulation.displayScale=e}},{key:"forEachManipulator",value:function(e){this.xyManipulation.forEachManipulator((function(t){return e(t,sa.TRANSLATE_XY)})),this.xyAxisManipulation.forEachManipulator((function(t){return e(t,sa.TRANSLATE_XY)})),this.zManipulation.forEachManipulator((function(t){return e(t,sa.TRANSLATE_Z)}))}},{key:"_xyAxisVisible",get:function(){var e=this.xyManipulation.someManipulator((function(e){return e.focused}))||this.xyAxisManipulation.someManipulator((function(e){return e.focused}));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||e}},{key:"_autoHideXYAxis",value:function(){var e=this,t=this.xyAxisManipulation,i=this.xyManipulation;if(!(0,M.Z)("esri-mobile")){var n=[];i.forEachManipulator((function(e){return n.push(e)})),t.forEachManipulator((function(e){return n.push(e)}));for(var a=function(){var i=[];e._xyAxisVisible||t.forEachManipulator((function(e){return i.push(e.disableDisplay())})),e._handles.remove(er),e._handles.add(i,er)},r=0,o=n;r<o.length;r++){var s=o[r];this._handles.add(s.events.on("focus-changed",a))}this._view.inputManager&&this._handles.add((0,h.gx)((function(){var t;return null===(t=e._view.inputManager)||void 0===t?void 0:t.latestPointerType}),a)),a()}}},{key:"_updateManipulatorInteractivity",value:function(){var e=this,t=this.grabbing;this.forEachManipulator((function(i){i.interactive=!t&&e._interactive||i.grabbing}))}}],[{key:"radiusForSymbol",value:function(e){var t=(0,u.pC)(e)&&"point-3d"===e.type&&e.symbolLayers;return t&&t.length>0&&t.some((function(e){return"icon"===e.type}))?wa:Sa}}]),i}(Ta),er="disable-xy-axis-display";!function(e){e[e.XY=0]="XY",e[e.XY_AXIS=1]="XY_AXIS",e[e.Z=2]="Z"}(Ua||(Ua={}));var tr=i(2346),ir=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this))._view=e.view,n._tool=e.tool,n._graphicState=e.graphicState,n._createManipulator(),n.forEachManipulator((function(e){return n._tool.manipulators.add(e)})),n}return(0,r.Z)(i,[{key:"destroy",value:function(){var e=this;this.forEachManipulator((function(t){e._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphicState=null}},{key:"forEachManipulator",value:function(e){e(this._manipulator,sa.TRANSLATE_XY)}},{key:"createGraphicDragPipeline",value:function(e){var t=this;return ja(this._graphicState,e,(function(e){return t.createDragPipeline(e)}),this._view.state.viewingMode)}},{key:"createDragPipeline",value:function(e){var t=this._view,i=this._graphicState.graphic,n=(0,u.pC)(i.geometry)?i.geometry.spatialReference:null;return(0,Ra.Xd)(this._manipulator,(function(a,r,o,s,l){var c=r.next(function(e,t,i,n){var a=t.toMap(e.screenStart,{include:[i]});return(0,u.pC)(a)?La(t,i,a,n):null}(l,t,i,n)).next((0,Ra.AN)()).next((0,Ra.zh)());e(a,c,o,s,l)}))}},{key:"_createManipulator",value:function(){var e=this._view,t=this._graphicState.graphic;this._manipulator=new tr.L({graphic:t,view:e,selectable:!0,cursor:"move"})}}]),i}(Ta),nr=i(57889),ar=i(29919),rr=i(87268),or=i(77560),sr=i(34019),lr=i(80151),cr=i(12494),ur=i(40524),hr=i(4914),dr=(0,r.Z)((function e(t){(0,a.Z)(this,e),this.allGraphics=t,this.type="graphic-move-start"})),pr=(0,r.Z)((function e(t,i,n){(0,a.Z)(this,e),this.dx=t,this.dy=i,this.allGraphics=n,this.type="graphic-move"})),fr=(0,r.Z)((function e(t){(0,a.Z)(this,e),this.allGraphics=t,this.type="graphic-move-stop"})),vr=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).graphics=new an.Z,n.enableZ=!0,n.tooltipOptions=new or.Z,n.type="move-3d",n._tooltip=null,n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this,t=this.graphics,i=this.view;this.addHandles([t.on("change",(function(){return e._refreshManipulators()})),(0,h.YP)((function(){return e.tooltipOptions.enabled}),(function(t){e._tooltip=t?new cr.u({view:i}):(0,u.SC)(e._tooltip)}),h.tX)]),this._refreshManipulators(),this.finishToolCreation()}},{key:"destroy",value:function(){this._tooltip=(0,u.SC)(this._tooltip),this._moveManipulation=(0,u.SC)(this._moveManipulation),this.graphics.removeAll(),this._set("view",null)}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"reset",value:function(){}},{key:"_refreshManipulators",value:function(){var e,t=this;this.handles.removeAll(),null!==(e=this._moveManipulation)&&void 0!==e&&e.destroy(),this.manipulators.removeAll();var i=this.graphics.toArray().filter((function(e){return(0,nr.P)(e)===la.e.SUPPORTED})).map((function(e){return new _r(e)}));i.length&&(this._createManipulators(i),this._createVisualElements(i),this.handles.add(i.map((function(e){return t.view.trackGraphicState(e.state)}))),this._updateMoveManipulation(i))}},{key:"_createManipulators",value:function(e){var t,i=this,a=(0,G.Z)(e);try{var r=function(){var a=t.value,r=a.state;a.manipulationXY=new ir({tool:i,view:i.view,graphicState:r}),a.manipulationXY.forEachManipulator((function(e){return i.handles.add([e.events.on("immediate-click",(function(e){i.emit("immediate-click",(0,n.Z)((0,n.Z)({},e),{},{graphic:r.graphic})),e.stopPropagation()})),e.events.on("grab-changed",(function(e){var t=e.action,n=i.tooltipOptions,a=i._tooltip;(0,u.Wi)(a)||("start"===t?a.info=new ur.$E({tooltipOptions:n}):a.clear())}))])})),i.handles.add(a.manipulationXY.createDragPipeline((function(t,n,a,r){return i._buildDragEventPipeline(e,Ua.XY,t,n,a,r)})))};for(a.s();!(t=a.n()).done;)r()}catch(o){a.e(o)}finally{a.f()}this._createMoveManipulation(e)}},{key:"_createMoveManipulation",value:function(e){var t=this,i=new $a({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===e.length?$a.radiusForSymbol(e[0].graphic.symbol):Sa});this._moveManipulation=i,i.elevationInfo={mode:"absolute-height",offset:0},i.forEachManipulator((function(e){t.handles.add(e.events.on("immediate-click",(function(a){i.zManipulation.hasManipulator(e)||1!==t.graphics.length||t.emit("immediate-click",(0,n.Z)((0,n.Z)({},a),{},{graphic:t.graphics.getItemAt(0)})),a.stopPropagation()})))}));var a=function(i){return function(n){t.handles.add(n.events.on("focus-changed",(function(n){var a=n.action,r=t._tooltip;(0,u.Wi)(r)||("focus"===a?t._updateMoveTooltip(e,i):r.clear())})))}};this._moveManipulation.xyManipulation.forEachManipulator(a(Ua.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(a(Ua.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(a(Ua.Z));var r,o=function(){return t._updateMoveManipulation(e)},s=(0,G.Z)(e);try{var l=function(){var e=r.value;t.handles.add([e.state.on("changed",o),(0,h.YP)((function(){return e.state.displaying}),o)])};for(s.s();!(r=s.n()).done;)l()}catch(d){s.e(d)}finally{s.f()}var c=e[e.length-1];this.handles.add(c.state.on("changed",(function(){return t._updateMoveManipulationAngle(c)}))),this.handles.add(i.createDragPipeline((function(i,n,a,r,o){return t._buildDragEventPipeline(e,i,n,a,r,o)}),(0,y.RL)(c.graphic),(0,u.Wg)(c.graphic.geometry).spatialReference,c.graphic)),this._updateMoveManipulationAngle(c)}},{key:"_createVisualElements",value:function(e){var t,i=this,n=(0,G.Z)(e);try{var a=function(){var n=t.value,a=n.graphic,r=ma({view:i.view,graphic:a,forEachManipulator:function(e){var t;null!==(t=n.manipulationXY)&&void 0!==t&&t.forEachManipulator(e),i._moveManipulation.forEachManipulator(e)},onManipulatorsChanged:function(){return(0,c.kB)()}});(0,u.Wi)(r)||(n.geometryRepresentation=r.visualElement,n.geometryRepresentation instanceof wi&&i.handles.add([n.geometryRepresentation.events.on("attachment-origin-changed",(function(){n.state.isDraped||i._updateMoveManipulation(e)})),(0,h.YP)((function(){return n.state.isDraped}),(function(){return i._updateMoveManipulation(e)}))]),i.handles.add(r))};for(n.s();!(t=n.n()).done;)a()}catch(r){n.e(r)}finally{n.f()}}},{key:"_updateMoveManipulationAngle",value:function(e){this._moveManipulation.angle=Fa(e.graphic.geometry)}},{key:"_updateMoveManipulation",value:function(e){var t,i,n=(0,gt.Tx)(0,0,0,this.view.spatialReference),a=0,r=!1,o=this._moveManipulation,s=(0,G.Z)(e);try{for(s.s();!(i=s.n()).done;){var l=i.value;if(l.state.displaying){var c=l.state.graphic;this.enableZ&&ca(c)&&(r=!0);var h=l.geometryRepresentation instanceof wi&&!l.state.isDraped?l.geometryRepresentation.attachmentOrigin:aa(this.view,c);if((0,u.pC)(h)){var d,p=h.x,f=h.y,v=h.z;n.x+=p,n.y+=f,v&&(null!==(d=n.z)&&void 0!==d||(n.z=0),n.z+=v),a++}}}}catch(_){s.e(_)}finally{s.f()}a>0?(n.x/=a,n.y/=a,null!==(t=n.z)&&void 0!==t||(n.z=0),n.z/=a,o.location=n,o.xyManipulation.available=!0,o.xyAxisManipulation.available=!0,o.zManipulation.available=r):o.available=!1}},{key:"_buildDragEventPipeline",value:function(e,t,i,n,a,r){var o=this,s=[],l=[],c=null,u=null,h=function(){for(var e=0,t=s;e<t.length;e++){t[e].dragging=!1}s.length=0,l.length=0,c=null,u=null,o._moveManipulation.interactive=!0};if(1===e.length&&t===Ua.XY){var d=e[0].graphic,p=this._buildSnappingPipelineSteps(d,(0,y.RL)(d),n,a,r);n=p.steps,a=p.cancel}return a=a.next((function(e){var t;return null===(t=u)||void 0===t?void 0:t(e)})).next((function(){return o.emit("graphic-move-stop",new fr(l)),o.destroyed||h(),null})),{steps:n=n.next((function(t){if("start"===t.action){s.length=0,l.length=0;var n,a=(0,G.Z)(e);try{for(a.s();!(n=a.n()).done;){var r,h,d=n.value;d.dragging||(null===(r=d.manipulationXY)||void 0===r||!r.hasManipulator(i))&&(null===(h=d.manipulationXY)||void 0===h?void 0:h.grabbing)||(s.push(d),l.push(d.graphic),d.dragging=!0)}}catch(p){a.e(p)}finally{a.f()}if(0!==l.length&&(o._moveManipulation.interactive=!1,c=(0,Ra.oq)(l,o.view.state.viewingMode),u=(0,Ra.QY)(l),o.emit("graphic-move-start",new dr(l)),o.destroyed))return null}return 0!==l.length?t:null})).next((function(e){var t;return null===(t=c)||void 0===t?void 0:t(e)})).next((function(i){return o._updateMoveTooltip(e,t,i),i})).next((function(e){switch(e.action){case"start":case"update":if(e.translationX||e.translationY||e.translationZ){var t=o.view.toScreen(e.mapStart),i=o.view.toScreen(e.mapEnd),n=i.x-t.x,a=i.y-t.y;if(o.emit("graphic-move",new pr(n,a,l)),o.destroyed)return null}break;case"end":if(o.emit("graphic-move-stop",new fr(l)),o.destroyed)return null;h()}return null})),cancel:a}}},{key:"_updateMoveTooltip",value:function(e,t,i){var n=this.tooltipOptions,a=this._tooltip;if(!(0,u.Wi)(a)){a.clear();var r=0===e.length?"absolute-height":e[0].state.isDraped?"on-the-ground":"absolute-height";switch(t){case Ua.XY:a.info=new ur.$E({tooltipOptions:n}),this._updateMoveTooltipDistance(a.info,i,(function(e,t){return(0,U.GQ)(e,t,r)}));break;case Ua.XY_AXIS:a.info=new ur.in({tooltipOptions:n}),this._updateMoveTooltipDistance(a.info,i,(function(e,t){var n=(0,U.GQ)(e,t,r);return(0,on.bA)(n,Ha(i))}));break;case Ua.Z:a.info=new ur.QW({tooltipOptions:n}),this._updateMoveTooltipDistance(a.info,i,hr._e)}}}},{key:"_updateMoveTooltipDistance",value:function(e,t,i){if((0,u.pC)(t)&&"end"!==t.action){var n=i(t.mapStart,t.mapEnd);e.distance=(0,u.pC)(n)?n:on.yP}}},{key:"_buildSnappingPipelineSteps",value:function(e,t,i,a,r){var o,s=this,l=e.geometry;if((0,u.Wi)(l)||"point"!==l.type&&"mesh"!==l.type)return{steps:i,cancel:a};var c=("point"===l.type?l:l.anchor).clone(),h=new sr.N({elevationInfo:t,pointer:r,editGeometryOperations:rr.c.fromGeometry(c,this.view.state.viewingMode),visualizer:new Jt,excludeFeature:e}),d=this.snappingManager,p=(0,lr.W)({snappingContext:h,snappingManager:d,updatingHandles:this.updatingHandles}),f=p.snappingStep,v=p.cancelSnapping;return a=a.next(v),{steps:i=(o=i.next((function(t){return c.z=(0,y.vQ)(s.view,c,(0,y.RL)(e),{mode:"absolute-height",offset:0}),(0,n.Z)((0,n.Z)({},t),{},{snapOrigin:h.coordinateHelper.pointToVector(c)})}))).next.apply(o,(0,S.Z)(f)),cancel:a}}},{key:"test",get:function(){return{tooltip:this._tooltip}}}]),i}((0,rn.p)(bi.Z.EventedMixin(ar.m)));(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],vr.prototype,"view",void 0),(0,l._)([(0,d.Cb)()],vr.prototype,"graphics",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],vr.prototype,"enableZ",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,type:or.Z})],vr.prototype,"tooltipOptions",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],vr.prototype,"snappingManager",void 0),(0,l._)([(0,d.Cb)()],vr.prototype,"type",void 0),(0,l._)([(0,d.Cb)()],vr.prototype,"updating",null),vr=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],vr);var _r=function(){function e(t){(0,a.Z)(this,e),this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1,this.state=new Qi({graphic:t})}return(0,r.Z)(e,[{key:"graphic",get:function(){return this.state.graphic}}]),e}(),gr=i(46684),yr=i(68860),mr=i(29909),br=i(74579),Mr=i(3711);function Sr(e,t,i){var n="on-the-ground"===i.mode?Mr.v.XY:Mr.v.XYZ;return new Mr.A(e,n,t,0)}function wr(e,t,i){var n=(0,g.c)();if(!e.renderCoordsHelper.toRenderCoords(t,n))return null;var a=xr(e,t,(0,fn.mJ)(i.plane)),r=xr(e,t,i.edgeDirection);if((0,u.Wi)(a)||(0,u.Wi)(r))return null;var o=(0,_.f)((0,g.c)(),a,r);return(0,fn.Yq)(n,o,(0,fn.Ue)())}function xr(e,t,i){var n=(0,gt.Tx)(t.x+i[0],t.y+i[1],t.z+i[2],t.spatialReference),a=(0,g.c)(),r=(0,g.c)();return e.renderCoordsHelper.toRenderCoords(t,a)&&e.renderCoordsHelper.toRenderCoords(n,r)?(0,_.r)(r,a,r):null}var Cr=i(63920),Or=i(153),Er=i(4943),kr=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="reshape-edge-offset",n.distance=on.yP,n.area=null,n.totalLength=null,n}return(0,r.Z)(i)}(Er.h);(0,l._)([(0,d.Cb)()],kr.prototype,"type",void 0),(0,l._)([(0,d.Cb)()],kr.prototype,"distance",void 0),(0,l._)([(0,d.Cb)()],kr.prototype,"area",void 0),(0,l._)([(0,d.Cb)()],kr.prototype,"totalLength",void 0),kr=(0,l._)([(0,v.j)("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")],kr);var Ar=i(9856),Tr=i(13615),Pr=i(78952),Rr=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._vertexManipulatorMaterial=Jn(mi.colorToVec4(mi.reshapeManipulators.vertex.color),mi.reshapeManipulators.vertex.renderOccluded),n._vertexManipulatorOutlineMaterial=Kn(mi.colorToVec4(mi.reshapeManipulators.vertex.outlineColor),mi.reshapeManipulators.vertex.renderOccluded),n._vertexManipulatorHoverOutlineMaterial=Kn(mi.colorToVec4(mi.reshapeManipulators.vertex.hoverOutlineColor),mi.reshapeManipulators.vertex.renderOccluded),n._edgeManipulatorMaterial=Jn(mi.colorToVec4(mi.reshapeManipulators.edge.color),mi.reshapeManipulators.edge.renderOccluded),n._edgeManipulatorOutlineMaterial=Kn(mi.colorToVec4(mi.reshapeManipulators.edge.outlineColor),mi.reshapeManipulators.edge.renderOccluded),n._edgeOffsetManipulatorMaterial=Jn(mi.colorToVec4(mi.reshapeManipulators.edgeOffset.color),mi.reshapeManipulators.edgeOffset.renderOccluded,!1),n._edgeOffsetManipulatorHoverMaterial=Jn(mi.colorToVec4(mi.reshapeManipulators.edgeOffset.hoverColor),mi.reshapeManipulators.edgeOffset.renderOccluded,!1),n._selectedManipulatorMaterial=Jn(mi.colorToVec4(mi.reshapeManipulators.selected.color),mi.reshapeManipulators.selected.renderOccluded),n._selectedManipulatorOutlineMaterial=Kn(mi.colorToVec4(mi.reshapeManipulators.selected.outlineColor),mi.reshapeManipulators.selected.renderOccluded),n._selectedManipulatorHoverOutlineMaterial=Kn(mi.colorToVec4(mi.reshapeManipulators.selected.hoverOutlineColor),mi.reshapeManipulators.selected.renderOccluded),n._selectedIndex=0,n._manipulatorHandles=new Aa.Z,n._manipulatorInfos=[],n._numGrabbing=0,n._numDragging=0,n._reshapeEventState=Gr.NONE,n._recreatingManipulators=!1,n.outputGeometry=null,n._vertexLaserLineVisualElement=null,n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this,t=this.graphic,i=this.view,n=this._graphicState=new Qi({graphic:t});this._tooltip=new cr.u({view:i}),this.addHandles([(0,h.YP)((function(){return n.displaying}),(function(t){var i,n=(0,G.Z)(e._manipulatorInfos);try{for(n.s();!(i=n.n()).done;){i.value.manipulator.available=t}}catch(a){n.e(a)}finally{n.f()}})),(0,h.YP)((function(){return{labels:e._segmentLabels,enabled:e._labelOptions.enabled,edgeOffsetEnabled:e.enableEdgeOffset}}),(function(e){var t=e.labels,i=e.enabled,n=e.edgeOffsetEnabled;(0,u.pC)(t)&&(t.visible=i,t.edgeDistance=n?"far":"default")}),h.nn),(0,h.gx)((function(){return!e._tooltipOptions.enabled}),(function(){return e._tooltip.clear()}),h.nn),this.view.trackGraphicState(n)])}},{key:"destroy",value:function(){this._segmentLabels=(0,u.SC)(this._segmentLabels),this._tooltip=(0,u.SC)(this._tooltip),this._removeManipulators()}},{key:"inputGeometry",get:function(){return(0,u.pC)(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null},set:function(e){this._recreateEditGeometryAndManipulators(e)}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"manipulators",get:function(){return this.tool.manipulators}},{key:"view",get:function(){return this.tool.view}},{key:"graphic",get:function(){return this.tool.graphic}},{key:"enableZShape",get:function(){return this.tool.enableZShape}},{key:"enableZVertex",get:function(){return this.tool.enableZVertex}},{key:"enableMoveGraphic",get:function(){return this.tool.enableMoveGraphic}},{key:"enableMidpoints",get:function(){return this.tool.enableMidpoints}},{key:"enableEdgeOffset",get:function(){return this.tool.enableEdgeOffset}},{key:"_labelOptions",get:function(){return this.tool.labelOptions}},{key:"_tooltipOptions",get:function(){return this.tool.tooltipOptions}},{key:"removeSelectedVertices",value:function(){var e=this._manipulatorInfos.filter((function(e){return e.manipulator.selected&&"vertex"===e.type}));this._removeVertices(e)}},{key:"onManipulatorSelectionChanged",value:function(){this.emit("manipulators-changed")}},{key:"_removeManipulators",value:function(){this._manipulatorHandles.removeAll(),this._moveManipulation=(0,u.SC)(this._moveManipulation),this._graphicMoveManipulation=(0,u.SC)(this._graphicMoveManipulation),this.manipulators.removeAll(),this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0}},{key:"_createManipulators",value:function(e){if(!(0,u.Wi)(this._editGeometryOperations)){var t,i=(0,y.RL)(this.graphic),n=(0,G.Z)(this._editGeometryOperations.data.components);try{for(n.s();!(t=n.n()).done;){var a,r=t.value,o=null===e||void 0===e?void 0:e.byComponentIndex.get(r.index),s=(0,G.Z)(r.vertices);try{for(s.s();!(a=s.n()).done;){var l=a.value,c=null===o||void 0===o?void 0:o.has(l.index);this._createVertexOrEdgeManipulator(l,i,c)}}catch(f){s.e(f)}finally{s.f()}var h,d=(0,G.Z)(r.edges);try{for(d.s();!(h=d.n()).done;){var p=h.value;this._createVertexOrEdgeManipulator(p,i)}}catch(f){d.e(f)}finally{d.f()}}}catch(f){n.e(f)}finally{n.f()}this._createGraphicMoveManipulation(),this._createMoveManipulation(i),this._createVisualElements()}}},{key:"canRedo",get:function(){return(0,u.pC)(this._editGeometryOperations)&&this._editGeometryOperations.canRedo}},{key:"canUndo",get:function(){return(0,u.pC)(this._editGeometryOperations)&&this._editGeometryOperations.canUndo}},{key:"redo",value:function(){if((0,u.Wi)(this._editGeometryOperations))return null;var e=this._editGeometryOperations.redo();return(0,u.pC)(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}},{key:"undo",value:function(){if((0,u.Wi)(this._editGeometryOperations))return null;this.emit("undo");var e=this._editGeometryOperations.undo();return(0,u.pC)(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}},{key:"_recreateManipulators",value:function(){this._recreatingManipulators||(this._recreatingManipulators=!0,this._removeManipulators(),this._tooltip.clear(),this._createManipulators(),this._recreatingManipulators=!1)}},{key:"_recreateEditGeometryAndManipulators",value:function(e){var t={byComponentIndex:new Map};if((0,u.pC)(e)&&(0,u.pC)(this.inputGeometry)&&(0,P.Pt)(e,this.inputGeometry)){var i,n=(0,G.Z)(this._manipulatorInfos);try{for(n.s();!(i=n.n()).done;){var a=i.value;if("vertex"===a.type&&a.manipulator.selected){var r=a.handle,o=r.index,s=r.component.index,l=t.byComponentIndex,c=l.get(s)||new Set;c.add(o),l.set(s,c)}}}catch(h){n.e(h)}finally{n.f()}}this._recreatingManipulators=!0,this._removeManipulators(),this._tooltip.clear(),this._editGeometryOperations=(0,u.SC)(this._editGeometryOperations),this._segmentLabels=(0,u.SC)(this._segmentLabels),(0,u.Wi)(e)||(this._editGeometryOperations=rr.c.fromGeometry(e,this.view.state.viewingMode),this._createManipulators(t),this._segmentLabels=new $({context:{view:this.view,editGeometryOperations:this._editGeometryOperations,elevationInfo:(0,y.RL)(this.graphic),labelOptions:this._labelOptions,graphic:this.graphic,graphicState:this._graphicState},visible:this._labelOptions.enabled})),this._recreatingManipulators=!1}},{key:"_perGraphicManipulatorDragAction",value:function(e,t){if("end"===t.action)return t;var i,n=0,a=[],r=this._manipulatorInfos.some((function(e){return"vertex"===e.type&&e.manipulator.selected})),o=e===Lr.SELECTED_OR_ALL&&r,s=(0,G.Z)(this._manipulatorInfos);try{for(s.s();!(i=s.n()).done;){var l=i.value;"vertex"===l.type&&(l.manipulator.grabbing||o&&!l.manipulator.selected||a.push(l),n++)}}catch(c){s.e(c)}finally{s.f()}if(0===a.length)return t;if(this._moveVertices(a,t),a.length===n){if(this._updateEventState(Gr.MOVING),this.destroyed)return t;this.emit("move",{type:"move",dx:t.screenDeltaX,dy:t.screenDeltaY,mover:this.graphic})}else{if(this._updateEventState(Gr.RESHAPING),this.destroyed)return t;this.emit("reshape",{type:"reshape",mover:this.graphic})}return t}},{key:"_isMultiVertexSelection",value:function(){return this._manipulatorInfos.reduce((function(e,t){return"vertex"===t.type&&t.manipulator.selected?e+1:e}),0)>1}},{key:"_perVertexManipulatorDragAction",value:function(e){if(this._updateEventState(Gr.RESHAPING),!this.destroyed){var t=e.mapDeltaX,i=e.mapDeltaY,n=e.mapDeltaZ;if(t||i||n){var a,r=[],o=(0,G.Z)(this._manipulatorInfos);try{for(o.s();!(a=o.n()).done;){var s=a.value;"vertex"===s.type&&(s.manipulator.selected&&!s.manipulator.grabbing||s===e.info)&&r.push(s)}}catch(l){o.e(l)}finally{o.f()}this._moveVertices(r,e,Or.O.ACCUMULATE_STEPS),this.emit("reshape",{type:"reshape",mover:this.graphic})}}}},{key:"_updateEventState",value:function(e){if(e===this._reshapeEventState)return!1;switch(e){case Gr.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case Gr.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case Gr.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic})}break;case Gr.MOVING:switch(this._reshapeEventState){case Gr.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case Gr.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic})}break;case Gr.RESHAPING:switch(this._reshapeEventState){case Gr.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case Gr.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic})}}if(this.destroyed)return!1;var t=this._reshapeEventState!==e;return this._reshapeEventState=e,t}},{key:"_createGraphicMoveManipulation",value:function(){var e=this,t=this.tool,i=this.view,a=this._graphicState;if(this._graphicMoveManipulation=new ir({tool:t,view:i,graphicState:a}),this.enableMoveGraphic){var r=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline((function(t,i,n){i.next((function(t){return e._trackNumDragging(t)})).next((function(t){return"start"===t.action&&(r=(0,u.Wg)(e._editGeometryOperations).createUndoGroup()),t})).next((function(t){return e._perGraphicManipulatorDragAction(Lr.ALL,t)})).next((function(t){return e._updateTranslateGraphicTooltip(Ua.XY,t),t})).next((function(t){"end"===t.action&&(e._tooltip.clear(),r=(0,u.hw)(r))})),n.next((function(){return e._onDragCancel(!0,(function(){return r=(0,u.hw)(r)}))}))}))),this._graphicMoveManipulation.forEachManipulator((function(t){return e._manipulatorHandles.add(e._watchAndUpdateGrabState(t,!1))}))}else this._graphicMoveManipulation.forEachManipulator((function(e){e.grabbable=!1,e.cursor=null}));this._graphicMoveManipulation.forEachManipulator((function(t){return e._manipulatorHandles.add(t.events.on("immediate-click",(function(t){e._manipulatorInfos.some((function(e){return e.manipulator.selected}))?e._clearSelection():e.emit("immediate-click",(0,n.Z)((0,n.Z)({},t),{},{graphic:e.graphic})),t.stopPropagation()})))}))}},{key:"_createMoveManipulation",value:function(e){var t=this,i=this.graphic,a=this.handles,r=this.tool,o=this.view,s=this._graphicState;this._moveManipulation=new $a({tool:r,view:o,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&ca(i),snapToScene:!1,radius:$a.radiusForSymbol(i.symbol)}),this._moveManipulation.forEachManipulator((function(e){return a.add([e.events.on("immediate-click",(function(a){t._moveManipulation.zManipulation.hasManipulator(e)||t._manipulatorInfos.some((function(e){return e.manipulator.selected}))||t.emit("immediate-click",(0,n.Z)((0,n.Z)({},a),{},{graphic:i})),a.stopPropagation()})),t._watchAndUpdateGrabState(e,!1)])}));var l=function(e){return function(i){a.add(i.events.on("focus-changed",(function(i){"focus"===i.action&&t._tooltipOptions.enabled?t._updateTranslateTooltip(e):t._tooltip.clear()})))}};this._moveManipulation.xyManipulation.forEachManipulator(l(Ua.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(l(Ua.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(l(Ua.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};var c=(0,u.Wg)(i.geometry).spatialReference;a.add([this._moveManipulation.createDragPipeline((function(a,o,s,l,c){var h,d=(0,lr.W)({predicate:function(e){return!!e.info},snappingManager:r.snappingManager,snappingContext:new sr.N({editGeometryOperations:(0,u.Wg)(t._editGeometryOperations),elevationInfo:e,pointer:c,excludeFeature:i,visualizer:new Jt}),updatingHandles:t.updatingHandles,useZ:!1}),p=d.snappingStep,f=d.cancelSnapping;return l=l.next((function(e){return t._onDragCancel(),e})).next(f),{steps:s=(h=s.next((function(e){return t._trackNumDragging(e)})).next((function(e){var i=t._manipulatorInfos.filter((function(e){return"vertex"===e.type&&e.manipulator.selected}));return e.manipulatorType===sa.TRANSLATE_XY&&1===i.length?(0,n.Z)((0,n.Z)({},e),{},{info:i[0],snapOrigin:i[0].handle.pos}):e})).next((0,Ra.BS)(t.view,e,i))).next.apply(h,(0,S.Z)(p)).next((0,Ra.AN)()).next((function(e){return t._perGraphicManipulatorDragAction(Lr.SELECTED_OR_ALL,e)})).next((function(e){return t._updateTranslateTooltip(a,e),e})),cancel:l}}),e,c,i),(0,h.YP)((function(){return s.displaying}),(function(){return t._updateMoveManipulationPosition()}),h.nn),s.on("changed",(function(){t._recreatingManipulators||t._updateMoveManipulationPosition()})),(0,h.YP)((function(){return s.isDraped}),(function(e){t._updateMoveManipulationPosition();var i="align-move-manipulation";e?a.add(t.view.elevationProvider.on("elevation-change",(function(){return t._updateMoveManipulationPosition()})),i):a.remove(i)}),h.nn)])}},{key:"_createVisualElements",value:function(){var e=this,t=this.graphic,i=ma({view:this.view,graphic:t,forEachManipulator:function(t){if(!e.destroyed&&!e._recreatingManipulators){e._graphicMoveManipulation.forEachManipulator(t),e._moveManipulation.forEachManipulator(t);var i,n=(0,G.Z)(e._manipulatorInfos);try{for(n.s();!(i=n.n()).done;){t(i.value.manipulator,sa.TRANSLATE_XY)}}catch(a){n.e(a)}finally{n.f()}}},onManipulatorsChanged:function(t){return e.on("manipulators-changed",t)}});(0,u.pC)(i)&&(this._outlineVisualElement=i.visualElement instanceof wi?i.visualElement:null),(0,u.pC)(this._outlineVisualElement)&&this._manipulatorHandles.add(this._outlineVisualElement.events.on("attachment-origin-changed",(function(){e._graphicState.isDraped||e._updateMoveManipulationPosition()}))),this._manipulatorHandles.add(i)}},{key:"_createEdgeOffsetManipulator",value:function(e){var t,i,a=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,y.RL)(this.graphic),o=mi.reshapeManipulators.edgeOffset,s=o.size/2,l=s+o.collisionPadding,h=s/l,d=h*Math.sqrt(3)/2;(0,u.Wi)(this._edgeOffsetManipulatorGeometryInside)&&(this._edgeOffsetManipulatorGeometryInside=(0,ot.DA)(this._edgeOffsetManipulatorMaterial,d,h/2,h/2,o.height,o.offset)),(0,u.Wi)(this._edgeOffsetManipulatorGeometryOutside)&&(this._edgeOffsetManipulatorGeometryOutside=(0,ot.DA)(this._edgeOffsetManipulatorMaterial,-d,h/2,h/2,o.height,-o.offset));var p=[new Ln(this._edgeOffsetManipulatorGeometryInside.instantiate(),yn.Q9.Unfocused),new Ln(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),yn.Q9.Focused),new Ln(this._edgeOffsetManipulatorGeometryOutside.instantiate(),yn.Q9.Unfocused),new Ln(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),yn.Q9.Focused)],f=new bn({view:this.view,renderObjects:p,elevationInfo:"on-the-ground"!==r.mode||(0,br.YW)(this.graphic.symbol)?{mode:"absolute-height",offset:0}:r,worldOriented:!1,focusMultiplier:1,radius:l,available:!(!this.graphic.visible||null===(t=this.graphic.layer)||void 0===t||!t.visible),collisionType:{type:"disc",direction:(0,g.f)(0,0,1)},collisionPriority:1,metadata:{deleting:!1}}),v=new bn({view:this.view,worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||null===(i=this.graphic.layer)||void 0===i||!i.visible),collisionPriority:-10,cursor:this.enableMoveGraphic?"move":"default",metadata:{deleting:!1}}),_={manipulator:f,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:v,elevationInfo:r,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(_,o.minSquaredEdgeLength),this._updateEdgeOffsetManipulator(_);for(var m=[],b=0,M=[_.handle.leftVertex,_.handle.rightVertex];b<M.length;b++){var S=M[b],w=this._getManipulatorInfoFromHandle(S);(0,u.pC)(w)&&m.push(w.manipulator.events.on("location-update",(function(){return a._updateEdgeOffsetManipulator(_)})))}_.locationUpdateHandle=(0,c.AL)(m),this._manipulatorHandles.add(_.locationUpdateHandle,f),this._manipulatorHandles.add([this._watchAndUpdateGrabState(f,!0),this._watchAndUpdateGrabState(v,!0)],f),this._manipulatorHandles.add((0,Ra.Xd)(f,this._createEdgeOffsetPipeline(_,r)),f),this._manipulatorHandles.add((0,Ra.Xd)(v,(function(e,t,i,n){if("touch"===n)a._createEdgeOffsetPipeline(_,r)(e,t,i);else if(a.enableMoveGraphic){var o=a.graphic,s=(0,u.pC)(o.geometry)?o.geometry.spatialReference:null;t.next((function(e){return a._trackNumDragging(e)})).next((0,Ra.kY)(a.view,e.elevationAlignedLocation)).next(Ga(a.view,e.elevationAlignedLocation,r,s,o)).next((0,Ra.zh)()).next((0,Ra.AN)()).next((function(e){return a._perGraphicManipulatorDragAction(Lr.ALL,e)})).next((function(e){return a._updateTranslateGraphicTooltip(Ua.XY,e),e})).next((function(e){"end"===e.action&&a._tooltip.clear()})),i.next((function(){return a._onDragCancel(!e.metadata.deleting)}))}})),f);var x=function(e){a._manipulatorInfos.some((function(e){return e.manipulator.selected}))?a._clearSelection():a.emit("immediate-click",(0,n.Z)((0,n.Z)({},e),{},{graphic:a.graphic})),e.stopPropagation()};return this._manipulatorHandles.add([f.events.on("immediate-click",x),v.events.on("immediate-click",x),f.events.on("focus-changed",(function(e){var t=e.action,i=a._tooltipOptions;if("focus"===t&&i.enabled){var n=a._tooltip.info=new kr({tooltipOptions:i});a._updateTooltipAreaOrTotalLength(n)}else a._tooltip.clear()}))],f),this._manipulatorInfos.push(_),this.manipulators.add(f),this.manipulators.add(v),this.emit("manipulators-changed"),_}},{key:"_autoHideEdgeOffsetManipulator",value:function(e,t){var i=this,n=e.manipulator,a=e.edgeManipulator,r=function(){e.visibilityHandle=(0,u.hw)(e.visibilityHandle);var r=i._getManipulatorInfoFromHandle(e.handle.leftVertex),o=i._getManipulatorInfoFromHandle(e.handle.rightVertex),s=(0,u.pC)(r)&&(0,u.pC)(o)&&function(e,t,i){var n=i.projectToRenderScreen(e,(0,b.J$)()),a=i.projectToRenderScreen(t,(0,b.J$)());return(0,u.pC)(n)&&(0,u.pC)(a)?(0,_.p)((0,_.b)(n,n,a)):0}(r.manipulator.renderLocation,o.manipulator.renderLocation,i.view.state.camera)<t;(!n.focused&&!a.focused||s)&&(n.grabbable=!s,a.grabbable=!s,e.visibilityHandle=(0,c.AL)([n.disableDisplay(),{remove:function(){n.grabbable=!0,a.grabbable=i.enableMoveGraphic}}]))};this._manipulatorHandles.add([n.events.on("focus-changed",r),a.events.on("focus-changed",r),{remove:function(){(0,u.hw)(e.visibilityHandle),a.metadata.deleting=!0,i.manipulators.remove(a)}}],n),r()}},{key:"_updateEdgeOffsetManipulator",value:function(e){this._updateManipulatorPosition(e);var t=(0,u.Wg)(this._editGeometryOperations).data.coordinateHelper,i=wr(this.view,e.manipulator.elevationAlignedLocation,Sr(t,e.handle,(0,u.Wg)(e.manipulator.elevationInfo))),n=this._getManipulatorInfoFromHandle(e.handle.leftVertex),a=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if(!(0,u.Wi)(n)&&!(0,u.Wi)(a)){var r=n.manipulator.renderLocation,o=a.manipulator.renderLocation,s=(0,u.pC)(i)?function(e,t,i){var n=(0,fn.mJ)(e),a=(0,_.r)((0,g.c)(),t,i),r=(0,_.f)((0,g.c)(),a,n),o=(0,_.f)((0,g.c)(),a,r);return(0,Vt.f)(a[0],a[1],a[2],0,r[0],r[1],r[2],0,o[0],o[1],o[2],0,0,0,0,1)}(i,r,o):Vt.I;e.manipulator.modelTransform=s,e.edgeManipulator.elevationAlignedLocation=e.manipulator.elevationAlignedLocation,e.edgeManipulator.modelTransform=s;var l=(0,_.l)((0,_.b)(Vr,r,o))/2;e.edgeManipulator.collisionType={type:"line",paths:[[[-l,0,0],[l,0,0]]]}}}},{key:"_createEdgeOffsetPipeline",value:function(e,t){var i=this;return function(n,a,r){i._clearSelection();var o=i._initializeEdgeOffset(e,t),s=o.step,l=o.cleanup;a.next((function(e){return i._trackNumDragging(e)})).next((0,Ra.kY)(i.view,n.elevationAlignedLocation)).next(s).next(function(e){return Za(e,(function(e){return e.plane}))}(i.view)).next(Va(i.view,(0,u.Wg)(i._editGeometryOperations).data.spatialReference)).next((0,Ra.AN)()).next(i._applyComputeEdgeOffsetDistanceStep()).next(i._applyEdgeOffsetStep(e)).next(i._showEdgeOffsetTooltip()).next((function(e){"end"===e.action&&l()})),r.next((function(){n.metadata.deleting||(l(),i._onDragCancel())}))}}},{key:"_initializeEdgeOffset",value:function(e,t){var i=this,a=(0,u.Wg)(this._editGeometryOperations),r=Sr(a.data.coordinateHelper,e.handle,t),o=a.createUndoGroup(),s=wr(this.view,e.manipulator.elevationAlignedLocation,r);if(r.requiresSplitEdgeLeft){var l=this._getManipulatorInfoFromHandle(e.handle.leftVertex.leftEdge);(0,u.pC)(l)&&this._splitEdgeManipulator(l,1)}if(r.requiresSplitEdgeRight){var d=this._getManipulatorInfoFromHandle(e.handle.rightVertex.rightEdge);(0,u.pC)(d)&&this._splitEdgeManipulator(d,0)}var p,f=function(){return new mr.Z({paths:[[e.handle.leftVertex.pos,e.handle.rightVertex.pos]],spatialReference:a.data.spatialReference})},v=new wi({view:this.view,isDraped:this._graphicState.isDraped,geometry:f(),elevationInfo:e.elevationInfo,width:mi.visualElements.lineGraphics.outline.width,color:mi.colorToVec4(ii.main),attached:!0}),_=function(){i._cleanEdgeOffsetCollapsedEdges(e),p=(0,u.hw)(p)},g=this.on("undo",_);return p=(0,c.AL)([(0,c.ed)(v),(0,h.YP)((function(){return i._graphicState.isDraped}),(function(e){return v.isDraped=e})),this._graphicState.on("changed",(function(){return v.geometry=f()})),o,g]),{step:function(e){return(0,u.Wi)(r)||(0,u.Wi)(s)?(_(),null):(0,n.Z)((0,n.Z)({},e),{},{operation:r,plane:s})},cleanup:_}}},{key:"_applyEdgeOffsetStep",value:function(e){var t=this;return function(i){if(t.destroyed||(0,u.Wi)(i.operation))return i;t._updateEventState(Gr.RESHAPING);var n=i.mapDeltaX,a=i.mapDeltaY,r=i.mapDeltaZ;return(n||a||r)&&(t._offsetEdge(e,i),t.emit("reshape",{type:"reshape",mover:t.graphic})),i}}},{key:"_applyComputeEdgeOffsetDistanceStep",value:function(){return function(e){var t=e.operation,i=e.mapEnd;return(0,u.Wi)(t)||(0,u.Wi)(i)?e:("start"===e.action&&t.selectArrowFromStartPoint(i),(0,n.Z)((0,n.Z)({},e),{},{signedDistance:t.signedDistanceToPoint(i)}))}}},{key:"_showEdgeOffsetTooltip",value:function(){var e=this;return function(t){var i=t.mapEnd,n=t.signedDistance,a=t.operation,r=e._tooltip,o=e._tooltipOptions;if(!o.enabled||(0,u.Wi)(n))return r.clear(),t;var s=r.info;((0,u.Wi)(s)||"reshape-edge-offset"!==s.type)&&(s=r.info=new kr({tooltipOptions:o}));var l=(0,u.Wg)(e._editGeometryOperations).data.coordinateHelper;return s.distance="end"===t.action?on.yP:function(e,t,i,n,a){if(e){var r=a.toXYZ(a.pointToVector(i)),o=(0,fn.nF)(n,r,kt.WM.get()),s=(0,Tr.FB)(o,r,a.spatialReference);if((0,u.pC)(s))return(0,on.yG)(s.value*Math.sign(t),s.unit)}return(0,on.yG)(t*(0,yr.c9)(i.spatialReference),"meters")}(e._graphicState.isDraped,n*a.selectedArrow,i,a.plane,l),e._updateTooltipAreaOrTotalLength(s),t}}},{key:"_cleanEdgeOffsetCollapsedEdges",value:function(e){var t,i,n=null===(t=e.handle.leftVertex.leftEdge)||void 0===t?void 0:t.leftVertex,a=e.handle.leftVertex,r=null===(i=e.handle.rightVertex.rightEdge)||void 0===i?void 0:i.rightVertex,o=e.handle.rightVertex,s=(0,u.Wg)(this._editGeometryOperations).data.coordinateHelper,l=[];if(n&&s.distance(n.pos,a.pos)<zr){var c=this._getManipulatorInfoFromHandle(a);(0,u.pC)(c)&&l.push(c)}if(s.distance(a.pos,o.pos)<zr||r&&s.distance(r.pos,o.pos)<zr){var h=this._getManipulatorInfoFromHandle(o);(0,u.pC)(h)&&l.push(h)}l.length&&this._removeVertices(l)}},{key:"_computeVertexManipulatorSizeAndOutline",value:function(e){var t=e.size/2,i=t+e.collisionPadding;return{size:t/i,outlineSize:(t+e.outlineSize)/i}}},{key:"_createVertexOrEdgeManipulator",value:function(e){var t,i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,y.RL)(this.graphic),r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("edge"===e.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(e,a);if(!this.enableMidpoints)return null}if((0,u.Wi)(this._vertexManipulatorGeometry)||(0,u.Wi)(this._vertexManipulatorOutlineGeometry)){var o=this._computeVertexManipulatorSizeAndOutline(mi.reshapeManipulators.vertex),s=o.size,l=o.outlineSize;this._vertexManipulatorGeometry=(0,ot.PI)(this._vertexManipulatorMaterial,s,16,16),this._vertexManipulatorOutlineGeometry=(0,ot.PI)(this._vertexManipulatorOutlineMaterial,l,16,16)}if((0,u.Wi)(this._edgeManipulatorGeometry)||(0,u.Wi)(this._edgeManipulatorOutlineGeometry)){var h=this._computeVertexManipulatorSizeAndOutline(mi.reshapeManipulators.edge),d=h.size,p=h.outlineSize;this._edgeManipulatorGeometry=(0,ot.PI)(this._edgeManipulatorMaterial,d,16,16),this._edgeManipulatorOutlineGeometry=(0,ot.PI)(this._edgeManipulatorOutlineMaterial,p,16,16)}var f=(0,u.pC)(this.graphic.geometry)&&"point"===this.graphic.geometry.type?[]:[new Ln(this._vertexManipulatorGeometry.instantiate(),Zr.Vertex|yn.Q9.Unselected),new Ln(this._vertexManipulatorOutlineGeometry.instantiate(),Zr.Vertex|yn.Q9.Unfocused|yn.Q9.Unselected),new Ln(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Zr.Vertex|yn.Q9.Focused|yn.Q9.Unselected),new Ln(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),yn.Q9.Selected),new Ln(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),yn.Q9.Selected|yn.Q9.Unfocused),new Ln(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),yn.Q9.Selected|yn.Q9.Focused)];this.enableMidpoints&&f.push(new Ln(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),Zr.Edge|yn.Q9.Focused|yn.Q9.Unselected),new Ln(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Zr.Edge|yn.Q9.Focused|yn.Q9.Unselected),new Ln(this._edgeManipulatorGeometry.instantiate(),Zr.Edge|yn.Q9.Unfocused|yn.Q9.Unselected),new Ln(this._edgeManipulatorOutlineGeometry.instantiate(),Zr.Edge|yn.Q9.Unfocused|yn.Q9.Unselected));var v=new bn({view:this.view,renderObjects:f,elevationInfo:a,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||null===(t=this.graphic.layer)||void 0===t||!t.visible),metadata:{deleting:!1}});v.selected=r,this._setTypeSpecificManipulatorSettings(v,e,a);var _="edge"===e.type?{manipulator:v,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:v,handle:e,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(_),this.manipulators.add(v),this._updateManipulatorPosition(_),"edge"===_.type){for(var g=[],m=0,b=[_.handle.leftVertex,_.handle.rightVertex];m<b.length;m++){var M=b[m],w=this._getManipulatorInfoFromHandle(M);(0,u.pC)(w)&&g.push(w.manipulator.events.on("location-update",(function(){return i._updateManipulatorPosition(_)})))}_.locationUpdateHandle=(0,c.AL)(g),this._manipulatorHandles.add(_.locationUpdateHandle,v)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(v,!0),v);var x=(0,Ra.Xd)(v,(function(e,t,r,o){var s,l=null,c=(0,lr.W)({predicate:function(){return!i._isMultiVertexSelection()},snappingManager:i.tool.snappingManager,snappingContext:new sr.N({editGeometryOperations:(0,u.Wg)(i._editGeometryOperations),elevationInfo:a,pointer:o,excludeFeature:i.graphic,visualizer:new Jt}),updatingHandles:i.updatingHandles,useZ:!1}),h=c.snappingStep,d=c.cancelSnapping;r=r.next((function(t){return i._onDragCancel(!e.metadata.deleting,(function(){return l=(0,u.hw)(l)})),t})).next(d),(s=t.next((function(e){return i._trackNumDragging(e)})).next((function(e){if("start"===e.action&&(l=(0,u.Wg)(i._editGeometryOperations).createUndoGroup()),"edge"===_.type){var t=i._splitEdgeManipulator(_);return(0,n.Z)((0,n.Z)({},e),{},{info:t,snapOrigin:t.handle.pos})}return(0,n.Z)((0,n.Z)({},e),{},{info:_,snapOrigin:_.handle.pos})})).next((0,Ra.kY)(i.view,e.elevationAlignedLocation)).next(La(i.view,i.graphic,e.elevationAlignedLocation,e.location.spatialReference,i.graphic)).next((0,Ra.BS)(i.view,a,i.graphic))).next.apply(s,(0,S.Z)(h)).next((0,Ra.AN)()).next((function(t){i._perVertexManipulatorDragAction(t),"end"===t.action&&(l=(0,u.hw)(l)),i._updateTranslateVertexTooltip(e,Ua.XY,t)}))}));return this._manipulatorHandles.add([x,v.events.on("immediate-click",(function(e){return i._manipulatorClickCallback(e,_)})),v.events.on("select-changed",(function(){_.selectedIndex=++i._selectedIndex,i._updateMoveManipulationPosition()})),v.events.on("focus-changed",(function(e){"focus"===e.action&&"edge"!==_.type?i._updateTranslateVertexTooltip(v,Ua.XY):i._tooltip.clear()}))],v),this.emit("manipulators-changed"),_}},{key:"_trackNumDragging",value:function(e){switch(e.action){case"start":this._numDragging++;break;case"end":this._numDragging--}return e}},{key:"_onDragCancel",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(this._numDragging--,e&&(this.undo(),this.outputGeometry=(0,u.pC)(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null),(0,u.pC)(this.tool.snappingManager)&&this.tool.snappingManager.doneSnapping(),this._tooltip.clear(),this._reshapeEventState){case Gr.NONE:break;case Gr.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case Gr.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic})}t&&t(),this.destroyed||this._updateEventState(Gr.NONE)}},{key:"_setTypeSpecificManipulatorSettings",value:function(e,t,i){switch(t.type){case"vertex":e.state=Zr.Vertex,e.selectable=!0,e.cursor="move",e.collisionPriority=2,e.radius=mi.reshapeManipulators.vertex.size/2+mi.reshapeManipulators.vertex.collisionPadding,e.elevationInfo=i,e.interactive=(0,u.pC)(this.graphic.geometry)&&"point"!==this.graphic.geometry.type;break;case"edge":e.state=Zr.Edge,e.selectable=!1,e.cursor="copy",e.collisionPriority=-1,e.radius=mi.reshapeManipulators.edge.size/2+mi.reshapeManipulators.edge.collisionPadding,e.elevationInfo="on-the-ground"!==i.mode||(0,br.YW)(this.graphic.symbol)?{mode:"absolute-height",offset:0}:i}}},{key:"_watchAndUpdateGrabState",value:function(e,t){var i=this;return e.events.on("grab-changed",(function(n){return i._onGrabStateChanged(e,t,n.action,n.pointerType)}))}},{key:"_onGrabStateChanged",value:function(e,t,i){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";if(!this._recreatingManipulators){if("start"===i)t&&this._updateSelection(e),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(Gr.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==a||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((function(e){e.manipulator.interactive=e.manipulator.grabbing||!n._numGrabbing&&(0,u.pC)(n.graphic.geometry)&&"point"!==n.graphic.geometry.type,"edgeManipulator"in e&&(e.edgeManipulator.interactive=e.edgeManipulator.grabbing||!n._numGrabbing)})),this._graphicMoveManipulation.forEachManipulator((function(e){e.interactive=e.grabbing||!n._numGrabbing})))}}},{key:"_clearSelection",value:function(){var e,t=(0,G.Z)(this._manipulatorInfos);try{for(t.s();!(e=t.n()).done;){var i=e.value;i.manipulator.grabbing||(i.manipulator.selected=!1)}}catch(n){t.e(n)}finally{t.f()}}},{key:"_updateSelection",value:function(e){e.grabbing&&!e.selected&&e.selectable&&(this._clearSelection(),e.selected=!0,this.emit("manipulators-changed"))}},{key:"_removeManipulator",value:function(e){(0,u.Wi)(e)||(e.manipulator.metadata.deleting=!0,this.manipulators.remove(e.manipulator),this._manipulatorHandles.remove(e.manipulator),(0,f.e$)(this._manipulatorInfos,e),this.emit("manipulators-changed"))}},{key:"_getManipulatorInfoFromHandle",value:function(e){if(e){var t,i=(0,G.Z)(this._manipulatorInfos);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(e===n.handle)return n}}catch(a){i.e(a)}finally{i.f()}}return null}},{key:"_updateManipulatorPosition",value:function(e){if(!(0,u.Wi)(e)){var t=(0,u.Wg)(this._editGeometryOperations);if("vertex"===e.type)e.manipulator.location=t.data.coordinateHelper.vectorToDehydratedPoint(e.handle.pos,Ir),e.manipulator.grabbing&&(0,u.pC)(this._vertexLaserLineVisualElement)&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=e.manipulator.renderLocation);else if("edge"===e.type){var i=this._getManipulatorInfoFromHandle(e.handle.leftVertex),n=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if((0,u.Wi)(i)||(0,u.Wi)(n))return;var a=i.manipulator,r=n.manipulator;if((0,u.pC)(e.manipulator.elevationInfo)&&"on-the-ground"===e.manipulator.elevationInfo.mode){var o=a.location,s=r.location,l=o.x+.5*(s.x-o.x),c=o.y+.5*(s.y-o.y),h=o.hasZ&&s.hasZ?0:void 0;e.manipulator.location=(0,gt.Tx)(l,c,h,t.data.spatialReference)}else(0,_.h)(Vr,a.renderLocation,r.renderLocation,.5),e.manipulator.renderLocation=Vr}}}},{key:"_splitEdgeManipulator",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=(0,u.Wg)(this._editGeometryOperations),n=(0,u.Wg)(i.splitEdge(e.handle,t).createdVertex);e.locationUpdateHandle=(0,u.hw)(e.locationUpdateHandle);var a,r=(0,y.RL)(this.graphic);this.enableEdgeOffset?(this._removeManipulator(e),a=this._createVertexOrEdgeManipulator(n)):((a=e).handle=n,a.type="vertex",this._setTypeSpecificManipulatorSettings(e.manipulator,e.handle,r)),n.leftEdge&&this._createVertexOrEdgeManipulator(n.leftEdge),n.rightEdge&&this._createVertexOrEdgeManipulator(n.rightEdge),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(a),this.enableEdgeOffset||this._updateTranslateVertexTooltip(a.manipulator,Ua.XY),this._updateSelection(e.manipulator);var o=this._updateEventState(Gr.RESHAPING),s=i.data.coordinateHelper.vectorToArray(a.handle.pos),l=i.data.components.indexOf(n.component);return this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:s,componentIndex:l,vertexIndex:(0,u.Wg)(n.index)}],added:s}),o&&this._updateEventState(Gr.NONE),a}},{key:"_updateMoveManipulationPosition",value:function(){var e,t=(0,_.s)(Vr,0,0,0),i=0,n=!1,a=null,r=null,o=(0,G.Z)(this._manipulatorInfos);try{for(o.s();!(e=o.n()).done;){var s=e.value;"vertex"===s.type&&(s.manipulator.selected?(i++,(0,_.a)(t,t,s.manipulator.renderLocation),(0,u.Wi)(a)||s.selectedIndex>a.selectedIndex?(r=a,a=s):((0,u.Wi)(r)||s.selectedIndex>r.selectedIndex)&&(r=s)):n=!0)}}catch(v){o.e(v)}finally{o.f()}if(0===i){var l=this._graphicState.displaying&&this.enableMoveGraphic;this._moveManipulation.xyManipulation.available=l,this._moveManipulation.xyAxisManipulation.available=l,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=l,this._moveManipulation.zManipulation.available=l&&this.enableZShape&&ca(this.graphic),this._moveManipulation.angle=Fa((0,u.Wg)(this.graphic.geometry)),this._moveManipulation.radius=$a.radiusForSymbol(this.graphic.symbol)}else{var c=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=c,this._moveManipulation.xyAxisManipulation.available=c,this._moveManipulation.zManipulation.available=c&&this.enableZVertex&&ca(this.graphic),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=c&&1!==i;var h=0;if((0,u.pC)(a)){var d=a.handle.pos,p=(0,u.pC)(r)?r.handle.pos:a.handle.leftEdge&&a.handle.leftEdge.leftVertex?a.handle.leftEdge.leftVertex.pos:null,f=(0,u.Wi)(r)&&a.handle.rightEdge&&a.handle.rightEdge.rightVertex?a.handle.rightEdge.rightVertex.pos:null;p&&f?this._moveManipulation.xyAxisManipulation.available=!1:p?h=Dr(p,d):f&&(h=Dr(d,f))}this._moveManipulation.angle=h,this._moveManipulation.radius=wa}0!==i&&n?((0,_.g)(t,t,1/i),Ir.spatialReference=(0,u.Wg)(this._editGeometryOperations).data.spatialReference,Ir.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(t,Ir),this._moveManipulation.elevationAlignedLocation=Ir):(0,u.pC)(this._outlineVisualElement)&&!this._graphicState.isDraped&&(0,u.pC)(this._outlineVisualElement.attachmentOrigin)?this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin:ra(this.view,this._moveManipulation,this.graphic)}},{key:"_removeVertices",value:function(e){var t,i=new Array,n=(0,u.Wg)(this._editGeometryOperations),a=(0,G.Z)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;if("vertex"===r.type&&n.canRemoveVertex()){var o;i.push(r.handle),this._removeManipulator(r),this._removeManipulator(this._getManipulatorInfoFromHandle(r.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(r.handle.rightEdge));var s=n.removeVertices([r.handle]),l=(0,u.Wg)(null===(o=s.removedVertices)||void 0===o?void 0:o[0].createdEdge);l&&this._createVertexOrEdgeManipulator(l)}}}catch(d){a.e(d)}finally{a.f()}if(i.length>0){var c=i.map((function(e){var t=n.data.components.indexOf(e.component);return{coordinates:n.data.coordinateHelper.vectorToArray(e.pos),componentIndex:t,vertexIndex:(0,u.Wg)(e.index)}}));this.outputGeometry=n.data.geometry;var h=this._updateEventState(Gr.RESHAPING);if(this.destroyed)return;if(this.emit("vertex-remove",{type:"vertex-remove",removed:c.map((function(e){return e.coordinates})),vertices:c}),this.destroyed)return;if(h&&(this._updateEventState(Gr.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}},{key:"_moveVertices",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start"===t.action?Or.O.NEW_STEP:Or.O.ACCUMULATE_STEPS,n=(0,u.Wg)(this._editGeometryOperations);n.moveVertices(e.map((function(e){return e.handle})),t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i),this.outputGeometry=n.data.geometry;var a,r=(0,G.Z)(e);try{for(r.s();!(a=r.n()).done;){var o=a.value;this._updateManipulatorPosition(o)}}catch(s){r.e(s)}finally{r.f()}}},{key:"_offsetEdge",value:function(e,t){if(!(0,u.Wi)(t.operation)&&!(0,u.Wi)(t.signedDistance)){var i=(0,u.Wg)(this._editGeometryOperations),n=t.operation.clone();n.distance=t.signedDistance,i.updateVertices([e.handle.leftVertex,e.handle.rightVertex],n),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.rightVertex))}}},{key:"_manipulatorClickCallback",value:function(e,t){e.shiftKey||this._clearSelection(),"vertex"===t.type&&(t.manipulator.selected=!t.manipulator.selected,e.button===Cr.t.Right&&this._removeVertices([t])),"edge"===t.type&&e.button===Cr.t.Left&&this._splitEdgeManipulator(t),e.stopPropagation()}},{key:"_updateTranslateTooltip",value:function(e,t){var i=this._manipulatorInfos.filter((function(e){return"vertex"===e.type&&e.manipulator.selected}));1===i.length?this._updateTranslateVertexTooltip(i[0].manipulator,e,t):this._updateTranslateGraphicTooltip(e,t)}},{key:"_updateTranslateGraphicTooltip",value:function(e,t){var i=this._tooltipOptions;if(i.enabled){var n=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(e){case Ua.XY:this._tooltip.info=new ur.$E({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,(function(e,t){return(0,U.GQ)(e,t,n)}));break;case Ua.XY_AXIS:this._tooltip.info=new ur.in({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,(function(e,i){var a=(0,U.GQ)(e,i,n);return(0,on.bA)(a,Ha(t))}));break;case Ua.Z:this._tooltip.info=new ur.QW({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,hr._e)}}}},{key:"_updateTranslateVertexTooltip",value:function(e,t,i){var a=this._tooltipOptions;if(a.enabled){var r,o=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case Ua.XY:r=new ur.nk({tooltipOptions:a}),this._updateTranslateTooltipDistance(r,i,(function(e,t){return(0,U.GQ)(e,t,o)})),this._updateTooltipAreaOrTotalLength(r);break;case Ua.XY_AXIS:r=new ur.c1({tooltipOptions:a}),this._updateTranslateTooltipDistance(r,i,(function(e,t){var n=(0,U.GQ)(e,t,o);return(0,on.bA)(n,Ha(i))})),this._updateTooltipAreaOrTotalLength(r);break;case Ua.Z:r=new ur.j({tooltipOptions:a}),this._updateTranslateTooltipDistance(r,i,hr._e)}var s=(0,hr.g1)(e.elevationAlignedLocation);(0,u.pC)(s)&&(r.elevation=(0,n.Z)({mode:"absolute-height"},s)),this._tooltip.info=r}}},{key:"_updateTranslateTooltipDistance",value:function(e,t,i){if((0,u.pC)(t)&&"end"!==t.action){var n=i(t.mapStart,t.mapEnd);e.distance=(0,u.pC)(n)?n:on.yP}}},{key:"_updateTooltipAreaOrTotalLength",value:function(e){var t=this.graphic.geometry;if(!(0,u.Wi)(t)){var i=this._graphicState.isDraped?"on-the-ground":"absolute-height";e.area="polygon"===t.type?(0,Ar.k)(t,i):null,e.totalLength="polyline"===t.type?(0,U.Ul)(t,i):null}}},{key:"test",get:function(){return{segmentLabels:this._segmentLabels,tooltip:this._tooltip}}}]),i}(bi.Z.EventedMixin(rn.r));function Dr(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI/2}(0,l._)([(0,d.Cb)()],Rr.prototype,"_editGeometryOperations",void 0),(0,l._)([(0,d.Cb)()],Rr.prototype,"_segmentLabels",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],Rr.prototype,"tool",void 0),(0,l._)([(0,d.Cb)()],Rr.prototype,"_tooltip",void 0),(0,l._)([(0,d.Cb)()],Rr.prototype,"inputGeometry",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"outputGeometry",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],Rr.prototype,"updating",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"manipulators",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"view",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"graphic",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"enableZShape",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"enableZVertex",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"enableMoveGraphic",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"enableMidpoints",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"enableEdgeOffset",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"_labelOptions",null),(0,l._)([(0,d.Cb)()],Rr.prototype,"_tooltipOptions",null),Rr=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],Rr);var Zr,Gr,Lr,Ir=(0,gt.Tx)(0,0,void 0,Pr.Z.WGS84),Vr=(0,g.c)(),zr=1e-6;!function(e){e.Vertex=yn.jg.Custom1,e.Edge=yn.jg.Custom2}(Zr||(Zr={})),function(e){e[e.NONE=0]="NONE",e[e.MOVING=1]="MOVING",e[e.RESHAPING=2]="RESHAPING"}(Gr||(Gr={})),function(e){e[e.ALL=0]="ALL",e[e.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"}(Lr||(Lr={}));var Wr=i(52349),Nr=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._handles=new Aa.Z,n._internalGeometryUpdate=!1,n.enableZShape=!0,n.enableZVertex=!0,n.enableMoveGraphic=!0,n.enableMidpoints=!0,n.enableEdgeOffset=!1,n.type="reshape-3d",n.labelOptions=new Wr.Z,n.tooltipOptions=new or.Z,n.snappingManager=null,n.automaticManipulatorSelection=!1,n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this,t=this._reshapeOperation=new Rr({tool:this});this.addHandles([t.on("reshape",(function(t){"reshape"===t.type&&e._onReshapeGeometryChanged(),e.emit("reshape",t)})),t.on("move",(function(t){"move"===t.type&&e._onReshapeGeometryChanged(),e.emit("move",t)})),t.on("vertex-add",(function(t){e._onReshapeGeometryChanged(),e.emit("vertex-add",t)})),t.on("vertex-remove",(function(t){e._onReshapeGeometryChanged(),e.emit("vertex-remove",t)})),t.on("immediate-click",(function(t){return e.emit("immediate-click",t)})),this.view.on("pointer-down",["Shift"],(function(e){return e.stopPropagation()})),(0,h.YP)((function(){return e.graphic}),(function(){return e._updateGraphic()}),h.tX)]),this.finishToolCreation()}},{key:"destroy",value:function(){this._handles=(0,u.SC)(this._handles),this._reshapeOperation=(0,u.SC)(this._reshapeOperation)}},{key:"updating",get:function(){var e,t;return null!==(e=null===(t=this._reshapeOperation)||void 0===t?void 0:t.updating)&&void 0!==e&&e}},{key:"_updateGeometry",value:function(){var e=(0,gr.b)(this.graphic);this._reshapeOperation.inputGeometry=(0,u.pC)(e)?e.clone():null}},{key:"_updateGraphic",value:function(){var e=this;if(this._handles.remove("onGraphicGeometryChange"),this._updateGeometry(),(0,gr.P)(this.graphic)===la.e.SUPPORTED){var t=(0,h.YP)((function(){var t;return null===(t=e.graphic)||void 0===t?void 0:t.geometry}),(function(){!1===e._internalGeometryUpdate&&e._updateGeometry()}),h.Z_);this._handles.add(t,"onGraphicGeometryChange")}}},{key:"onManipulatorSelectionChanged",value:function(){this._reshapeOperation&&this._reshapeOperation.onManipulatorSelectionChanged()}},{key:"_updateGeometryInternally",value:function(e){this._internalGeometryUpdate=!0,this.graphic.geometry=e,this._internalGeometryUpdate=!1}},{key:"_onReshapeGeometryChanged",value:function(){var e=this._reshapeOperation.outputGeometry;!(0,u.Wi)(this.graphic)&&e&&this._updateGeometryInternally(e.clone())}},{key:"canUndo",get:function(){var e;return null!==(e=this._reshapeOperation.canUndo)&&void 0!==e&&e}},{key:"undo",value:function(){(0,u.pC)(this.snappingManager)&&this.snappingManager.doneSnapping();var e=this._reshapeOperation.undo(),t=this._reshapeOperation.outputGeometry;e&&t&&this._updateGeometryInternally(t.clone())}},{key:"canRedo",get:function(){var e;return null!==(e=this._reshapeOperation.canRedo)&&void 0!==e&&e}},{key:"redo",value:function(){(0,u.pC)(this.snappingManager)&&this.snappingManager.doneSnapping();var e=this._reshapeOperation.redo(),t=this._reshapeOperation.outputGeometry;e&&t&&this._updateGeometryInternally(t.clone())}},{key:"onInputEvent",value:function(e){"key-down"!==e.type||"Delete"!==e.key&&"Backspace"!==e.key||this._reshapeOperation.removeSelectedVertices()}},{key:"reset",value:function(){}},{key:"test",get:function(){return{snappingManager:this.snappingManager,reshapeOperation:this._reshapeOperation}}}]),i}(bi.Z.EventedMixin(ar.m));(0,l._)([(0,d.Cb)()],Nr.prototype,"_reshapeOperation",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Nr.prototype,"view",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],Nr.prototype,"graphic",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Nr.prototype,"enableZShape",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Nr.prototype,"enableZVertex",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Nr.prototype,"enableMoveGraphic",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Nr.prototype,"enableMidpoints",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],Nr.prototype,"enableEdgeOffset",void 0),(0,l._)([(0,d.Cb)()],Nr.prototype,"type",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,type:Wr.Z})],Nr.prototype,"labelOptions",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,type:or.Z})],Nr.prototype,"tooltipOptions",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],Nr.prototype,"snappingManager",void 0),(0,l._)([(0,d.Cb)()],Nr.prototype,"updating",null),(0,l._)([(0,d.Cb)()],Nr.prototype,"automaticManipulatorSelection",void 0),Nr=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],Nr);var jr=i(17768),Fr=i(99346),Hr=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="transform-rotate",n.rotationType="geographic",n}return(0,r.Z)(i)}(Er.h);(0,l._)([(0,d.Cb)()],Hr.prototype,"type",void 0),(0,l._)([(0,d.Cb)()],Hr.prototype,"rotation",void 0),(0,l._)([(0,d.Cb)()],Hr.prototype,"rotationPrecision",void 0),(0,l._)([(0,d.Cb)()],Hr.prototype,"orientation",void 0),(0,l._)([(0,d.Cb)()],Hr.prototype,"orientationPrecision",void 0),(0,l._)([(0,d.Cb)()],Hr.prototype,"rotationType",void 0),Hr=(0,l._)([(0,v.j)("esri.views.interactive.tooltip.TransformRotateTooltipInfo")],Hr);var Ur=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="transform-scale",n.sizeUnit=null,n.sizePrecision=null,n}return(0,r.Z)(i)}(Er.h);(0,l._)([(0,d.Cb)()],Ur.prototype,"type",void 0),(0,l._)([(0,d.Cb)()],Ur.prototype,"scale",void 0),(0,l._)([(0,d.Cb)()],Ur.prototype,"size",void 0),(0,l._)([(0,d.Cb)()],Ur.prototype,"sizeUnit",void 0),(0,l._)([(0,d.Cb)()],Ur.prototype,"sizePrecision",void 0),Ur=(0,l._)([(0,v.j)("esri.views.interactive.tooltip.TransformScaleTooltipInfo")],Ur);var Br,Yr,Xr=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="transform-absolute",n.orientationEnabled=!0,n.orientationPrecision=null,n.rotationType="geographic",n.sizeUnit=null,n.sizeEnabled=!0,n.sizePrecision=null,n}return(0,r.Z)(i)}(Er.h);(0,l._)([(0,d.Cb)()],Xr.prototype,"type",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"orientation",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"orientationEnabled",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"orientationPrecision",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"rotationType",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"size",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"sizeUnit",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"sizeEnabled",void 0),(0,l._)([(0,d.Cb)()],Xr.prototype,"sizePrecision",void 0),Xr=(0,l._)([(0,v.j)("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")],Xr),function(e){e.ScaleIn=yn.jg.Custom2,e.ScaleOut=yn.jg.Custom3,e.RotateLeft=yn.jg.Custom4,e.RotateRight=yn.jg.Custom5,e.Unlocked=yn.jg.Custom7,e.DelayedFocused=yn.jg.Custom8,e.TouchInput=yn.jg.Custom12}(Br||(Br={}));var qr=function(){function e(t){var i=this,n=t.adapter,r=t.tooltipOptions,o=t.mode,s=t.tool;(0,a.Z)(this,e),this._mode=null,this._handles=new Aa.Z,this._scaleRotateDragData=null,this._activeAnimation=null,this._ringIndicatorDelayMs=200,this.events=new bi.Z,this.getFocused=function(){return i._ringManipulator.focused},this.getScale=function(){return(0,u.pC)(i._scaleRotateDragData)&&"scale"===i._scaleRotateDragData.mode?i._adapter.scale:1},this.tool=s,this._mode=o,this._adapter=n,this._tooltipOptions=r,this._tooltip=new cr.u({view:s.view}),this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform(),this._handles.add((0,h.gx)((function(){return!i._tooltipOptions.enabled}),(function(){return i._tooltip.clear()}),h.nn))}return(0,r.Z)(e,[{key:"angle",get:function(){return this._adapter.angle}},{key:"scale",get:function(){return this._adapter.scale}},{key:"location",set:function(e){this._ringManipulator.location=e}},{key:"elevationAlignedLocation",set:function(e){this._ringManipulator.elevationAlignedLocation=e}},{key:"grabbing",get:function(){return this._ringManipulator.grabbing}},{key:"interactive",set:function(e){this._ringManipulator.interactive=e}},{key:"destroy",value:function(){(0,u.pC)(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=null),this._handles=(0,u.SC)(this._handles),this.tool.manipulators.remove(this._ringManipulator),this._ringManipulator=null,this._tooltip=(0,u.SC)(this._tooltip)}},{key:"startAnimation",value:function(e){var t=this;this.cancelActiveAnimation(),e.start();var i=(0,Fr.A)({update:function(i){var n=i.deltaTime;e.update(n)&&t.cancelActiveAnimation()}});this._activeAnimation=(0,n.Z)((0,n.Z)({},e),{},{frameTask:i})}},{key:"cancelActiveAnimation",value:function(){(0,u.pC)(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=(0,u.SC)(this._activeAnimation))}},{key:"forEachManipulator",value:function(e){e(this._ringManipulator,sa.SCALE_ROTATE)}},{key:"_createManipulator",value:function(){var e=this,t=this._createRingManipulator();this._ringManipulator=t,this.tool.manipulators.add(t);var i=this.tool.graphicState.graphic,n=(0,Ra.Xd)(t,(function(t,n,a){e._scaleRotateDragData=null;var r=e._adapter.startInteraction(),o={mode:"none",origin:(0,g.a)(t.renderLocation),initialAngle:e._adapter.angle,angle:0,angleDir:0,scaleDir:0};e._scaleRotateDragData=o,e._updateDragState();var s=kt.WM.get();e.tool.view.renderCoordsHelper.worldUpAtPosition(t.renderLocation,s),n.next(Da(e.tool.view,(0,fn.Yq)(t.renderLocation,s,(0,fn.Ue)()))).next((function(t){var n=(0,fn.mJ)(t.plane),a=ia(t.renderStart,t.renderEnd,o.origin,n),s=jr.Q4.shortestSignedDiff(o.angle,a);o.angleDir=(0,Ye.uZ)(o.angleDir+s,-.3,.3),o.angle=a;var l=function(e,t){var i=(0,_.b)(kt.WM.get(),t.renderStart,e.origin),n=(0,_.b)(kt.WM.get(),t.renderEnd,e.origin),a=(0,_.l)(i),r=(0,_.l)(n);return 0===a?0:r/a}(o,t),c=l-e._adapter.scale;if(o.scaleDir=(0,Ye.uZ)(o.scaleDir+c,-.2,.2),e._onScaleChanged(),"none"===o.mode){var h=e._mode||function(e,t,i,n){var a=e.renderStart,r=e.renderEnd,o=Qr(a,n,kt.WM.get()),s=Qr(r,n,kt.WM.get());if((0,_.d)(o,s)<Ea*Ea)return null;var l=(0,_.b)(kt.WM.get(),a,i),c=(0,_.f)(kt.WM.get(),l,(0,fn.mJ)(t)),u=a,h=(0,_.a)(kt.WM.get(),u,c),d=Qr(i,n,kt.WM.get()),p=o,f=Qr(h,n,kt.WM.get()),v=(0,_.b)(kt.WM.get(),f,p),g=(0,_.b)(kt.WM.get(),o,d),y=(0,ce.re)(p,v),m=(0,ce.re)(d,g);return(0,ce.Jk)(y,s)<(0,ce.Jk)(m,s)?"rotate":"scale"}(t,t.plane,o.origin,e.tool.view.state.camera);if((0,u.pC)(h)){switch(h){case"rotate":e.tool.emit("graphic-rotate-start",{graphic:i,angle:0}),e.tool.emit("record-undo",{record:e._adapter.createUndoRecord()});break;case"scale":e.tool.emit("graphic-scale-start",{graphic:i,xScale:1,yScale:1}),e.tool.emit("record-undo",{record:e._adapter.createUndoRecord()})}o.mode=h}}switch(o.mode){case"rotate":r.state.angle=o.initialAngle+a;break;case"scale":r.state.scale=l,e._onScaleChanged()}switch(e._updateDragState(),e._updateManipulatorTransform(),t.action){case"start":case"update":switch(o.mode){case"rotate":e.tool.emit("graphic-rotate",{graphic:i,angle:(0,Ye.BV)(o.angle)});break;case"scale":e.tool.emit("graphic-scale",{graphic:i,xScale:l,yScale:l})}break;case"end":switch(o.mode){case"rotate":e.tool.emit("graphic-rotate-stop",{graphic:i,angle:(0,Ye.BV)(o.angle)});break;case"scale":e.tool.emit("graphic-scale-stop",{graphic:i,xScale:l,yScale:l})}}return"end"===t.action&&(e.startAnimation(Jr(e,(function(){return e._onScaleChanged()}))),e._scaleRotateDragData=null,e._updateDragState(),r.done()),t})).next(e._updateTooltipPipelineStep(o)),a.next((function(){if(r.cancel(),(0,u.pC)(e._scaleRotateDragData)){switch(e._scaleRotateDragData.mode){case"none":break;case"rotate":e.tool.emit("graphic-rotate-stop",{graphic:i,angle:0});break;case"scale":e.tool.emit("graphic-scale-stop",{graphic:i,xScale:1,yScale:1})}e.startAnimation(Jr(e,(function(){return e._onScaleChanged()}))),e._scaleRotateDragData=null,e._updateDragState()}e._updateFocusTooltip()}))}));this._handles.add([n,t.events.on("focus-changed",(function(t){"focus"===t.action?e.startAnimation(function(e,t,i){var n=0,a=null,r=function(){return!1};return{start:function(){a=e.getFocused,e.getFocused=r,n=0,t()},update:function(e){var t;return n+=e,null===(t=a)||void 0===t||!t()||n>=i.delayMs?Yr.STOP:Yr.CONTINUE},destroy:function(){a&&(e.getFocused=a),t()}}}(e,(function(){return e._updateDelayedFocusedState()}),{delayMs:e._ringIndicatorDelayMs})):e._updateDelayedFocusedState()})),t.events.on("immediate-click",(function(e){e.stopPropagation()})),(0,h.YP)((function(){var t;return null===(t=e.tool.graphicState)||void 0===t?void 0:t.displaying}),(function(t){return e._ringManipulator.available=t}),h.nn)])}},{key:"_updateTooltipPipelineStep",value:function(e){var t=this;return function(i){var n=t._tooltipOptions;if(!n.enabled)return i;if("end"===i.action)return t._updateFocusTooltip(),i;var a=t._tooltip,r=t._tooltipOptions.visualVariables,o=(0,u.pC)(r)?r.size:null,s=(0,u.pC)(r)?r.rotation:null;switch(e.mode){case"scale":a.info=new Ur({tooltipOptions:n,scale:{value:t._adapter.scale},size:(0,on.yG)((0,u.Pt)(t._adapter.size,-1),"meters"),sizeUnit:(0,u.pC)(o)?o.unit:null,sizePrecision:(0,u.pC)(o)?Kr(o.valueType):null});break;case"rotate":var l=(0,u.pC)(s)?Kr(s.valueType):null,c=(0,u.pC)(s)?s.rotationType:"geographic";a.info=new Hr({tooltipOptions:n,rotation:(0,on.GJ)((0,u.Pt)(-t._adapter.relativeAngle,0),"radians","geographic"),rotationPrecision:l,orientation:(0,on.GJ)(-t._adapter.angle,"radians","geographic"),orientationPrecision:l,rotationType:c})}return i}}},{key:"_updateFocusTooltip",value:function(){if(this._tooltipOptions.enabled)if(this.getFocused()){var e=this._tooltipOptions.visualVariables,t=(0,u.pC)(e)?e.rotation:null,i=(0,u.pC)(e)?e.size:null;this._tooltip.info=new Xr({tooltipOptions:this._tooltipOptions,orientation:(0,on.GJ)(-this._adapter.angle,"radians","geographic"),orientationEnabled:null==this._mode||"rotate"===this._mode,orientationPrecision:(0,u.pC)(t)?Kr(t.valueType):null,rotationType:(0,u.pC)(t)?t.rotationType:"geographic",size:(0,on.yG)((0,u.Pt)(this._adapter.size,-1),"meters"),sizeUnit:(0,u.pC)(i)?i.unit:null,sizeEnabled:null==this._mode||"scale"===this._mode,sizePrecision:(0,u.pC)(i)?Kr(i.valueType):null})}else this._tooltip.clear()}},{key:"_onScaleChanged",value:function(){this.events.emit("scale-changed"),this._updateManipulatorTransform()}},{key:"_updateDelayedFocusedState",value:function(){this._ringManipulator.updateStateEnabled(Br.DelayedFocused,this.getFocused()),this._updateFocusTooltip()}},{key:"_updateDragState",value:function(){if(this._ringManipulator.updateStateEnabled(Br.Unlocked,!((0,u.pC)(this._scaleRotateDragData)&&"none"!==this._scaleRotateDragData.mode)),(0,u.pC)(this._scaleRotateDragData))switch(this._scaleRotateDragData.mode){case"rotate":this._ringManipulator.updateStateEnabled(Br.ScaleIn|Br.ScaleOut,!1),this._ringManipulator.updateStateEnabled(Br.RotateLeft,this._scaleRotateDragData.angleDir<0),this._ringManipulator.updateStateEnabled(Br.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this._ringManipulator.updateStateEnabled(Br.RotateLeft|Br.RotateRight,!1),this._ringManipulator.updateStateEnabled(Br.ScaleIn,this._scaleRotateDragData.scaleDir<0),this._ringManipulator.updateStateEnabled(Br.ScaleOut,this._scaleRotateDragData.scaleDir>=0)}else this._ringManipulator.updateStateEnabled(Br.ScaleIn|Br.ScaleOut|Br.RotateLeft|Br.RotateRight,!1)}},{key:"_updateManipulatorTransform",value:function(){var e=(0,It.d)(kt.MP.get(),this._adapter.angle,(0,g.f)(0,0,1));if(!(0,u.Wi)(e)){var t=this.getScale(),i=(0,It.E)(kt.MP.get(),(0,_.s)(kt.WM.get(),t,t,t));this._ringManipulator.modelTransform=(0,It.m)(kt.MP.get(),i,e)}}},{key:"_createRingManipulator",value:function(){for(var e=function(e,t,i){for(var n=[],a=Math.ceil(128*(t-e)/(2*Math.PI)),r=0;r<a+1;r++){var o=e+r*(t-e)/a;n.push((0,g.f)(i*Math.cos(o),i*Math.sin(o),0))}return n},t=function(t){return e(0,2*Math.PI,t)},i=this._createMaterial(1),n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;return(0,ot.x2)(n,function(e){return[[-e/2,0],[e/2,0],[e/2,.25],[-e/2,.25]]}(t),e,[],[],!1)},a=t(xa),r=n(a,24),o={left:new Array,right:new Array},s=[],l=0;l<2;l++){var c=l*Math.PI-Math.PI/4,u=Math.PI/2-Ca,h=c+u,d=c+Math.PI/2-u,p=e(h,d,190),f=n(p,9);s.push(p),s.push(e(h,d,201)),o.left.push(f),o.right.push(f.instantiate());for(var v=0;v<2;v++){var _=0===v,m=(0,Vt.c)();if(_){(0,It.k)(m,m,[1,-1,1]),(0,It.e)(m,m,-h,[0,0,1]);var b=Math.round(.2*(p.length-1));m[12]=p[b][0],m[13]=p[b][1],m[14]=p[b][2]}else{(0,It.e)(m,m,d,[0,0,1]);var M=Math.round(.8*(p.length-1));m[12]=p[M][0],m[13]=p[M][1],m[14]=p[M][2]}var w=(0,ot.DA)(i,60,0,23,.5);(0,ot.mx)(w,m),(_?o.left:o.right).push(w)}}for(var x=[],C=0;C<2;C++){var O=C*Math.PI-Math.PI/4,E=Math.PI/2-Oa,k=O+E,A=O+Math.PI/2-E,T=e(k,A,213);x.push(n(T,9))}var P=this._createMaterial(.66),R=this._createMaterial(.5),D=this._createMaterial(.33),Z=t(190),G=t(213),L=n(Z,9,P),I=n(G,9,D),V=t(130),z=t(107),W=n(V,9,P),N=n(z,9,D),j=[new Ln(r,Br.DelayedFocused),new Ln(r.instantiate({material:R}),yn.Q9.None)];this._mode&&"scale"!==this._mode||(j=j.concat([].concat((0,S.Z)(x.map((function(e){return new Ln(e,Br.DelayedFocused|Br.Unlocked)}))),[new Ln(L,Br.DelayedFocused|Br.ScaleIn),new Ln(I,Br.DelayedFocused|Br.ScaleIn),new Ln(W,Br.DelayedFocused|Br.ScaleOut),new Ln(N,Br.DelayedFocused|Br.ScaleOut)]))),this._mode&&"rotate"!==this._mode||(j=j.concat([].concat((0,S.Z)(o.right.map((function(e){return new Ln(e.instantiate(),Br.DelayedFocused|Br.Unlocked)}))),(0,S.Z)(o.left.map((function(e){return new Ln(e,Br.DelayedFocused|Br.RotateLeft)}))),(0,S.Z)(o.right.map((function(e){return new Ln(e,Br.DelayedFocused|Br.RotateRight)}))))));var F=[a].concat(s);return new bn({view:this.tool.view,renderObjects:j,autoScaleRenderObjects:!1,worldOriented:!0,radius:24,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:(0,y.RL)(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:F,direction:(0,g.f)(0,0,1)}})}},{key:"_createMaterial",value:function(e){var t=(0,Ot.b)([].concat((0,S.Z)(Ma),[e]));return new Nt.E({color:t,transparent:1!==e,cullFace:ki.Vr.Back,renderOccluded:st.yD.Transparent})}},{key:"test",get:function(){var e=this;return{ringManipulator:this._ringManipulator,setRingIndicatorDelayMs:function(t){return e._ringIndicatorDelayMs=t},tooltip:this._tooltip}}}]),e}();function Qr(e,t,i){return t.projectToScreen(e,$r),(0,_.s)(i,$r[0],$r[1],0)}function Jr(e,t){var i=null,n=1,a=function(){return n};return{start:function(){n=e.getScale(),i=e.getScale,e.getScale=a,t()},update:function(e){return n+=((n+1)/2-n)*Math.min(e*ka,1),t(),Math.abs(n-1)<.01?Yr.STOP:Yr.CONTINUE},destroy:function(){i&&(e.getScale=i),t()}}}function Kr(e){switch(e){case"integer":case"long":return 0;default:return null}}!function(e){e[e.CONTINUE=0]="CONTINUE",e[e.STOP=1]="STOP"}(Yr||(Yr={}));var $r=(0,b.s1)(),eo=i(45238);function to(e){return(0,u.pC)(e.geometry)&&"mesh"===e.geometry.type?function(e){return(0,u.pC)(e.transform)?function(e,t){var i=t.clone(),n=null;return{undo:function(t){n=(0,u.pC)(e.transform)?e.transform.clone():null,e.transform=i,t.notifyGeometryChanged()},redo:function(t){i=(0,u.pC)(e.transform)?e.transform.clone():null,e.transform=n,t.notifyGeometryChanged()}}}(e,e.transform):function(e){var t,i=e.vertexAttributes.clonePositional();return{undo:function(n){t=e.vertexAttributes.clonePositional(),e.vertexAttributes=i,n.notifyGeometryChanged()},redo:function(n){i=e.vertexAttributes.clonePositional(),e.vertexAttributes=t,n.notifyGeometryChanged()}}}(e)}(e.geometry):function(e){var t=e.geometry,i=u.YP;return{undo:function(e){i=e.geometry,e.geometry=t},redo:function(e){t=e.geometry,e.geometry=i}}}(e)}var io=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._interactionState=null,n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,h.gx)((function(){return(0,u.pC)(e._interactionState)&&e._interactionState.angle!==e._interactionState.previousAngle?{interactionState:e._interactionState,angle:e._interactionState.state.angle}:null}),(function(t){var i=t.interactionState;e._updateMeshRotation(i)}),h.Z_),(0,h.gx)((function(){return(0,u.pC)(e._interactionState)&&e._interactionState.scale!==e._interactionState.previousScale?{interactionState:e._interactionState,scale:e._interactionState.state.scale}:null}),(function(t){var i=t.interactionState;e._updateMeshSize(i)}),h.Z_)])}},{key:"angle",get:function(){var e=this.geometry.transform;if((0,u.Wi)(e))return 0;var t=(0,eo.ZZ)(e.rotation)[2];return Math.abs(t)>.999999?(0,Ye.Vl)((0,eo.EU)(e.rotation))*Math.sign(t):0}},{key:"scale",get:function(){return(0,u.pC)(this._interactionState)?this._interactionState.scale:1}},{key:"startInteraction",value:function(){var e=this,t=new no({angle:this.angle});this._interactionState=t;var i=function(){e._interactionState=null};return{state:t,done:i,cancel:function(){t.cancel(),i()}}}},{key:"createUndoRecord",value:function(){return to(this.graphic)}},{key:"_updateMeshRotation",value:function(e){var t=this.geometry.anchor,i=this.viewingMode===we.JY.Global,n=e.angle,a=e.previousAngle;this.geometry.rotate(0,0,(0,Ye.BV)(n-a),{origin:t,geographic:i}),e.previousAngle=n,(0,u.pC)(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged()}},{key:"_updateMeshSize",value:function(e){var t=this.geometry.anchor,i=this.viewingMode===we.JY.Global,n=e.scale,a=e.previousScale;this.geometry.scale(n/a,{origin:t,geographic:i}),e.previousScale=n,(0,u.pC)(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged()}}]),i}(rn.r);(0,l._)([(0,d.Cb)({constructOnly:!0})],io.prototype,"graphic",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],io.prototype,"geometry",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],io.prototype,"viewingMode",void 0),(0,l._)([(0,d.Cb)()],io.prototype,"angle",null),(0,l._)([(0,d.Cb)()],io.prototype,"scale",null),(0,l._)([(0,d.Cb)()],io.prototype,"_interactionState",void 0),io=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],io);var no=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).angle=0,n.initialAngle=0,n.previousAngle=0,n.previousScale=1,n.scale=1,n.initialAngle=e.angle,n.previousAngle=e.angle,n}return(0,r.Z)(i,[{key:"state",get:function(){return{angle:this.angle,scale:this.scale}}},{key:"cancel",value:function(){this.angle=this.initialAngle,this.scale=1}}]),i}(C.Z);(0,l._)([(0,d.Cb)()],no.prototype,"angle",void 0),(0,l._)([(0,d.Cb)()],no.prototype,"initialAngle",void 0),(0,l._)([(0,d.Cb)()],no.prototype,"previousAngle",void 0),(0,l._)([(0,d.Cb)()],no.prototype,"previousScale",void 0),(0,l._)([(0,d.Cb)()],no.prototype,"scale",void 0),(0,l._)([(0,d.Cb)()],no.prototype,"state",null),no=(0,l._)([(0,v.j)("InteractionState")],no);var ao=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).sizeAxis=null,n._interactionState=null,n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles((0,h.gx)((function(){return(0,u.pC)(e._interactionState)?e._interactionState.state:null}),(function(t){e._updateSymbol(t)}),h.Z_))}},{key:"angle",get:function(){var e;return(0,u.pC)(this._interactionState)?this._interactionState.angle:(0,u.pC)(this._orientationReferenceSymbolLayer)?function(e){return-(0,Ye.Vl)(e)}(null!==(e=this._orientationReferenceSymbolLayer.heading)&&void 0!==e?e:0):0}},{key:"scale",get:function(){return(0,u.pC)(this._interactionState)?this._interactionState.scale:1}},{key:"relativeAngle",get:function(){return this.angle-this.initialAngle}},{key:"initialAngle",get:function(){return(0,u.pC)(this._interactionState)?this._interactionState.initialAngle:0}},{key:"size",get:function(){var e=this._sizeReferenceSymbolLayer;if((0,u.Wi)(e))return null;var t=this.findLayerView(),i=this._graphicSymbol;if((0,u.Wi)(t)||(0,u.Wi)(i)||"point-3d"!==i.type)return null;var n=t.getSymbolLayerSize(i,e);if("size"in n&&(0,u.pC)(n.size))return n.size;var a=this.sizeAxis;return"width"in n&&(0,u.pC)(n.width)&&((0,u.Wi)(a)||"width"===a||"all"===a||"width-and-depth"===a)?n.width:"depth"in n&&(0,u.pC)(e.depth)&&((0,u.Wi)(a)||"depth"===a||"all"===a||"width-and-depth"===a)?n.depth:"height"in n&&(0,u.pC)(e.height)&&((0,u.Wi)(a)||"height"===a||"all"===a)?n.height:null}},{key:"_sizeReferenceSymbolLayer",get:function(){var e=this._graphicSymbol;return(0,u.Wi)(e)||0===e.symbolLayers.length?null:e.symbolLayers.find((function(e){return"object"===e.type}))}},{key:"_orientationReferenceSymbolLayer",get:function(){var e=this._graphicSymbol;return(0,u.Wi)(e)||0===e.symbolLayers.length?null:e.symbolLayers.find((function(e){return"object"===e.type&&(0,u.pC)(e.heading)}))}},{key:"_graphicSymbol",get:function(){return(0,u.pC)(this.graphic)&&(0,u.pC)(this.graphic.symbol)&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null},set:function(e){this.graphic.symbol=e}},{key:"startInteraction",value:function(){var e=this,t=this._graphicSymbol,i=this.findLayerView();if((0,u.pC)(this._interactionState)||(0,u.Wi)(t)||(0,u.Wi)(i))return ro;var n=t.symbolLayers.map((function(e){return"object"===e.type?i.getSymbolLayerSize(t,e):null})).toArray(),a=t.clone(),r=this.angle,o=new oo({originalSymbol:a,angle:r,initialSizes:n});this._interactionState=o;var s=function(){e._interactionState=null};return{state:o,done:s,cancel:function(){e._graphicSymbol=a,s()}}}},{key:"createUndoRecord",value:function(){var e=this.graphic.symbol,t=null;return{undo:function(i){t=i.symbol,i.symbol=e},redo:function(i){e=i.symbol,i.symbol=t}}}},{key:"_updateSymbol",value:function(e){var t=this,i=e.scale,n=e.angle,a=e.originalSymbol,r=e.initialSizes,o=this._graphicSymbol;if(!(0,u.Wi)(o)&&"point-3d"===o.type){var s=o.clone(),l=-(0,Ye.BV)(n-this.initialAngle),c=!1;this._forEachObjectSymbolLayerPair(a,s,(function(e,n,a){var o=(0,u.Pt)(e.heading,0)+l;n.heading!==o&&(n.heading=o,c=!0);var s=r[a];if((0,u.pC)(s)&&"width"in s){s.width=t.sizeFilter(s.width),s.height=t.sizeFilter(s.height),s.depth=t.sizeFilter(s.depth);var h=s.width*i;n.width!==h&&(n.width=h,c=!0);var d=s.depth*i;n.depth!==d&&(n.depth=d,c=!0);var p=s.height*i;n.height!==p&&(n.height=p,c=!0)}})),c&&(this._graphicSymbol=s)}}},{key:"_forEachObjectSymbolLayerPair",value:function(e,t,i){e.symbolLayers.forEach((function(e,n){var a=t.symbolLayers.getItemAt(n);"object"===e.type&&"object"===a.type&&i(e,a,n)}))}}]),i}(rn.r);(0,l._)([(0,d.Cb)()],ao.prototype,"angle",null),(0,l._)([(0,d.Cb)()],ao.prototype,"scale",null),(0,l._)([(0,d.Cb)()],ao.prototype,"relativeAngle",null),(0,l._)([(0,d.Cb)()],ao.prototype,"initialAngle",null),(0,l._)([(0,d.Cb)()],ao.prototype,"size",null),(0,l._)([(0,d.Cb)()],ao.prototype,"sizeAxis",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],ao.prototype,"graphic",void 0),(0,l._)([(0,d.Cb)()],ao.prototype,"_interactionState",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],ao.prototype,"findLayerView",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0})],ao.prototype,"sizeFilter",void 0),(0,l._)([(0,d.Cb)()],ao.prototype,"_sizeReferenceSymbolLayer",null),(0,l._)([(0,d.Cb)()],ao.prototype,"_orientationReferenceSymbolLayer",null),(0,l._)([(0,d.Cb)()],ao.prototype,"_graphicSymbol",null),ao=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],ao);var ro={state:{angle:0,scale:0},done:function(){},cancel:function(){}},oo=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).angle=0,n.initialAngle=0,n.scale=1,n.initialAngle=e.angle,n}return(0,r.Z)(i,[{key:"state",get:function(){return{originalSymbol:this.originalSymbol,angle:this.angle,initialAngle:this.initialAngle,scale:this.scale,initialSizes:this.initialSizes}}}]),i}(C.Z);(0,l._)([(0,d.Cb)()],oo.prototype,"originalSymbol",void 0),(0,l._)([(0,d.Cb)()],oo.prototype,"angle",void 0),(0,l._)([(0,d.Cb)()],oo.prototype,"initialAngle",void 0),(0,l._)([(0,d.Cb)()],oo.prototype,"initialSizes",void 0),(0,l._)([(0,d.Cb)()],oo.prototype,"scale",void 0),(0,l._)([(0,d.Cb)()],oo.prototype,"state",null),oo=(0,l._)([(0,v.j)("InteractionState")],oo);var so=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).enableZ=!0,n.enableRotation=!0,n.enableScaling=!0,n.tooltipOptions=new or.Z,n.type="transform-3d",n._scaleRotate=null,n._tooltip=null,n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this,t=this.graphic,i=this.view;this.graphicState=new Qi({graphic:t}),this.addHandles((0,h.YP)((function(){return e.tooltipOptions.enabled}),(function(t){e._tooltip=t?new cr.u({view:i}):(0,u.SC)(e._tooltip)}),h.tX)),this._moveManipulation=new $a({tool:this,view:i,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&ca(t),radius:$a.radiusForSymbol(t.symbol)}),this._moveManipulation.forEachManipulator((function(i){return e.handles.add(i.events.on("immediate-click",(function(i){e.emit("immediate-click",(0,n.Z)((0,n.Z)({},i),{},{graphic:t})),i.stopPropagation()})))}));var a=function(t){return function(i){e.handles.add(i.events.on("focus-changed",(function(i){var n=i.action,a=e._tooltip;(0,u.Wi)(a)||("focus"===n?e._updateMoveTooltip(t):a.clear())})))}};this._moveManipulation.xyManipulation.forEachManipulator(a(Ua.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(a(Ua.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(a(Ua.Z));var r=(0,y.RL)(t);this._moveManipulation.elevationInfo=r;var o=t.geometry;if(this._moveManipulation.createGraphicDragPipeline((function(n,a,s,l,c){if((0,u.pC)(o)&&n===Ua.XY){var h,d=(0,lr.W)({snappingContext:new sr.N({elevationInfo:r,pointer:c,editGeometryOperations:rr.c.fromGeometry(new mn.Z({spatialReference:o.spatialReference}),i.state.viewingMode),visualizer:new Jt,excludeFeature:t}),snappingManager:e.snappingManager,updatingHandles:e.updatingHandles,useZ:!1}),p=d.snappingStep,f=d.cancelSnapping;l=l.next(f),s=(h=s.next((0,Ra.Mz)(e.view,r))).next.apply(h,(0,S.Z)(p))}return{steps:s=s.next((function(t){return e._updateMoveTooltip(n,t),t})),cancel:l}}),this.graphicState,(function(t){var i=t.action,n={graphic:t.graphic,dxScreen:t.dxScreen,dyScreen:t.dyScreen};switch(i){case"start":e.emit("graphic-translate-start",n),e.emit("record-undo",{record:e._createGeometryUndoRecord()});break;case"update":e.emit("graphic-translate",n);break;case"end":e.emit("graphic-translate-stop",n)}})),this._moveManipulation.angle=(0,u.pC)(this._scaleRotate)?this._scaleRotate.angle:0,this._scaleRotateAdapter=this._createScaleRotateAdapter(),this.handles.add((0,h.YP)((function(){return e._scaleRotateAdapter.angle}),(function(){return e._updateMoveAngle()}))),this.enableScaling||this.enableRotation){var s=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this._scaleRotate=new qr({tool:this,mode:s,adapter:this._scaleRotateAdapter,tooltipOptions:this.tooltipOptions}),this.handles.add(this._scaleRotate.events.on("scale-changed",(function(){return e._onScaleChanged()})))}this.handles.add([ma({view:this.view,graphic:this.graphic,forEachManipulator:function(t){return e._forEachManipulator(t)},onManipulatorsChanged:function(){return(0,c.kB)()}}),this.graphicState.on("changed",(function(){return e._onGeometryChanged()})),this._hideManipulatorsForGraphicState(),(0,h.YP)((function(){return i.scale}),(function(){return e._updateMoveAngle()}))]),this.handles.add(this.view.trackGraphicState(this.graphicState)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((function(t){t instanceof bn&&e.handles.add(t.events.on("grab-changed",(function(){return e._updateManipulatorsInteractive()})))})),this.finishToolCreation()}},{key:"destroy",value:function(){this._tooltip=(0,u.SC)(this._tooltip),this._moveManipulation.destroy(),this._scaleRotate=(0,u.SC)(this._scaleRotate),this._scaleRotateAdapter=(0,u.SC)(this._scaleRotateAdapter),this._set("view",null),this._set("graphic",null)}},{key:"_updateManipulatorsInteractive",value:function(){(0,u.Wi)(this._scaleRotate)||(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}},{key:"_createScaleRotateAdapter",value:function(){var e=this;return(0,u.pC)(this.graphic.geometry)&&"mesh"===this.graphic.geometry.type?new io({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):new ao({graphic:this.graphic,sizeFilter:function(t){return e._enforceNonZeroSize(t)},findLayerView:function(){return e.view.allLayerViews.find((function(t){return t.layer===e.graphic.layer}))},sizeAxis:(0,u.pC)(this.tooltipOptions.visualVariables)&&(0,u.pC)(this.tooltipOptions.visualVariables.size)?this.tooltipOptions.visualVariables.size.axis:null})}},{key:"_forEachManipulator",value:function(e){this._moveManipulation.forEachManipulator(e),(0,u.pC)(this._scaleRotate)&&this._scaleRotate.forEachManipulator(e)}},{key:"_hideManipulatorsForGraphicState",value:function(){var e=this;return(0,h.YP)((function(){return e.graphicState.displaying}),(function(t){e._forEachManipulator((function(e){return e.available=t})),e._moveManipulation.zManipulation.available=t&&e.enableZ&&ca(e.graphic)}))}},{key:"_createGeometryUndoRecord",value:function(){return to(this.graphic)}},{key:"snapToScene",set:function(e){this._moveManipulation&&(this._moveManipulation.snapToScene=e),this._set("snapToScene",e)}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"location",set:function(e){this._moveManipulation.location=e,(0,u.pC)(this._scaleRotate)&&(this._scaleRotate.location=e)}},{key:"elevationAlignedLocation",set:function(e){this._moveManipulation.elevationAlignedLocation=e,(0,u.pC)(this._scaleRotate)&&(this._scaleRotate.elevationAlignedLocation=e)}},{key:"reset",value:function(){}},{key:"onHide",value:function(){(0,u.pC)(this._scaleRotate)&&this._scaleRotate.cancelActiveAnimation()}},{key:"_onScaleChanged",value:function(){if(!(0,u.Wi)(this._scaleRotate)){var e=this._scaleRotate.getScale();this._moveManipulation.displayScale=e}}},{key:"_updateMoveAngle",value:function(){this.view.state.viewingMode===we.JY.Local||this.view.scale<1e6?this._moveManipulation.angle=this._scaleRotateAdapter.angle:this._moveManipulation.angle=0}},{key:"_onGeometryChanged",value:function(){ra(this.view,this,this.graphic)}},{key:"_enforceNonZeroSize",value:function(e){return e||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}},{key:"_updateMoveTooltip",value:function(e,t){var i=this.tooltipOptions,n=this._tooltip;if(!(0,u.Wi)(n)){n.clear();var a=this.graphicState.isDraped?"on-the-ground":"absolute-height";switch(e){case Ua.XY:n.info=new ur.$E({tooltipOptions:i}),this._updateMoveTooltipDistance(n.info,t,(function(e,t){return(0,U.GQ)(e,t,a)}));break;case Ua.XY_AXIS:n.info=new ur.in({tooltipOptions:i}),this._updateMoveTooltipDistance(n.info,t,(function(e,i){var n=(0,U.GQ)(e,i,a);return(0,on.bA)(n,Ha(t))}));break;case Ua.Z:n.info=new ur.QW({tooltipOptions:i}),this._updateMoveTooltipDistance(n.info,t,hr._e)}}}},{key:"_updateMoveTooltipDistance",value:function(e,t,i){if((0,u.pC)(t)&&"end"!==t.action){var n=i(t.mapStart,t.mapEnd);e.distance=(0,u.pC)(n)?n:on.yP}}},{key:"test",get:function(){var e=this;return{discManipulator:this._moveManipulation.xyManipulation.test.discManipulator,zManipulator:this._moveManipulation.zManipulation.test.manipulator,ringManipulator:(0,u.pC)(this._scaleRotate)?this._scaleRotate.test.ringManipulator:null,arrowManipulators:this._moveManipulation.xyAxisManipulation.test.arrowManipulators,setRingIndicatorDelayMs:function(t){return(0,u.pC)(e._scaleRotate)?e._scaleRotate.test.setRingIndicatorDelayMs(t):null},scaleRotateAdapter:this._scaleRotateAdapter,scaleRotateTransform:this._scaleRotate,tooltip:this._tooltip}}}]),i}((0,rn.p)(bi.Z.EventedMixin(ar.m)));(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],so.prototype,"view",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],so.prototype,"graphic",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],so.prototype,"enableZ",void 0),(0,l._)([(0,d.Cb)()],so.prototype,"enableRotation",void 0),(0,l._)([(0,d.Cb)()],so.prototype,"enableScaling",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,type:or.Z})],so.prototype,"tooltipOptions",void 0),(0,l._)([(0,d.Cb)()],so.prototype,"graphicState",void 0),(0,l._)([(0,d.Cb)({value:!1})],so.prototype,"snapToScene",null),(0,l._)([(0,d.Cb)({constructOnly:!0})],so.prototype,"snappingManager",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],so.prototype,"type",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],so.prototype,"updating",null),so=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],so);var lo=i(82218),co=i(11582),uo=i(46784),ho=i(89125),po=i(96866),fo=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="plane",n.position=null,n.heading=0,n.tilt=0,n.width=10,n.height=10,n}return(0,r.Z)(i,[{key:"equals",value:function(e){return this.heading===e.heading&&this.tilt===e.tilt&&(0,u._W)(this.position,e.position)&&this.width===e.width&&this.height===e.height}}]),i}((0,co.J)(uo.wq));(0,l._)([(0,d.Cb)({readOnly:!0,json:{read:!1,write:!0}})],fo.prototype,"type",void 0),(0,l._)([(0,d.Cb)({type:mn.Z}),(0,po.B)()],fo.prototype,"position",void 0),(0,l._)([(0,d.Cb)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,po.B)(),(0,ho.p)((function(e){return jr.BV.normalize((0,p.q9)(e),0,!0)}))],fo.prototype,"heading",void 0),(0,l._)([(0,d.Cb)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,po.B)(),(0,ho.p)((function(e){return jr.BV.normalize((0,p.q9)(e),0,!0)}))],fo.prototype,"tilt",void 0),(0,l._)([(0,d.Cb)({type:Number,nonNullable:!0}),(0,po.B)()],fo.prototype,"width",void 0),(0,l._)([(0,d.Cb)({type:Number,nonNullable:!0}),(0,po.B)()],fo.prototype,"height",void 0),fo=(0,l._)([(0,v.j)("esri.analysis.SlicePlane")],fo);var vo=i(48976),_o=(i(14320),(0,M.Z)("mac"),2),go=1.15,yo=1.15,mo=(Math.cos((0,Ye.Vl)(45)),Math.cos((0,Ye.Vl)(5)),(0,g.f)(1,.5,0)),bo=((0,Ot.b)([].concat((0,S.Z)(mo),[.7])),(0,Ot.b)([].concat((0,S.Z)(mo),[.5])),(0,Ot.f)(1,1,1,1)),Mo=(0,Ot.f)(1,.8,.6,1),So=(0,Ot.f)(1,.93,.86,1),wo=(0,Ot.b)([].concat((0,S.Z)(mo),[1])),xo=(0,Ot.b)([].concat((0,S.Z)(mo),[1])),Co=3,Oo=11,Eo=22.5,ko=40,Ao=48,To=2.25,Po=(0,Ot.b)([].concat((0,S.Z)(mo),[1])),Ro=4,Do=1,Zo=.3,Go=6,Lo=4;(0,Vt.c)();var Io=i(11316),Vo=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).backgroundColor=(0,Ot.f)(1,0,0,.5),e.gridColor=(0,Ot.f)(0,1,0,.5),e.gridWidth=4,e}return(0,r.Z)(i)}(Xe.K),zo=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,r.Z)(i,[{key:"initializeProgram",value:function(e){return new Pe.$(e.rctx,i.shader.get().build(this.configuration),qe.i)}},{key:"initializePipeline",value:function(){return(0,Ze.sm)({blending:(0,Ze.wK)(De.zi.ONE,De.zi.ONE,De.zi.ONE_MINUS_SRC_ALPHA,De.zi.ONE_MINUS_SRC_ALPHA),depthTest:{func:De.wb.LESS},colorWrite:Ze.BK})}}]),i}(Te.A);zo.shader=new Ae.J(Io.S,(function(){return i.e(8492).then(i.bind(i,18492))}));Nn.c;var Wo=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).ensureTechnique(zo,null),n}return(0,r.Z)(i,[{key:"beginSlot",value:function(){return(0,u.Wg)(this.technique)}}]),i}(Pi.Z),No=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).renderOccluded=st.yD.Occlude,e}return(0,r.Z)(i)}(Vo);i(29691),i(23470);Math.pow(2,50);(0,g.c)();(0,g.c)(),i(72619);var jo;i(53866);function Fo(e,t){switch(t){case jo.POSITIVE_X:return{basis:e.basis1,direction:1,position:(0,_.a)(kt.WM.get(),e.origin,e.basis1),edge:t};case jo.POSITIVE_Y:return{basis:e.basis2,direction:1,position:(0,_.a)(kt.WM.get(),e.origin,e.basis2),edge:t};case jo.NEGATIVE_X:return{basis:e.basis1,direction:-1,position:(0,_.b)(kt.WM.get(),e.origin,e.basis1),edge:t};case jo.NEGATIVE_Y:return{basis:e.basis2,direction:-1,position:(0,_.b)(kt.WM.get(),e.origin,e.basis2),edge:t}}}function Ho(e){var t=(0,_.l)(e.basis1),i=(0,_.l)(e.basis2);return Zo*Math.min(t,i)}function Uo(e){return Ho(e)}function Bo(e){return 0!==e.direction[0]&&0!==e.direction[1]}function Yo(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:$o.CENTER_ON_ARROW)===$o.CENTER_ON_CALLOUT?ko:0,i=[(0,g.f)(t,0,-Ao/2),(0,g.f)(t,0,Ao/2)],n=function(e,t){var i=(0,_.b)((0,g.c)(),e[e.length-1],e[e.length-2]);if((0,_.n)(i,i),(0,_.g)(i,i,Eo),(0,_.a)(i,i,e[e.length-1]),t){var n=(0,_.b)((0,g.c)(),e[0],e[1]);return(0,_.n)(n,n),(0,_.g)(n,n,Eo),(0,_.a)(n,n,e[0]),[n].concat((0,S.Z)(e),[i])}return[].concat((0,S.Z)(e),[i])}(i,!0),a=function(e,t){return function(e,t,i){var n=new Nt.E({color:bo,cullFace:ki.Vr.Back,renderOccluded:st.yD.Opaque}),a=new Nt.E({color:Mo,cullFace:ki.Vr.Back,renderOccluded:st.yD.Opaque}),r=new Nt.E({color:So,cullFace:ki.Vr.Back,renderOccluded:st.yD.Opaque}),o=new Nt.E({color:xo,transparent:!0,writeDepth:!1,cullFace:ki.Vr.Front,renderOccluded:st.yD.Transparent}),s=function(s){e=e.slice(0);var l=(0,_.b)(kt.WM.get(),e[0],e[1]);(0,_.n)(l,l);var c=(0,_.b)(kt.WM.get(),e[e.length-1],e[e.length-2]);if((0,_.n)(c,c),t>0){var u=(0,_.g)((0,g.c)(),c,-t);e[e.length-1]=(0,_.a)(u,u,e[e.length-1]);var h=(0,_.g)((0,g.c)(),l,-t);e[0]=(0,_.a)(h,h,e[0])}var d=s?yo:1,p=Eo*d,f=Oo*d,v=(0,It.i)(kt.MP.get());if(t>0){var y=p/4,m=(0,_.s)(kt.WM.get(),0,y,0),b=1+t/y;(0,It.w)(v,v,m),(0,It.k)(v,v,(0,_.s)(kt.WM.get(),b,b,b)),(0,It.w)(v,v,(0,_.g)(m,m,-1/b))}var M=(0,It.i)((0,Vt.c)()),S=(0,g.f)(0,1,0),w=(0,It.F)((0,Vt.c)(),(0,vo.r)(kt.vD.get(),S,c));w[12]=e[e.length-1][0],w[13]=e[e.length-1][1],w[14]=e[e.length-1][2],(0,It.m)(w,w,v);var x=function(e,t,i){for(var n=[],a=12,r=0;r<a;r++){var o=r/a*2*Math.PI;n.push([Math.cos(o)*e,Math.sin(o)*e])}return(0,ot.x2)(i,n,t,[],[],!1)}(Co*(s?go:1)+t,e,i?o:r);x.transformation=M;var C=[x],O=(0,ot.QL)(i?o:n,p,f,24,!1,!1,!0);O.transformation=w,C.push(O);var E=(0,ot.QL)(i?o:a,p,f,24,!1,!0,!1);E.transformation=w,C.push(E);var k=(0,It.F)((0,Vt.c)(),(0,vo.r)(kt.vD.get(),S,l));return k[12]=e[0][0],k[13]=e[0][1],k[14]=e[0][2],(0,It.m)(k,k,v),C.push(O.instantiate({transformation:k})),C.push(E.instantiate({transformation:k})),C};return{normal:s(!1),focused:s(!0)}}(i,e,t)},r=a(0,!1),o=a(To,!0),s=new Qn.Y({color:wo,renderOccluded:st.yD.OccludeAndTransparent}),l=(0,ot.rh)(s,[[t,0,0],[t-ko,0,0]]),c=(0,ot.rh)(s,[[t,0,0],[t-ko,0,0]]);return new bn({view:e,renderObjects:[].concat((0,S.Z)(r.normal.map((function(e){return new Ln(e,yn.Q9.Unfocused|Ko)}))),(0,S.Z)(o.normal.map((function(e){return new Ln(e,yn.Q9.Unfocused|Ko)}))),[new Ln(l,yn.Q9.Unfocused|Ko|es)],(0,S.Z)(r.focused.map((function(e){return new Ln(e,yn.Q9.Focused|Ko)}))),(0,S.Z)(o.focused.map((function(e){return new Ln(e,yn.Q9.Focused|Ko)}))),[new Ln(c,yn.Q9.Focused|Ko|es)]),autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[n]},collisionPriority:1,radius:Oo,state:Ko})}function Xo(e,t){var i=Bo(t),a=i?[(0,g.f)(1,0,0),(0,g.f)(0,0,0),(0,g.f)(0,1,0)]:[(0,g.f)(1,0,0),(0,g.f)(-1,0,0)],r=Po,o=i?Ro:Do,s=o*_o,l=Do,c=function(e){return e>1?function(e){return new ct.U({color:r,width:e,renderOccluded:st.yD.OccludeAndTransparent})}(e):new Qn.Y({color:r,renderOccluded:st.yD.OccludeAndTransparent})},u=[new Ln((0,ot.rh)(c(o),a),yn.Q9.Unfocused|is),new Ln((0,ot.rh)(c(s),a),yn.Q9.Focused|is),new Ln((0,ot.rh)(c(l),a),ns)],h=new bn((0,n.Z)({view:e,renderObjects:u,collisionType:{type:"line",paths:[a]},radius:i?Go:Lo},ta));return h.state=is,h}function qo(e,t){return(0,Pa.cp)(t,e.basis2,e.basis1)+ts}!function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.POSITIVE_Y=1]="POSITIVE_Y",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.NEGATIVE_Y=3]="NEGATIVE_Y"}(jo||(jo={}));var Qo,Jo,Ko=yn.jg.Custom1;!function(e){e[e.HEADING=1]="HEADING",e[e.TILT=2]="TILT"}(Qo||(Qo={})),function(e){e[e.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.TILTED=3]="TILTED"}(Jo||(Jo={}));var $o,es=yn.jg.Custom2,ts=((0,ce.Ue)(),Math.PI/2),is=yn.jg.Custom1,ns=yn.jg.Custom2;!function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"}($o||($o={}));var as="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAnFBMVEUAAAD/gAD/gAD/cAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fAD/gAD/fAD/fQD/fQD/fQD/fQD/fQD/fgD/jR7/mjn/mjf/p1H/plH/smf/sWb/vHr/u3n/xYz/xIv/zZz/zJv/zJr/1Kv/1Kr/06r/06n/27n/27f/4cX/4cT/59D/7dr/8uX/9u7/+/f////u2EN0AAAAM3RSTlMACBAQICAoKDAwODhAQEhIUFBYYGhweICIkJCXmJ+gp6ivsLe4uL+/wMDHx8/P19/n7/cWvjXwAAACeUlEQVR42tWX3XqiMBCGY2pbtbrUnzhhdak/lHWliJD7v7fdJ+KG5AMhh30P8zCTmS+TycDaeBoHi5Wgf4jVYvbKmRfPgSAHMX9mPRnM1tSIGHM/c2QddLp4c8wxCvYIvqROBPfbHlm/sRYC6smMNTKn3sxZAyvyYNW1v38MM/IkcPQnZHPMLtciz9P9hhqwzoLD+cnfpTIUaYinyZlBkE2YKZcMXCyN/YhsPkuFlMfWJLiwo89VMxfpJDForMCwuG+Zx7ttGO2S/w4LJ42ZURDty5M0a4dqsZAQAihQfXqWdlhnpcmdEPAI0tv2EbnsbsKmdgi6/1GN7T1XJLx5sF0P9SWABMC+co5JBE4Ge/1NTM3EGIJgjFONXCdAbeQYwhN7pRrRV20LJNIhWOczdu+xPFzIBiQ62iIsyIOTvlZUY+HXySLQaMUEeSC1CPYxENIlwk+q8e0clFAIfiKG+qpaIvod4wfU8sqvkDLda+xCCqgDaAk7uyeNqD+feFlfGCcg3Hzsk+xS7Nz1Aq4CcauhhMc0uxaqIgcFsF0J+1WQyoCN7Y9ezeCVH5LhSxmyRvsihKbK1m7LafpSpkpj6yJgtsiVBh6AX5UyCVmMbrNpcwj5/h6DPN79JjAiQAhXVeN6SZI0q5bQnn4wBiHEqpUybp1ZJzWxStVCHhKhAhVLp/Emh6trHpGLaB6yZHk7wu3Z+ChOxhwUNEmYYjpUvqJDksSHraQmJm2DdqQK6sGUObybYtpSN+8Phm3pN2xjDH33R6b0CKxAZNLvl8foD3BBnSw5e8RI+G2P8GD9wHw6YN3wkfA0R4Zz8CGCIfOCv8zM738walXuLw6nXBvPr8wvAAAAAElFTkSuQmCC",rs={mipmap:!0,preMultiplyAlpha:!0,width:64,height:64};var os=function(){function e(){(0,a.Z)(this,e),this._lastDragEvent=null,this._next=null,this._enabled=!1}return(0,r.Z)(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){if(this._enabled!==e&&(0,u.pC)(this._lastDragEvent)&&(0,u.pC)(this._next)){var t=(0,n.Z)((0,n.Z)({},this._lastDragEvent),{},{action:"update"});e&&this._adjustScaleFactors(t),this._next.execute(t)}this._enabled=e}},{key:"createDragEventPipelineStep",value:function(){var e=this;this._lastDragEvent=null;var t=new Ra.hM;return this._next=t,[function(t){return e._lastDragEvent="end"!==t.action?(0,n.Z)({},t):null,e._enabled&&e._adjustScaleFactors(t),t},t]}},{key:"_adjustScaleFactors",value:function(e){var t=Bo(e.handle)?Math.max(Math.abs(e.factor1),Math.abs(e.factor2)):0===e.handle.direction[0]?Math.abs(e.factor2):Math.abs(e.factor1);e.factor1=e.factor1<0?-t:t,e.factor2=e.factor2<0?-t:t}},{key:"test",get:function(){var e=this;return{_adjustScaleFactors:function(t){return e._adjustScaleFactors(t)}}}}]),e}(),ss=i(34778),ls=i(92583),cs=i(7068),us=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).enableZ=!0,n.enableRotation=!0,n.enableScaling=!0,n.tooltipOptions=new or.Z,n._preserveAspectRatio=new os,n.grabbing=!1,n.inputState=null,n.type="transform-3d",n._handles=new Aa.Z,n._attachmentOrigin=null,n._outlineVisualElement=null,n._mapBounds=(0,lo.a)(),n._mapBoundsStart=(0,lo.a)(),n._zmax=0,n._sizeStart=null,n._displayBounds=(0,lo.a)(),n._displayBoundsStart=(0,lo.a)(),n._displayBoundsMarginStart=0,n._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],n._moveXYTooltipInfo=null,n._moveZTooltipInfo=null,n._rotateTooltipInfo=null,n._scaleTooltipInfo=null,n._startAngle=0,n._endAngle=0,n._startScale=(0,T.a)(),n._endScale=(0,T.a)(),n}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this,t=this.view,i=this.graphic,a=this.manipulators,r=this._handles,o=this._graphicState=new Qi({graphic:i}),s=i.geometry;this._editGeometryOperations=rr.c.fromGeometry(s,t.state.viewingMode),this._graphicMoveManipulation=new ir({tool:this,view:t,graphicState:o}),this._moveZManipulator=Yo(t,$o.CENTER_ON_CALLOUT),this._moveZManipulator.state|=es,r.add([this._createMoveXYGraphicDragPipeline(),(0,h.YP)((function(){return e.enableZ}),(function(){return e._updateManipulatorAvailability(e._moveZManipulator,sa.TRANSLATE_Z)})),this._createMoveZDragPipeline()]),a.add(this._moveZManipulator),this._resizeManipulators=this._resizeHandles.map((function(i){var n=Xo(t,i);return r.add([(0,h.YP)((function(){return e.enableScaling}),(function(){return e._updateManipulatorAvailability(n,sa.SCALE)})),n.events.on("grab-changed",(function(t){return e._onResizeGrab(t)})),e._createResizeDragPipeline(n,i)]),n})),a.addMany(this._resizeManipulators),this._rotateManipulatorTexture=function(e){return e.fromData(as,(function(){return new me.x(as,rs)}))}(t.toolViewManager.textures),this._rotateManipulator=ea(t,{texture:this._rotateManipulatorTexture.texture}),r.add([(0,h.YP)((function(){return e.enableRotation}),(function(){return e._updateManipulatorAvailability(e._rotateManipulator,sa.ROTATE)})),this._rotateManipulator.events.on("grab-changed",(function(t){e._onRotateGrab(t)})),this._createRotateDragPipeline(this._rotateManipulator)]),a.add(this._rotateManipulator),this._calculateMapBounds(),this._updateDisplayBounds();var l=ma({view:t,graphic:i,forEachManipulator:function(t){return e._forEachManipulator(t)},onManipulatorsChanged:function(){return(0,c.kB)()}});(0,u.pC)(l)&&(this._outlineVisualElement=l.visualElement instanceof wi?l.visualElement:null),(0,u.pC)(this._outlineVisualElement)&&r.add(this._outlineVisualElement.events.on("attachment-origin-changed",(function(){return e._updateDisplayBounds()}))),r.add(l),r.add([o.on("changed",(function(){return e._onGeometryChanged()})),(0,h.YP)((function(){return o.displaying}),(function(){return e._updateAllManipulatorAvailability()})),(0,h.YP)((function(){return o.isDraped}),(function(){return e._graphicDrapedChanged()}),h.nn),t.trackGraphicState(o)]);var d=t.pointsOfInterest;r.add((0,h.YP)((function(){return null===d||void 0===d?void 0:d.centerOnSurfaceFrequent.location}),(function(){return e._updateDisplayBounds()})));this._forEachManipulator((function(t){r.add(t.events.on("grab-changed",(function(){e.grabbing=t.grabbing,e._updateAllManipulatorAvailability()})))}));this._forEachManipulator((function(t,a){r.add(t.events.on("immediate-click",(function(t){a===sa.TRANSLATE_XY&&e.emit("immediate-click",(0,n.Z)((0,n.Z)({},t),{},{graphic:i})),t.stopPropagation()})))})),this._onGeometryChanged(),this._updateAllManipulatorAvailability(),this._initializeTooltip(),this.finishToolCreation()}},{key:"destroy",value:function(){this._mapBounds=null,this._displayBounds=null,this._rotateManipulatorTexture.release(),this._handles.destroy(),this._graphicMoveManipulation.destroy(),this._editGeometryOperations.destroy(),this._tooltip.destroy(),this._set("view",null),this._set("graphic",null)}},{key:"_initializeTooltip",value:function(){var e=this,t=this._handles,i=this.view,n=this._tooltip=new cr.u({view:i}),a=function(){n.info=e._getUpdatedTooltipInfo()};t.add([this.on("graphic-translate-start",a),this.on("graphic-translate",a),this.on("graphic-translate-stop",(function(){e._moveXYTooltipInfo=null,e._moveZTooltipInfo=null,e._tooltip.clear()})),this.on("graphic-rotate-start",(function(t){e._startAngle=t.angle,a()})),this.on("graphic-rotate",(function(t){e._endAngle=t.angle,a()})),this.on("graphic-rotate-stop",(function(){e._startAngle=0,e._endAngle=0,a()})),this.on("graphic-scale-start",(function(t){(0,A.s)(e._startScale,t.xScale,t.yScale),(0,A.s)(e._endScale,t.xScale,t.yScale),a()})),this.on("graphic-scale",(function(t){(0,A.s)(e._endScale,t.xScale,t.yScale),a()})),this.on("graphic-scale-stop",(function(){(0,A.s)(e._startScale,0,0),(0,A.s)(e._endScale,0,0),a()}))]),this._forEachManipulator((function(i){t.add([i.events.on("focus-changed",a),i.events.on("grab-changed",a),i.events.on("drag",(function(t){"cancel"===t.action?e._tooltip.clear():a()}))])}))}},{key:"_getUpdatedTooltipInfo",value:function(){return this.tooltipOptions.enabled?this._graphicMoveManipulation.grabbing||this._graphicMoveManipulation.dragging?this._computeMoveXYTooltipInfo():this._moveZManipulator.focused?this._computeMoveZTooltipInfo():this._rotateManipulator.focused?this._computeRotateTooltipInfo():this._resizeManipulators.some((function(e){return e.focused}))?this._computeScaleTooltipInfo():null:null}},{key:"_computeMoveXYTooltipInfo",value:function(){var e=this;return this._moveXYTooltipInfo=(0,u.Pt)(this._moveXYTooltipInfo,(function(){return new ur.$E({tooltipOptions:e.tooltipOptions})}))}},{key:"_computeMoveZTooltipInfo",value:function(){var e=this,t=this._moveZTooltipInfo=(0,u.Pt)(this._moveZTooltipInfo,(function(){return new ur.QW({tooltipOptions:e.tooltipOptions})})),i=this._moveUnit;if(this._moveZManipulator.dragging){var n=this._mapBoundsStart.origin,a=this._mapBounds.origin,r=(0,hr.Cr)(n,a,this.view.spatialReference);if((0,u.Wi)(r))return null;t.distance=r}else t.distance=(0,on.yG)(0,i);return t}},{key:"_computeRotateTooltipInfo",value:function(){var e=this,t=this._rotateTooltipInfo=(0,u.Pt)(this._rotateTooltipInfo,(function(){return new cs.c({tooltipOptions:e.tooltipOptions})}));return t.angle=this._startAngle-this._endAngle,t}},{key:"_computeScaleTooltipInfo",value:function(){var e=this,t=this.graphic.geometry;if((0,u.Wi)(t))return null;var i=this._scaleTooltipInfo=(0,u.Pt)(this._scaleTooltipInfo,(function(){return new cs.p({tooltipOptions:e.tooltipOptions})})),n=(0,ls.NI)(this._mapBounds,this._zmax,t.spatialReference,this._graphicState.isDraped);return(0,u.Wi)(n)?null:(i.xSize=n[0],i.ySize=n[1],(0,u.pC)(this._sizeStart)&&this._resizeManipulators.some((function(e){return e.dragging}))?(i.xScale=n[0].value/this._sizeStart[0].value,i.yScale=n[1].value/this._sizeStart[1].value):(i.xScale=1,i.yScale=1),i)}},{key:"_graphicDrapedChanged",value:function(){var e=this;this._handles.remove(hs),this._updateDisplayBounds(),this._graphicState.isDraped&&this._handles.add(this.view.elevationProvider.on("elevation-change",(function(t){(0,u.pC)(e._attachmentOrigin)&&(0,pn.jE)(t.extent,e._attachmentOrigin.x,e._attachmentOrigin.y)&&e._updateDisplayBounds()})),hs)}},{key:"_updateAllManipulatorAvailability",value:function(){var e=this;this._forEachManipulator((function(t,i){return e._updateManipulatorAvailability(t,i)}))}},{key:"_updateManipulatorAvailability",value:function(e,t){var i=this.grabbing&&!e.grabbing;if(e.interactive=!i,e instanceof bn){var n=this._graphicState.displaying,a=this.enableZ&&ca(this.graphic);switch(t){case sa.ROTATE:e.available=n&&this.enableRotation;break;case sa.SCALE:e.available=n&&(this.enableScaling||this.enableRotation||a),e.interactive=!i&&this.enableScaling,e.state=this.enableScaling?is:ns;break;case sa.TRANSLATE_Z:e.available=n&&a;break;default:e.available=n}}}},{key:"_forEachManipulator",value:function(e){this._graphicMoveManipulation.forEachManipulator(e),this._resizeManipulators.forEach((function(t){return e(t,sa.SCALE)})),e(this._rotateManipulator,sa.ROTATE),e(this._moveZManipulator,sa.TRANSLATE_Z)}},{key:"preserveAspectRatio",get:function(){return this._preserveAspectRatio.enabled},set:function(e){this._preserveAspectRatio.enabled=e,this._set("preserveAspectRatio",e)}},{key:"_moveUnit",get:function(){return(0,u.Pt)((0,yr.j5)(this.view.spatialReference),"meters")}},{key:"reset",value:function(){}},{key:"_onGeometryChanged",value:function(){this._updateDisplayBounds()}},{key:"_calculateMapBounds",value:function(){var e=this.graphic.geometry,t=this._editGeometryOperations.data,i=t.components[0].edges[0],n=(0,A.a)(kt.qW.get(),i.leftVertex.pos,i.rightVertex.pos);(0,A.f)(n,n);var a=(0,u.Pt)(aa(this.view,this.graphic),(function(){var t;return null===(t=e.extent)||void 0===t?void 0:t.center})),r=a?ps*this.view.pixelSizeAt(a):0,o=this.view.spatialReference,s=e.spatialReference;o.equals(s)||(r*=(0,yr.c9)(o)/(0,yr.c9)(s)),(0,ls.lv)(n,t,r,this._mapBounds),this._updateZMax()}},{key:"_updateZMax",value:function(){var e=this._editGeometryOperations.data;if(e.geometry.hasZ){var t,i=e.coordinateHelper,n=Number.NEGATIVE_INFINITY,a=(0,G.Z)(e.components);try{for(a.s();!(t=a.n()).done;){var r,o=t.value,s=(0,G.Z)(o.vertices);try{for(s.s();!(r=s.n()).done;){var l,c=r.value,u=null!==(l=i.getZ(c.pos))&&void 0!==l?l:0;n=Math.max(u,n)}}catch(h){s.e(h)}finally{s.f()}}}catch(h){a.e(h)}finally{a.f()}this._zmax=n}else this._zmax=0}},{key:"_updateDisplayBounds",value:function(){var e=this.graphic.geometry;if(!(0,u.Wi)(e)){var t=e.extent;if(t){var i=(0,u.pC)(this._outlineVisualElement)&&!this._graphicState.isDraped&&(0,u.pC)(this._outlineVisualElement.attachmentOrigin)?this._outlineVisualElement.attachmentOrigin:aa(this.view,this.graphic);this._attachmentOrigin=(0,u.Pt)(i,t.center);var n=(0,u.pC)(i)?i.z:(0,At.w7)(this._mapBounds.origin,this.view.elevationProvider,Tt.o.fromElevationInfo((0,y.RL)(this.graphic)),this.view.renderCoordsHelper),a=(0,lo.c)(this._mapBounds);a.origin[2]=null!==n&&void 0!==n?n:0,(0,ls.ny)(a,this.view.renderCoordsHelper,e.spatialReference,this._displayBoundsMargin,this._displayBounds),this._updateManipulators()}}}},{key:"_displayBoundsMargin",get:function(){var e,t=this.view.pointsOfInterest,i=t?t.centerOnSurfaceFrequent.location:null===(e=this._editGeometryOperations.data.geometry.extent)||void 0===e?void 0:e.center;return i?ds*this.view.pixelSizeAt(i):0}},{key:"_createMoveXYGraphicDragPipeline",value:function(){var e=this;return this._graphicMoveManipulation.createDragPipeline((function(t,i,n){return e._applyGraphicMoveSteps(i,n,Ua.XY)}))}},{key:"_createMoveZDragPipeline",value:function(){var e=this,t=this.view,i=this._editGeometryOperations.data.spatialReference;return(0,Ra.Xd)(this._moveZManipulator,(function(n,a,r){var o=(0,g.a)(n.renderLocation),s=a.next(Ia(t,o,i)).next((0,Ra.zh)());e._applyGraphicMoveSteps(s,r,Ua.Z)}))}},{key:"_applyGraphicMoveSteps",value:function(e,t,i){var n=this,a=e.next((function(e){return"start"===e.action&&(n.inputState={type:"move"},n._updateOperationStartProperties(),n.emit("graphic-translate-start",{graphic:n.graphic,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY})),e})).next((0,Ra.AN)()).next(this._moveDragUpdateGeometry()).next((function(e){var t,i,a={graphic:n.graphic,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY};switch(e.action){case"start":case"update":(e.mapEnd.x-e.mapStart.x||e.mapEnd.y-e.mapStart.y||(null!==(t=e.mapEnd.z)&&void 0!==t?t:0)-(null!==(i=e.mapStart.z)&&void 0!==i?i:0))&&n.emit("graphic-translate",a);break;case"end":n.inputState=null,n.emit("graphic-translate-stop",a)}return e})).next((function(e){return n._updateMoveTooltip(e,i)}));return t.next((function(){(0,u.pC)(n.inputState)&&n.emit("graphic-translate-stop",{graphic:n.graphic,dxScreen:0,dyScreen:0}),n._cancel()})),a}},{key:"_updateOperationStartProperties",value:function(){(0,lo.c)(this._displayBounds,this._displayBoundsStart),(0,lo.c)(this._mapBounds,this._mapBoundsStart),(0,u.Wi)(this.graphic.geometry)?this._sizeStart=null:this._sizeStart=(0,ls.NI)(this._mapBoundsStart,this._zmax,this.graphic.geometry.spatialReference,this._graphicState.isDraped)}},{key:"_moveDragUpdateGeometry",value:function(){var e=this;return function(t){if((0,u.Wi)(e.inputState)||"move"!==e.inputState.type)return t;var i,n=[],a=(0,G.Z)(e._editGeometryOperations.data.components);try{for(a.s();!(i=a.n()).done;){var r=i.value;n.push.apply(n,(0,S.Z)(r.vertices))}}catch(l){a.e(l)}finally{a.f()}var o="start"===t.action?Or.O.NEW_STEP:Or.O.ACCUMULATE_STEPS,s=e._editGeometryOperations.moveVertices(n,t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,o);return(0,ls.nn)(s,e._mapBounds),e.graphic.geometry=e._editGeometryOperations.data.geometry,t}}},{key:"_updateMoveTooltip",value:function(e,t){if(t===Ua.XY||t===Ua.XY_AXIS){var i=(0,U.GQ)(e.mapStart,e.mapEnd,this._graphicState.isDraped?"on-the-ground":"absolute-height");(0,u.pC)(i)&&(0,u.pC)(this._moveXYTooltipInfo)&&(this._moveXYTooltipInfo.distance=i)}return e}},{key:"_onResizeGrab",value:function(e){var t=e.action,i=e.screenPoint;if("start"===t&&i){var n=this._calculatePickRay(i);(0,fn.BR)(this._displayBounds.plane,n,kt.WM.get())&&(this._updateOperationStartProperties(),this._displayBoundsMarginStart=this._displayBoundsMargin,this.inputState={type:"resize"})}}},{key:"_createResizeDragPipeline",value:function(e,t){var i=this;return(0,Ra.Xd)(e,(function(e,a,r){var o;(0,u.Wi)(i.inputState)||((o=a.next((function(e){return"start"===e.action&&i.emit("graphic-scale-start",{graphic:i.graphic,xScale:1,yScale:1}),e})).next(Da(i.view,i._displayBoundsStart.plane)).next((function(e){return(0,n.Z)((0,n.Z)({},e),{},{handle:t})})).next(i._resizeDragRenderPlaneToFactors())).next.apply(o,(0,S.Z)(i._preserveAspectRatio.createDragEventPipelineStep())).next(i._resizeDragUpdateGeometry()).next((function(e){var t={graphic:i.graphic,xScale:e.factor1,yScale:e.factor2};switch(e.action){case"start":case"update":i.emit("graphic-scale",t);break;case"end":i.inputState=null,i.emit("graphic-scale-stop",t)}return e})),r.next((function(){(0,u.pC)(i.inputState)&&i.emit("graphic-scale-stop",{graphic:i.graphic,xScale:1,yScale:1}),i._cancel()})))}))}},{key:"_resizeDragRenderPlaneToFactors",value:function(){var e=this;return function(t){var i=e._displayBoundsStart,a=t.handle.direction,r=e._displayBoundsMargin,o=e._displayBoundsMarginStart,s=(0,_.c)(kt.WM.get(),i.origin);(0,_.z)(s,s,i.basis1,-a[0]),(0,_.z)(s,s,i.basis2,-a[1]);var l=(0,_.b)(kt.WM.get(),t.renderEnd,s),c=(0,_.b)(kt.WM.get(),t.renderStart,s),u=Bo(t.handle),h=Uo(i),d=Uo(e._displayBounds)/h,p=function(e,t){if(0===e)return 1;var i=(0,_.l)(t),n=.5*e*(0,_.e)(t,l)/i,a=n<0?-1:1;u&&(n+=(i-.5*e*(0,_.e)(t,c)/i)*a*d);var s=i<1.5*o?1:fs;return i=Math.max(i-o,fs),a>0&&(n-=r),a*Math.max(a*(n/i),s)};return(0,n.Z)((0,n.Z)({},t),{},{factor1:p(a[0],i.basis1),factor2:p(a[1],i.basis2)})}}},{key:"_resizeDragUpdateGeometry",value:function(){var e=this;return function(t){var i=(0,_.c)((0,g.c)(),e._mapBoundsStart.origin);(0,_.z)(i,i,e._mapBoundsStart.basis1,-t.handle.direction[0]),(0,_.z)(i,i,e._mapBoundsStart.basis2,-t.handle.direction[1]);var n=(0,A.s)((0,T.a)(),e._mapBoundsStart.basis1[0],e._mapBoundsStart.basis1[1]);(0,A.f)(n,n);var a,r=[],o=(0,G.Z)(e._editGeometryOperations.data.components);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.push.apply(r,(0,S.Z)(s.vertices))}}catch(u){o.e(u)}finally{o.f()}var l="start"===t.action?Or.O.NEW_STEP:Or.O.ACCUMULATE_STEPS,c=e._editGeometryOperations.scaleVertices(r,i,n,t.factor1,t.factor2,l,ss.w.REPLACE);return(0,lo.c)(e._mapBoundsStart,e._mapBounds),(0,ls.nn)(c,e._mapBounds),e.graphic.geometry=e._editGeometryOperations.data.geometry,t}}},{key:"_onRotateGrab",value:function(e){var t=e.action,i=e.screenPoint;if("start"===t&&i){var n=function(e,t,i,n){var a=t.worldUpAtPosition(e.origin,kt.WM.get()),r=kt.WM.get();switch(i){case Qo.HEADING:(0,_.c)(r,a);break;case Qo.TILT:(0,_.c)(r,e.basis1)}return(0,fn.Yq)(e.origin,r,n)}(this._displayBounds,this.view.renderCoordsHelper,Qo.HEADING,(0,fn.Ue)()),a=this._calculatePickRay(i);(0,fn.BR)(n,a,kt.WM.get())&&(this._updateOperationStartProperties(),this.inputState={type:"rotate",rotatePlane:n})}}},{key:"_createRotateDragPipeline",value:function(e){var t=this;return(0,Ra.Xd)(e,(function(e,i,n){var a=t.inputState;(0,u.Wi)(a)||(i.next((function(e){return"start"===e.action&&t.emit("graphic-rotate-start",{graphic:t.graphic,angle:0}),e})).next(Da(t.view,a.rotatePlane)).next(t._rotateDragRenderPlaneToRotate(a)).next(t._rotateDragUpdateGeometry()).next((function(e){var i={graphic:t.graphic,angle:(0,Ye.BV)(e.rotateAngle)};switch(e.action){case"start":case"update":t.emit("graphic-rotate",i);break;case"end":t.inputState=null,t.emit("graphic-rotate-stop",i)}return e})),n.next((function(){(0,u.pC)(t.inputState)&&t.emit("graphic-rotate-stop",{graphic:t.graphic,angle:0}),t._cancel()})))}))}},{key:"_rotateDragRenderPlaneToRotate",value:function(e){var t=this;return function(i){var a=(0,fn.mJ)(e.rotatePlane),r=ia(i.renderStart,i.renderEnd,t._displayBounds.origin,a);return(0,n.Z)((0,n.Z)({},i),{},{rotateAxis:a,rotateAngle:r})}}},{key:"_rotateDragUpdateGeometry",value:function(){var e=this;return function(t){var i,n=(0,_.c)((0,g.c)(),e._mapBoundsStart.origin),a=[],r=(0,G.Z)(e._editGeometryOperations.data.components);try{for(r.s();!(i=r.n()).done;){var o=i.value;a.push.apply(a,(0,S.Z)(o.vertices))}}catch(c){r.e(c)}finally{r.f()}var s="start"===t.action?Or.O.NEW_STEP:Or.O.ACCUMULATE_STEPS,l=e._editGeometryOperations.rotateVertices(a,n,t.rotateAngle,s,ss.w.REPLACE);return(0,lo.c)(e._mapBoundsStart,e._mapBounds),(0,ls.nn)(l,e._mapBounds),e.graphic.geometry=e._editGeometryOperations.data.geometry,t}}},{key:"_calculatePickRay",value:function(e){var t=(0,ce.Ue)(),i=(0,b.md)(e);return _n(this.view.state.camera,i,t),(0,_.n)(t.direction,t.direction),t}},{key:"_updateManipulators",value:function(){var e=this;if(this.visible){var t=function(e,t){return na(e.basis1,e.basis2,e.origin,t)}(this._displayBounds,kt.MP.get());(function(e,t,i,n){var a=n.worldUpAtPosition(i.origin,kt.WM.get()),r=Fo(i,jo.POSITIVE_X),o=(0,It.b)(kt.MP.get(),r.edge*Math.PI/2);(0,It.r)(o,o,-qo(i,a)),(0,It.m)(o,t,o),o[12]=0,o[13]=0,o[14]=0,e.modelTransform=o,e.renderLocation=r.position})(this._rotateManipulator,t,this._displayBounds,this.view.renderCoordsHelper),this._updateZMoveHandle(this._moveZManipulator,t),this._resizeManipulators.forEach((function(i,n){!function(e,t,i,n){var a=(0,_.l)(n.basis1),r=(0,_.l)(n.basis2),o=Ho(n),s=Uo(n),l=(0,_.s)(kt.WM.get(),0,0,0);(0,_.a)(l,(0,_.g)(kt.WM.get(),n.basis1,t.direction[0]),(0,_.g)(kt.WM.get(),n.basis2,t.direction[1])),(0,_.a)(l,n.origin,l);var c=0,u=1;if(Bo(t))1===t.direction[0]&&-1===t.direction[1]?c=ts:1===t.direction[0]&&1===t.direction[1]?c=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(c=3*Math.PI/2),u=s;else{var h=0!==t.direction[0]?1:2;c=1===h?ts:0,u=(1===h?r:a)-o}var d=(0,It.b)(kt.MP.get(),c);(0,It.k)(d,d,(0,_.s)(kt.WM.get(),u,u,u)),(0,It.m)(d,i,d),d[12]=0,d[13]=0,d[14]=0,e.modelTransform=d,e.renderLocation=l}(i,e._resizeHandles[n],t,e._displayBounds)}))}}},{key:"_updateZMoveHandle",value:function(e,t){var i=this._displayBounds,n={basis:i.basis1,direction:-1,position:(0,_.b)(kt.WM.get(),i.origin,i.basis1),edge:2},a=kt.MP.get();(0,It.o)(a,t,n.edge*Math.PI/2),a[12]=0,a[13]=0,a[14]=0,e.modelTransform=a,e.renderLocation=n.position}},{key:"_cancel",value:function(){var e=this._editGeometryOperations.lastOperation;(0,u.Wi)(e)||(this._editGeometryOperations.undo(),this.graphic.geometry=this._editGeometryOperations.data.geometry,(0,ls.mO)(e,this._mapBounds),this._updateDisplayBounds(),this.inputState=null)}},{key:"canUndo",get:function(){return this._editGeometryOperations.canUndo}},{key:"undo",value:function(){if((0,u.pC)(this.inputState))this.view.activeTool=null;else if(this.canUndo){var e=this._editGeometryOperations.undo();this.graphic.geometry=this._editGeometryOperations.data.geometry,(0,ls.mO)((0,u.Wg)(e),this._mapBounds),this._updateDisplayBounds()}}},{key:"canRedo",get:function(){return this._editGeometryOperations.canRedo}},{key:"redo",value:function(){if(this.canRedo){var e=this._editGeometryOperations.redo();this.graphic.geometry=this._editGeometryOperations.data.geometry,(0,ls.nn)((0,u.Wg)(e),this._mapBounds),this._updateDisplayBounds()}}},{key:"test",get:function(){return{resizeManipulators:this._resizeManipulators,rotateManipulator:this._rotateManipulator,moveZManipulator:this._moveZManipulator,tooltip:this._tooltip}}}]),i}(bi.Z.EventedMixin(ar.m));(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],us.prototype,"view",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],us.prototype,"graphic",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,nonNullable:!0})],us.prototype,"enableZ",void 0),(0,l._)([(0,d.Cb)()],us.prototype,"enableRotation",void 0),(0,l._)([(0,d.Cb)()],us.prototype,"enableScaling",void 0),(0,l._)([(0,d.Cb)({constructOnly:!0,type:or.Z})],us.prototype,"tooltipOptions",void 0),(0,l._)([(0,d.Cb)()],us.prototype,"preserveAspectRatio",null),(0,l._)([(0,d.Cb)()],us.prototype,"grabbing",void 0),(0,l._)([(0,d.Cb)()],us.prototype,"inputState",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],us.prototype,"type",void 0),(0,l._)([(0,d.Cb)()],us.prototype,"_moveUnit",null),us=(0,l._)([(0,v.j)("esri.views.3d.interactive.editingTools.graphicTransform3D.ExtentTransformTool")],us);var hs="draped-elevation-changes",ds=10,ps=80,fs=1e-6},8084:function(e,t,i){i.d(t,{j:function(){return y}});var n,a,r,o,s,l,c=i(30168),u=i(92026),h=i(21002),d=i(96415),p=i(82999),f=i(49450),v=i(58406),_=i(98634),g=i(19253);function y(e,t){e.extensions.add("GL_OES_standard_derivatives");var i=e.fragment;i.include(h.S),e.include(d.G),i.uniforms.add([new v.p("globalAlpha",(function(e){return e.globalAlpha})),new f.J("glowColor",(function(e){return e.glowColor})),new v.p("glowWidth",(function(e,t){return e.glowWidth*t.camera.pixelRatio})),new v.p("glowFalloff",(function(e){return e.glowFalloff})),new f.J("innerColor",(function(e){return e.innerColor})),new v.p("innerWidth",(function(e,t){return e.innerWidth*t.camera.pixelRatio})),new g.A("depthMap",(function(e,t){return t.linearDepthTexture})),new p.A("nearFar",(function(e,t){return t.camera.nearFar})),new g.A("frameColor",(function(e,t){return t.mainColorTexture}))]),i.code.add((0,_.H)(n||(n=(0,c.Z)(["vec4 blendPremultiplied(vec4 source, vec4 dest) {\nfloat oneMinusSourceAlpha = 1.0 - source.a;\nreturn vec4(\nsource.rgb + dest.rgb * oneMinusSourceAlpha,\nsource.a + dest.a * oneMinusSourceAlpha\n);\n}"])))),i.code.add((0,_.H)(a||(a=(0,c.Z)(["vec4 premultipliedColor(vec3 rgb, float alpha) {\nreturn vec4(rgb * alpha, alpha);\n}"])))),i.code.add((0,_.H)(r||(r=(0,c.Z)(["vec4 laserlineProfile(float dist) {\nif (dist > glowWidth) {\nreturn vec4(0.0);\n}\nfloat innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));\nfloat glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);\nreturn blendPremultiplied(\npremultipliedColor(innerColor, innerAlpha),\npremultipliedColor(glowColor, glowAlpha)\n);\n}"])))),i.code.add((0,_.H)(o||(o=(0,c.Z)(["bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {\nfloat depth = linearDepthFromTexture(depthMap, uv, nearFar);\nif (-depth == nearFar[0]) {\nreturn false;\n}\npos = reconstructPosition(gl_FragCoord.xy, depth);\nnormal = normalize(cross(dFdx(pos), dFdy(pos)));\nfloat ddepth = fwidth(depth);\ndepthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);\nreturn true;\n}"])))),t.contrastControlEnabled?(i.uniforms.add(new v.p("globalAlphaContrastBoost",(function(e){return(0,u.pC)(e.globalAlphaContrastBoost)?e.globalAlphaContrastBoost:1}))),i.code.add((0,_.H)(s||(s=(0,c.Z)(["float rgbToLuminance(vec3 color) {\nreturn dot(vec3(0.2126, 0.7152, 0.0722), color);\n}\nvec4 laserlineOutput(vec4 color) {\nfloat backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);\nfloat alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);\nreturn color * alpha;\n}"]))))):i.code.add((0,_.H)(l||(l=(0,c.Z)(["vec4 laserlineOutput(vec4 color) {\nreturn color * globalAlpha;\n}"]))))}},43505:function(e,t,i){i.d(t,{A:function(){return l}});var n,a=i(30168),r=i(82552),o=i(58406),s=i(98634);function l(e,t){if(t.screenSizeEnabled){var i=e.vertex;(0,r.hY)(i,t),i.uniforms.add(new o.p("perScreenPixelRatio",(function(e,t){return t.camera.perScreenPixelRatio}))),i.uniforms.add(new o.p("screenSizeScale",(function(e){return e.screenSizeScale}))),i.code.add((0,s.H)(n||(n=(0,a.Z)(["float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));\nreturn viewDirectionDistance * perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;\n}"]))))}}},7068:function(e,t,i){i.d(t,{c:function(){return d},p:function(){return p}});var n=i(43144),a=i(15671),r=i(60136),o=i(29388),s=i(27366),l=i(47898),c=i(49861),u=i(69912),h=i(4943),d=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="extent-rotate",n.angle=0,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],d.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],d.prototype,"angle",void 0),d=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.ExtentRotateTooltipInfo")],d);var p=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="extent-scale",n.xScale=0,n.yScale=0,n.xSize=l.yP,n.ySize=l.yP,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],p.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"xScale",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"yScale",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"xSize",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"ySize",void 0),p=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.ExtentScaleTooltipInfo")],p)},40524:function(e,t,i){i.d(t,{$E:function(){return d},QW:function(){return p},c1:function(){return g},in:function(){return f},j:function(){return _},nk:function(){return v}});var n=i(43144),a=i(15671),r=i(60136),o=i(29388),s=i(27366),l=i(47898),c=i(49861),u=i(69912),h=i(4943),d=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="translate-graphic",n.distance=l.yP,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],d.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],d.prototype,"distance",void 0),d=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],d);var p=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="translate-graphic-z",n.distance=l.yP,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],p.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],p.prototype,"distance",void 0),p=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],p);var f=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="translate-graphic-xy",n.distance=l.yP,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],f.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],f.prototype,"distance",void 0),f=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],f);var v=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="translate-vertex",n.distance=l.yP,n.elevation=null,n.area=null,n.totalLength=null,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],v.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],v.prototype,"distance",void 0),(0,s._)([(0,c.Cb)()],v.prototype,"elevation",void 0),(0,s._)([(0,c.Cb)()],v.prototype,"area",void 0),(0,s._)([(0,c.Cb)()],v.prototype,"totalLength",void 0),v=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],v);var _=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="translate-vertex-z",n.distance=l.yP,n.elevation=null,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],_.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],_.prototype,"distance",void 0),(0,s._)([(0,c.Cb)()],_.prototype,"elevation",void 0),_=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],_);var g=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="translate-vertex-xy",n.distance=l.yP,n.elevation=null,n.area=null,n.totalLength=null,n}return(0,n.Z)(i)}(h.h);(0,s._)([(0,c.Cb)()],g.prototype,"type",void 0),(0,s._)([(0,c.Cb)()],g.prototype,"distance",void 0),(0,s._)([(0,c.Cb)()],g.prototype,"elevation",void 0),(0,s._)([(0,c.Cb)()],g.prototype,"area",void 0),(0,s._)([(0,c.Cb)()],g.prototype,"totalLength",void 0),g=(0,s._)([(0,u.j)("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],g)}}]);
//# sourceMappingURL=5209.ec764b80.chunk.js.map