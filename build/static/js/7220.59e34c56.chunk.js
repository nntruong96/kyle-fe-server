"use strict";(self.webpackChunkcommonlands_web=self.webpackChunkcommonlands_web||[]).push([[7220],{85981:function(n,t,e){e.d(t,{AR:function(){return m},Gr:function(){return l},JG:function(){return s},Jk:function(){return h},KU:function(){return g},Ue:function(){return a},al:function(){return d},ct:function(){return p},nF:function(){return v},zk:function(){return f}});var r=e(16889),i=e(21530),o=e(11186),u=e(71353),c=e(11185);function a(n){return n?{origin:(0,u.a)(n.origin),vector:(0,u.a)(n.vector)}:{origin:(0,u.c)(),vector:(0,u.c)()}}function s(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a();return d(n.origin,n.vector,t)}function d(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();return(0,o.c)(e.origin,n),(0,o.c)(e.vector,t),e}function f(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();return(0,o.c)(e.origin,n),(0,o.b)(e.vector,t,n),e}function h(n,t){var e=(0,o.b)(c.WM.get(),t,n.origin),i=(0,o.e)(n.vector,e),u=(0,o.e)(n.vector,n.vector),a=(0,r.uZ)(i/u,0,1),s=(0,o.b)(c.WM.get(),(0,o.g)(c.WM.get(),n.vector,a),e);return(0,o.e)(s,s)}function v(n,t,e){return p(n,t,0,1,e)}function g(n,t,e){return(0,o.a)(e,n.origin,(0,o.g)(e,n.vector,t))}function p(n,t,e,i,u){var a=n.vector,s=n.origin,d=(0,o.b)(c.WM.get(),t,s),f=(0,o.e)(a,d)/(0,o.p)(a);return(0,o.g)(u,a,(0,r.uZ)(f,e,i)),(0,o.a)(u,u,n.origin)}function l(n,t){if(b(n,function(n,t){var e=k.get();return e.origin=n,e.vector=t,e}(t.origin,t.direction),!1,_)){var e=_.tA,r=_.pB,i=_.distance2;if(e>=0&&e<=1)return i;if(e<0)return(0,o.d)(n.origin,r);if(e>1)return(0,o.d)((0,o.a)(c.WM.get(),n.origin,n.vector),r)}return null}function m(n,t,e){return!!b(n,t,!0,_)&&((0,o.c)(e,_.pA),!0)}function b(n,t,e,i){var u=1e-6,a=n.origin,s=(0,o.a)(c.WM.get(),a,n.vector),d=t.origin,f=(0,o.a)(c.WM.get(),d,t.vector),h=c.WM.get(),v=c.WM.get();if(h[0]=a[0]-d[0],h[1]=a[1]-d[1],h[2]=a[2]-d[2],v[0]=f[0]-d[0],v[1]=f[1]-d[1],v[2]=f[2]-d[2],Math.abs(v[0])<u&&Math.abs(v[1])<u&&Math.abs(v[2])<u)return!1;var g=c.WM.get();if(g[0]=s[0]-a[0],g[1]=s[1]-a[1],g[2]=s[2]-a[2],Math.abs(g[0])<u&&Math.abs(g[1])<u&&Math.abs(g[2])<u)return!1;var p=h[0]*v[0]+h[1]*v[1]+h[2]*v[2],l=v[0]*g[0]+v[1]*g[1]+v[2]*g[2],m=h[0]*g[0]+h[1]*g[1]+h[2]*g[2],b=v[0]*v[0]+v[1]*v[1]+v[2]*v[2],_=(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*b-l*l;if(Math.abs(_)<u)return!1;var k=(p*l-m*b)/_,Z=(p+l*k)/b;e&&(k=(0,r.uZ)(k,0,1),Z=(0,r.uZ)(Z,0,1));var w=c.WM.get(),y=c.WM.get();return w[0]=a[0]+k*g[0],w[1]=a[1]+k*g[1],w[2]=a[2]+k*g[2],y[0]=d[0]+Z*v[0],y[1]=d[1]+Z*v[1],y[2]=d[2]+Z*v[2],i.tA=k,i.tB=Z,i.pA=w,i.pB=y,i.distance2=(0,o.d)(w,y),!0}var _={tA:0,tB:0,pA:(0,u.c)(),pB:(0,u.c)(),distance2:0},k=new i.x((function(){return a()}))},97731:function(n,t,e){e.d(t,{E6:function(){return f},T:function(){return a},ep:function(){return d},hu:function(){return c},kG:function(){return v},u_:function(){return h},yK:function(){return s}});var r=e(15671),i=e(43144),o=e(6394),u=(e(90045),(0,e(67077).c)(),function(){function n(t){(0,r.Z)(this,n),this.message=t}return(0,i.Z)(n,[{key:"toString",value:function(){return"AssertException: ".concat(this.message)}}]),n}());function c(n,t){if(!n){t=t||"Assertion";var e=new Error(t).stack;throw new u("".concat(t," at ").concat(e))}}function a(n,t){n||(t=t||"",console.warn("Verify failed: "+t+"\n"+new Error("verify").stack))}function s(n,t,e,r){var i,o=(e[0]-n[0])/t[0],u=(r[0]-n[0])/t[0];o>u&&(i=o,o=u,u=i);var c=(e[1]-n[1])/t[1],a=(r[1]-n[1])/t[1];if(c>a&&(i=c,c=a,a=i),o>a||c>u)return!1;c>o&&(o=c),a<u&&(u=a);var s=(e[2]-n[2])/t[2],d=(r[2]-n[2])/t[2];return s>d&&(i=s,s=d,d=i),!(o>d||s>u)&&(d<u&&(u=d),!(u<0))}function d(n,t,e,r,i){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,o.a)(),c=(r[i]-e[i])*(t[0]-n[0])-(r[0]-e[0])*(t[i]-n[i]),a=(r[0]-e[0])*(n[i]-e[i])-(r[i]-e[i])*(n[0]-e[0]);if(0===c)return!1;var s=a/c;return u[0]=n[0]+s*(t[0]-n[0]),u[1]=n[i]+s*(t[i]-n[i]),!0}function f(n,t){return Math.log(n)/Math.log(t)}function h(n,t,e,r){n[12]=t,n[13]=e,n[14]=r}function v(n){return 1===n[0]&&0===n[1]&&0===n[2]&&0===n[3]&&0===n[4]&&1===n[5]&&0===n[6]&&0===n[7]&&0===n[8]&&0===n[9]&&1===n[10]&&0===n[11]&&1===n[15]}},50319:function(n,t,e){e.r(t),e.d(t,{default:function(){return Z}});var r=e(37762),i=e(74165),o=e(15861),u=e(15671),c=e(43144),a=e(27366),s=e(92026),d=e(66978),f=(e(32718),e(25243),e(63780),e(10064),e(93169),e(69912)),h=e(11186),v=e(71353),g=e(85981),p=e(23470),l=e(92536),m=e(78329),b=e(83715);function _(n,t,e){var r=(0,p.c)(),i=(0,p.g)(r);return(0,h.z)(i,i,n,.5),(0,h.z)(i,i,t,.5),r[3]=(0,h.i)(i,n),(0,h.a)(i,i,e),r}var k=function(){function n(){(0,u.Z)(this,n),this._idToComponent=new Map,this._components=new m.Z((function(n){return n.bounds})),this._edges=new m.Z((function(n){return n.bounds})),this._tmpLineSegment=(0,g.Ue)(),this._tmpP1=(0,v.c)(),this._tmpP2=(0,v.c)(),this._tmpP3=(0,v.c)(),this.remoteClient=null}return(0,c.Z)(n,[{key:"fetchCandidates",value:function(){var n=(0,o.Z)((0,i.Z)().mark((function n(t,e){var r,o=this;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.resolve();case 2:return(0,d.k_)(e),n.next=5,this._ensureEdgeLocations(t,e);case 5:return r=[],n.abrupt("return",(this._edges.forEachNeighbor((function(n){return o._addCandidates(t,n,r),r.length<1e3}),t.bounds),{result:{candidates:r}}));case 7:case"end":return n.stop()}}),n,this)})));return function(t,e){return n.apply(this,arguments)}}()},{key:"_ensureEdgeLocations",value:function(){var n=(0,o.Z)((0,i.Z)().mark((function n(t,e){var o,u,c,a,d,f;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=[],this._components.forEachNeighbor((function(n){if((0,s.Wi)(n.info)){var t=n.id,e=n.uid;o.push({id:t,uid:e})}return!0}),t.bounds),o.length){n.next=3;break}return n.abrupt("return");case 3:return u={components:o},n.next=6,this.remoteClient.invoke("fetchAllEdgeLocations",u,(0,s.Pt)(e,{}));case 6:c=n.sent,a=(0,r.Z)(c.components);try{for(a.s();!(d=a.n()).done;)f=d.value,this._setFetchEdgeLocations(f)}catch(i){a.e(i)}finally{a.f()}case 9:case"end":return n.stop()}}),n,this)})));return function(t,e){return n.apply(this,arguments)}}()},{key:"add",value:function(){var n=(0,o.Z)((0,i.Z)().mark((function n(t){var e;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=new w(t.id,t.bounds),n.abrupt("return",(this._idToComponent.set(e.id,e),this._components.add([e]),{result:{}}));case 2:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}()},{key:"remove",value:function(){var n=(0,o.Z)((0,i.Z)().mark((function n(t){var e,r;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(e=this._idToComponent.get(t.id))&&(r=[],this._edges.forEachNeighbor((function(n){return n.component===e&&r.push(n),!0}),e.bounds),this._edges.remove(r),this._components.remove([e]),this._idToComponent.delete(e.id)),n.abrupt("return",{result:{}});case 3:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}()},{key:"_setFetchEdgeLocations",value:function(n){var t=this._idToComponent.get(n.id);if(!(0,s.Wi)(t)&&n.uid===t.uid){for(var e=b.n_.createView(n.locations),r=new Array(e.count),i=(0,v.c)(),o=(0,v.c)(),u=0;u<e.count;u++){e.position0.getVec(u,i),e.position1.getVec(u,o);var c=_(i,o,n.origin),a=new y(t,u,c);r[u]=a}this._edges.add(r);var d=n.objectIds,f=n.origin;t.info={locations:e,objectIds:d,origin:f}}}},{key:"_addCandidates",value:function(n,t,e){var r=t.component.info,i=r.origin,o=r.objectIds,u=r.locations,c=u.position0.getVec(t.index,this._tmpP1),a=u.position1.getVec(t.index,this._tmpP2);(0,h.a)(c,c,i),(0,h.a)(a,a,i);var s=o[u.componentIndex.get(t.index)];this._addEdgeCandidate(n,s,c,a,e),this._addVertexCandidate(n,s,c,e),this._addVertexCandidate(n,s,a,e)}},{key:"_addEdgeCandidate",value:function(n,t,e,r,i){if(n.types&l.r.EDGE){var o=(0,p.g)(n.bounds),u=(0,g.zk)(e,r,this._tmpLineSegment),c=(0,g.nF)(u,o,this._tmpP3);(0,p.m)(n.bounds,c)&&i.push({type:"edge",objectId:t,target:(0,v.a)(c),distance:(0,h.i)(o,c),start:(0,v.a)(e),end:(0,v.a)(r)})}}},{key:"_addVertexCandidate",value:function(n,t,e,r){if(n.types&l.r.VERTEX){var i=(0,p.g)(n.bounds);(0,p.m)(n.bounds,e)&&r.push({type:"vertex",objectId:t,target:(0,v.a)(e),distance:(0,h.i)(i,e)})}}}]),n}(),Z=k=(0,a._)([(0,f.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],k),w=(0,c.Z)((function n(t,e){(0,u.Z)(this,n),this.id=t,this.bounds=e,this.info=null,this.uid=++n.uid}));w.uid=0;var y=(0,c.Z)((function n(t,e,r){(0,u.Z)(this,n),this.component=t,this.index=e,this.bounds=r}))}}]);
//# sourceMappingURL=7220.59e34c56.chunk.js.map