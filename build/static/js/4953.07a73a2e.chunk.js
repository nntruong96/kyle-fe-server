"use strict";(self.webpackChunkcommonlands_web=self.webpackChunkcommonlands_web||[]).push([[4953,3470],{11873:function(e,t,n){function r(){return[1,0,0,0,1,0,0,0,1]}function i(e,t,n,r,i,u,o,a,c){return[e,t,n,r,i,u,o,a,c]}function u(e,t){return new Float64Array(e,t,9)}n.d(t,{a:function(){return u},c:function(){return r},f:function(){return i}});Object.freeze(Object.defineProperty({__proto__:null,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},create:r,createView:u,fromValues:i},Symbol.toStringTag,{value:"Module"}))},81949:function(e,t,n){function r(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function u(e,t,n,r,i,u,o,a,c,s,f,h,l,d,v,p){return[e,t,n,r,i,u,o,a,c,s,f,h,l,d,v,p]}function o(e,t){return new Float64Array(e,t,16)}n.d(t,{I:function(){return a},a:function(){return o},b:function(){return i},c:function(){return r},f:function(){return u}});var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:a,clone:i,create:r,createView:o,fromValues:u},Symbol.toStringTag,{value:"Module"}))},98131:function(e,t,n){function r(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}function u(e,t){return new Float64Array(e,t,4)}n.d(t,{I:function(){return o},a:function(){return r},b:function(){return i},c:function(){return u}});var o=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:o,clone:i,create:r,createView:u,fromValues:function(e,t,n,r){return[e,t,n,r]}},Symbol.toStringTag,{value:"Module"}))},23470:function(e,t,n){n.d(t,{a:function(){return m},c:function(){return p},f:function(){return w},g:function(){return k},h:function(){return _},j:function(){return S},l:function(){return g},m:function(){return j},w:function(){return y}});n(93169);var r=n(32718),i=n(16889),u=n(92026),o=n(14226),a=n(11186),c=n(71353),s=n(90045),f=n(67077),h=n(14320),l=n(40885),d=n(40927),v=n(11185);function p(){return(0,f.c)()}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p();return(0,s.c)(t,e)}function y(e){return e}function g(e){e[0]=e[1]=e[2]=e[3]=0}function m(e){return e[3]}function k(e){return e}function w(e,t,n,r){return(0,f.f)(e,t,n,r)}function b(e,t,n){if((0,u.Wi)(t))return!1;var r=t.origin,i=t.direction,o=Z;o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2];var a=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];if(0===a)return!1;var c=2*(i[0]*o[0]+i[1]*o[1]+i[2]*o[2]),s=c*c-4*a*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-e[3]*e[3]);if(s<0)return!1;var f=Math.sqrt(s),h=(-c-f)/(2*a),l=(-c+f)/(2*a);return(h<0||l<h&&l>0)&&(h=l),!(h<0)&&(n&&(n[0]=r[0]+i[0]*h,n[1]=r[1]+i[1]*h,n[2]=r[2]+i[2]*h),!0)}var Z=(0,c.c)();function S(e,t){return b(e,t,null)}function x(e,t,n){var r=v.WM.get(),i=v.MP.get();(0,a.f)(r,t.origin,t.direction);var u=m(e);(0,a.f)(n,r,t.origin),(0,a.g)(n,n,1/(0,a.l)(n)*u);var c=M(e,t.origin),s=(0,d.EU)(t.origin,n);return(0,o.d)(i,s+c,r),(0,a.m)(n,n,i),n}function C(e,t,n){var r=(0,a.b)(v.WM.get(),t,e),i=(0,a.g)(v.WM.get(),r,e[3]/(0,a.l)(r));return(0,a.a)(n,i,e)}function M(e,t){var n=(0,a.b)(v.WM.get(),t,e),r=(0,a.l)(n),u=m(e),o=u+Math.abs(u-r);return(0,i.ZF)(u/o)}var P=(0,c.c)();function L(e,t,n,r){var u=(0,a.b)(P,t,e);switch(n){case h.R.X:var o=(0,i.jE)(u,P)[2];return(0,a.s)(r,-Math.sin(o),Math.cos(o),0);case h.R.Y:var c=(0,i.jE)(u,P),s=c[1],f=c[2],l=Math.sin(s);return(0,a.s)(r,-l*Math.cos(f),-l*Math.sin(f),Math.cos(s));case h.R.Z:return(0,a.n)(r,u);default:return}}function E(e,t){var n=(0,a.b)(H,t,e);return(0,a.l)(n)-e[3]}function j(e,t){var n=(0,a.d)(e,t),r=m(e);return n<=r*r}var H=(0,c.c)(),A=p();Object.freeze(Object.defineProperty({__proto__:null,altitudeAt:E,angleToSilhouette:M,axisAt:L,clear:g,closestPoint:function(e,t,n){return b(e,t,n)?n:((0,l.JI)(t,e,n),C(e,n,n))},closestPointOnSilhouette:x,containsPoint:j,copy:_,create:p,distanceToSilhouette:function(e,t){var n=(0,a.b)(v.WM.get(),t,e),r=(0,a.p)(n),i=e[3]*e[3];return Math.sqrt(Math.abs(r-i))},elevate:function(e,t,n){return e!==n&&(0,a.c)(n,e),n[3]=e[3]+t,n},fromCenterAndRadius:function(e,t){return(0,f.f)(e[0],e[1],e[2],t)},fromRadius:function(e,t){return e[0]=e[1]=e[2]=0,e[3]=t,e},fromValues:w,getCenter:k,getRadius:m,intersectRay:b,intersectRayClosestSilhouette:function(e,t,n){if(b(e,t,n))return n;var r=x(e,t,v.WM.get());return(0,a.a)(n,t.origin,(0,a.g)(v.WM.get(),t.direction,(0,a.i)(t.origin,r)/(0,a.l)(t.direction))),n},intersectsRay:S,projectPoint:C,setAltitudeAt:function(e,t,n,r){var i=E(e,t),u=L(e,t,h.R.Z,H),o=(0,a.g)(H,u,n-i);return(0,a.a)(r,t,o)},setExtent:function(e,t,n){return r.Z.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),e===n?n:_(e,n)},tmpSphere:A,wrap:y},Symbol.toStringTag,{value:"Module"}))},21530:function(e,t,n){n.d(t,{x:function(){return o}});var r=n(15671),i=n(43144),u=n(70758),o=function(){function e(t){(0,r.Z)(this,e),this._allocator=t,this._items=[],this._itemsPtr=0,this._grow()}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;return 0===this._itemsPtr&&(0,u.Y)((function(){return e._reset()})),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}},{key:"_reset",value:function(){var e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*a);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}},{key:"_grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this._items.length,a));e++)this._items.push(this._allocator())}}]),e}(),a=1024},46798:function(e,t,n){n.d(t,{q:function(){return d}});var r=n(37762),i=n(1413),u=n(15671),o=n(43144),a=n(63780),c=n(42537),s=n(32718),f=n(92026),h=n(66978),l=n(31009),d=function(){function e(t,n,o,a){var c=this,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};(0,u.Z)(this,e),this._mainMethod=n,this._transferLists=o,this._listeners=[],this._promise=(0,l.bA)(t,(0,i.Z)((0,i.Z)({},f),{},{schedule:a})).then((function(e){if(void 0===c._thread){c._thread=e,c._promise=null,f.hasInitialize&&c.broadcast({},"initialize");var t,n=(0,r.Z)(c._listeners);try{for(n.s();!(t=n.n()).done;){var i=t.value;c._connectListener(i)}}catch(u){n.e(u)}finally{n.f()}}else e.close()})),this._promise.catch((function(e){return s.Z.getLogger("esri.core.workers.WorkerHandle").error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return(0,o.Z)(e,[{key:"on",value:function(e,t){var n=this,r={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(r),this._connectListener(r),(0,c.kB)((function(){r.removed=!0,(0,a.Od)(n._listeners,r),n._thread&&(0,f.pC)(r.threadHandle)&&r.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,n){var r=this;if(this._thread){var i=this._transferLists[e],u=i?i(t):[];return this._thread.invoke(e,t,{transferList:u,signal:n})}return this._promise?this._promise.then((function(){return(0,h.k_)(n),r.invokeMethod(e,t,n)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var n=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return n.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}()},14320:function(e,t,n){var r;n.d(t,{R:function(){return r}}),function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(r||(r={}))},40885:function(e,t,n){n.d(t,{JG:function(){return f},JI:function(){return d},Jk:function(){return l},Ue:function(){return a},re:function(){return s},zk:function(){return h}});n(63780);var r=n(21530),i=n(11186),u=n(71353),o=n(11185);function a(e){return e?c((0,u.a)(e.origin),(0,u.a)(e.direction)):c((0,u.c)(),(0,u.c)())}function c(e,t){return{origin:e,direction:t}}function s(e,t){var n=v.get();return n.origin=e,n.direction=t,n}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a();return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();return(0,i.c)(n.origin,e),(0,i.c)(n.direction,t),n}(e.origin,e.direction,t)}function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();return(0,i.c)(n.origin,e),(0,i.b)(n.direction,t,e),n}function l(e,t){var n=(0,i.f)(o.WM.get(),(0,i.n)(o.WM.get(),e.direction),(0,i.b)(o.WM.get(),t,e.origin));return(0,i.e)(n,n)}function d(e,t,n){var r=(0,i.e)(e.direction,(0,i.b)(n,t,e.origin));return(0,i.a)(n,e.origin,(0,i.g)(n,e.direction,r)),n}var v=new r.x((function(){return a()}))},40927:function(e,t,n){n.d(t,{EU:function(){return c},SR:function(){return a},cp:function(){return s},nF:function(){return o}});var r=n(16889),i=n(11186),u=n(71353);function o(e,t,n){var r=(0,i.e)(e,t)/(0,i.e)(e,e);return(0,i.g)(n,e,r)}function a(e,t){return(0,i.e)(e,t)/(0,i.l)(e)}function c(e,t){var n=(0,i.e)(e,t)/((0,i.l)(e)*(0,i.l)(t));return-(0,r.ZF)(n)}function s(e,t,n){(0,i.n)(f,e),(0,i.n)(h,t);var u=(0,i.e)(f,h),o=(0,r.ZF)(u),a=(0,i.f)(f,f,h);return(0,i.e)(a,n)<0?2*Math.PI-o:o}var f=(0,u.c)(),h=(0,u.c)()},11185:function(e,t,n){n.d(t,{MP:function(){return g},vD:function(){return m},qW:function(){return p},WM:function(){return _},o6:function(){return y}});var r=n(15671),i=n(43144),u=n(59896),o=n(70758),a=n(11873),c=n(81949),s=n(98131),f=n(6394),h=n(71353),l=n(67077),d=function(){function e(t,n,i){(0,r.Z)(this,e),this._itemByteSize=t,this._itemCreate=n,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(i/this._itemByteSize)}return(0,i.Z)(e,[{key:"get",value:function(){var e=this;0===this._itemsPtr&&(0,o.Y)((function(){return e._reset()}));for(var t=Math.floor(this._itemsPtr/this._itemsPerBuffer);this._buffers.length<=t;){for(var n=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize),r=0;r<this._itemsPerBuffer;++r)this._items.push(this._itemCreate(n,r*this._itemByteSize));this._buffers.push(n)}return this._items[this._itemsPtr++]}},{key:"_reset",value:function(){for(var e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}},{key:"test",get:function(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(16,f.c,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(24,h.b,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(32,l.a,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(72,a.a,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(128,c.a,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(32,s.c,t)}}]),e}(),v=4*u.Y8.KILOBYTES,p=d.createVec2f64(),_=d.createVec3f64(),y=d.createVec4f64(),g=(d.createMat3f64(),d.createMat4f64()),m=d.createQuatf64()},22526:function(e,t,n){n.d(t,{HL:function(){return o},aj:function(){return a}});var r=n(1413),i=n(25158),u=n(55158);function o(e,t){return t.push(e.buffer),{buffer:e.buffer,layout:c(e.layout)}}function a(e){return function(e){var t=(0,u.U$)();return t.stride=e.stride,t.fieldNames=e.fieldNames,e.fields.forEach((function(e){return t.fields.set(e[0],(0,r.Z)((0,r.Z)({},e[1]),{},{constructor:h(e[1].constructor)}))})),t}(e.layout).createView(e.buffer)}function c(e){var t=new Array;return e.fields.forEach((function(e,n){var i=(0,r.Z)((0,r.Z)({},e),{},{constructor:f(e.constructor)});t.push([n,i])})),{stride:e.stride,fields:t,fieldNames:e.fieldNames}}var s=[i.ly,i.Eu,i.ct,i.ek,i.gK,i.bj,i.oS,i.q6,i.fP,i.Cd,i.ey,i.O1,i.D_,i.xA,i.ne,i.mc,i.av,i.TS,i.mw,i.v6,i.Nu,i.qt,i.G5,i.hu,i.Hz,i.Vs,i.P_,i.ir,i.o7,i.or,i.n1,i.zO,i.Jj,i.wA,i.PP,i.TN];function f(e){return"".concat(e.ElementType,"_").concat(e.ElementCount)}function h(e){return l.get(e)}var l=new Map;s.forEach((function(e){return l.set(f(e),e)}))},36700:function(e,t,n){n.d(t,{x:function(){return h}});var r=n(1413),i=n(15671),u=n(43144),o=n(60136),a=n(29388),c=n(95122),s=n(75691),f=n(61309),h=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){return(0,i.Z)(this,n),t.call(this,(0,r.Z)((0,r.Z)({},e),{},{constraint:new c.Hk(e.targetPoint)}))}return(0,u.Z)(n,[{key:"hints",get:function(){return[new f.n(this.targetPoint,this.isDraped,this.domain)]}}]),n}(s.a)},34953:function(e,t,n){n.r(t),n.d(t,{SceneLayerSnappingSource:function(){return A}});var r=n(74165),i=n(15861),u=n(15671),o=n(43144),a=n(60136),c=n(29388),s=n(27366),f=n(85015),h=n(92026),l=n(66978),d=n(49861),v=(n(25243),n(63780),n(69912)),p=n(41691),_=n(42537),y=n(18722),g=n(46798),m=n(22526),k=n(83715),w=function(e){(0,a.Z)(n,e);var t=(0,c.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,"EdgeProcessingWorker","extract",{extract:function(e){return[e.dataBuffer]},extractComponentsEdgeLocations:function(e){return[e.dataBuffer]},extractEdgeLocations:function(e){return[e.dataBuffer]}},e)}return(0,o.Z)(n,[{key:"process",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,i){var u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=2;break}return e.abrupt("return",(0,k.Kl)(t));case 2:return e.next=4,this.invoke(new b(t),n);case 4:return u=e.sent,e.abrupt("return",this._unpackOutput(u));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"extractEdgeLocations",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.invokeMethod("extractEdgeLocations",new b(t),n);case 2:return i=e.sent,e.abrupt("return",(0,m.aj)(i));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"extractComponentsEdgeLocations",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.invokeMethod("extractComponentsEdgeLocations",new b(t),n);case 2:return i=e.sent,e.abrupt("return",(0,m.aj)(i));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_unpackOutput",value:function(e){return{regular:{instancesData:(0,m.aj)(e.regular.instancesData),lodInfo:{lengths:new Float32Array(e.regular.lodInfo.lengths)}},silhouette:{instancesData:(0,m.aj)(e.silhouette.instancesData),lodInfo:{lengths:new Float32Array(e.silhouette.lodInfo.lengths)}},averageEdgeLength:e.averageEdgeLength}}}]),n}(g.q),b=(0,o.Z)((function e(t){(0,u.Z)(this,e),this.dataBuffer=t.data.buffer,this.writerSettings=t.writerSettings,this.skipDeduplicate=t.skipDeduplicate,this.indices=Array.isArray(t.indices)?t.indices:t.indices.buffer,this.indicesType=Array.isArray(t.indices)?"Array":(0,y.ZY)(t.indices)?"Uint32Array":"Uint16Array",this.indicesLength=t.indicesLength})),Z=n(37762),S=n(71353),x=n(23470),C=n(1700),M=n(95905),P=n(36700),L=function(e){(0,a.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).availability=0,r._ids=new Set,r}return(0,o.Z)(n,[{key:"destroy",value:function(){this._workerHandle.destroy(),this._workerHandle=null}},{key:"initialize",value:function(){var e=this;this._workerHandle=new E(this.schedule,{fetchAllEdgeLocations:function(t,n){return e._fetchAllEdgeLocations(t,n)}})}},{key:"fetchCandidates",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,u,o,a,c,s,f=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.coordinateHelper,u=t.point,o=j,this.renderCoordsHelper.toRenderCoords(u,i.spatialReference,o),a=t.distance,c="number"==typeof a?a:a.distance,e.next=6,this._workerHandle.invoke({bounds:(0,x.f)(o[0],o[1],o[2],c),types:t.types},n);case 6:return s=e.sent,e.abrupt("return",(s.candidates.sort((function(e,t){return e.distance-t.distance})),s.candidates.map((function(e){return f._convertCandidate(i,e)}))));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._ids.add(t.id),e.next=3,this._workerHandle.invokeMethod("add",t,n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._ids.delete(t.id),e.next=3,this._workerHandle.invokeMethod("remove",t,n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_convertCandidate",value:function(e,t){switch(t.type){case"edge":return new M.L({objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),edgeStart:this._convertRenderCoordinate(e,t.start),edgeEnd:this._convertRenderCoordinate(e,t.end),isDraped:!1});case"vertex":return new P.x({objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),isDraped:!1})}}},{key:"_convertRenderCoordinate",value:function(e,t){var n=e.spatialReference,r=(0,S.c)();return this.renderCoordsHelper.fromRenderCoords(t,r,n),(0,C.uc)(r)}},{key:"_fetchAllEdgeLocations",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var u,o,a,c,s,f=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=[],o=[],a=(0,Z.Z)(t.components),e.prev=2,s=(0,r.Z)().mark((function e(){var t,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c.value,a=t.id,s=t.uid,f._ids.has(a)&&u.push((0,i.Z)((0,r.Z)().mark((function e(){var t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.fetchEdgeLocations(a,n.signal);case 2:return t=e.sent,i=t.locations.buffer,e.abrupt("return",(o.push(i),{id:a,uid:s,objectIds:t.objectIds,locations:i,origin:t.origin,type:t.type}));case 5:case"end":return e.stop()}}),e)})))());case 2:case"end":return e.stop()}}),e)})),a.s();case 5:if((c=a.n()).done){e.next=9;break}return e.delegateYield(s(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),a.e(e.t1);case 14:return e.prev=14,a.f(),e.finish(14);case 17:return e.next=19,Promise.all(u);case 19:return e.t2=e.sent.filter((function(e){var t=e.id;return f._ids.has(t)})),e.t3={components:e.t2},e.t4=o,e.abrupt("return",{result:e.t3,transferList:e.t4});case 23:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(p.r);(0,s._)([(0,d.Cb)({constructOnly:!0})],L.prototype,"renderCoordsHelper",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],L.prototype,"fetchEdgeLocations",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],L.prototype,"schedule",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],L.prototype,"availability",void 0),L=(0,s._)([(0,v.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],L);var E=function(e){(0,a.Z)(n,e);var t=(0,c.Z)(n);function n(e,r){return(0,u.Z)(this,n),t.call(this,"SceneLayerSnappingSourceWorker","fetchCandidates",{},e,{strategy:"dedicated",client:r})}return(0,o.Z)(n)}(g.q),j=(0,S.c)(),H=function(e){(0,a.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).availability=1,r._abortController=new AbortController,r}return(0,o.Z)(n,[{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"destroy",value:function(){this._tracker=(0,h.hw)(this._tracker),this._abortController=(0,h.IM)(this._abortController)}},{key:"initialize",value:function(){var e=this,t=this.view.resourceController;this._edgeWorker=new w((function(e){return t.immediate.schedule(e)})),this._workerHandle=new L({renderCoordsHelper:this.view.renderCoordsHelper,schedule:function(e){return t.immediate.schedule(e)},fetchEdgeLocations:function(){var t=(0,i.Z)((0,r.Z)().mark((function t(n,i){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,h.Wi)(e._tracker)){t.next=2;break}throw new Error("tracker-not-initialized");case 2:return t.abrupt("return",e._tracker.fetchEdgeLocations(n,e._edgeWorker,i));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}),this.updatingHandles.addPromise(this._setupLayerView()),this.handles.add([(0,_.ed)(this._workerHandle),(0,_.ed)(this._edgeWorker)])}},{key:"fetchCandidates",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._workerHandle.fetchCandidates(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){}},{key:"_setupLayerView",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t,n,i=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.destroyed){e.next=2;break}return e.abrupt("return");case 2:return t=(0,h.yw)(this._abortController,(function(e){return e.signal})),e.next=5,this.getLayerView();case 5:n=e.sent,(0,h.Wi)(n)||(0,l.Hc)(t)||(this._tracker=n.trackSnappingSources({add:function(e,n){i.updatingHandles.addPromise(i._workerHandle.add({id:e,bounds:n},t))},remove:function(e){i.updatingHandles.addPromise(i._workerHandle.remove({id:e},t))}}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(p.r);(0,s._)([(0,d.Cb)({constructOnly:!0})],H.prototype,"getLayerView",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],H.prototype,"view",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],H.prototype,"updating",null),(0,s._)([(0,d.Cb)({readOnly:!0})],H.prototype,"availability",void 0),H=(0,s._)([(0,v.j)("esri.views.interactive.snapping.featureSources.I3SSnappingSource")],H);var A=function(e){(0,a.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).availability=1,r._i3sSources=[],r}return(0,o.Z)(n,[{key:"updating",get:function(){return this._i3sSources.some((function(e){return e.updating}))}},{key:"destroy",value:function(){this._i3sSources.forEach((function(e){return e.destroy()})),this._i3sSources.length=0}},{key:"initialize",value:function(){var e=this.view,t=this.layerSource.layer;this._i3sSources="building-scene"===t.type?this._getBuildingSceneI3SSources(e,t):[this._getSceneLayerI3SSource(e,t)]}},{key:"fetchCandidates",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this._i3sSources.map((function(e){return e.fetchCandidates(t,n)})));case 2:return i=e.sent,e.abrupt("return",((0,l.k_)(n),i.flat()));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){this._i3sSources.forEach((function(e){return e.refresh()}))}},{key:"_getBuildingSceneI3SSources",value:function(e,t){return t.allSublayers.toArray().map((function(n){return"building-component"===n.type?new H({getLayerView:function(){var u=(0,i.Z)((0,r.Z)().mark((function i(){return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.whenLayerView(t);case 2:return r.abrupt("return",r.sent.whenSublayerView(n));case 3:case"end":return r.stop()}}),i)})));return function(){return u.apply(this,arguments)}}(),view:e}):null})).filter(h.pC)}},{key:"_getSceneLayerI3SSource",value:function(e,t){return new H({getLayerView:function(){var n=(0,i.Z)((0,r.Z)().mark((function n(){var i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.whenLayerView(t);case 2:return i=n.sent,n.abrupt("return","scene-layer-graphics-3d"===i.type?void 0:i);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),view:e})}}]),n}(f.Z);(0,s._)([(0,d.Cb)({constructOnly:!0})],A.prototype,"layerSource",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],A.prototype,"view",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],A.prototype,"updating",null),(0,s._)([(0,d.Cb)({readOnly:!0})],A.prototype,"availability",void 0),A=(0,s._)([(0,v.j)("esri.views.interactive.snapping.featureSources.SceneLayerSnappingSource")],A)},61309:function(e,t,n){n.d(t,{n:function(){return c}});var r=n(15671),i=n(43144),u=n(60136),o=n(29388),a=n(11186),c=function(e){(0,u.Z)(n,e);var t=(0,o.Z)(n);function n(e,i,u){var o;return(0,r.Z)(this,n),(o=t.call(this,i,u)).point=e,o}return(0,i.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&(0,a.k)(this.point,e.point)}}]),n}(n(55054).r)}}]);
//# sourceMappingURL=4953.07a73a2e.chunk.js.map