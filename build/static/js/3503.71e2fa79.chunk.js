"use strict";(self.webpackChunkcommonlands_web=self.webpackChunkcommonlands_web||[]).push([[3503],{53503:function(i,t,e){e.r(t),e.d(t,{default:function(){return S}});var r=e(93433),n=e(37762),a=e(15671),h=e(43144),s=e(60136),o=e(29388),c=e(27366),l=(e(51508),e(91505)),u=e(100),p=e(84652),v=e(92026),d=e(94172),f=e(49861),y=(e(25243),e(69912)),g=e(93655),_=e(20008),w=e(74982),m=e(83089),k=(0,h.Z)((function i(t,e,r,n,h){(0,a.Z)(this,i),this.graphic=t,this.index=e,this.x=r,this.y=n,this.viewEvent=h,this.type="graphic-click"})),G=(0,h.Z)((function i(t,e,r,n,h){(0,a.Z)(this,i),this.graphic=t,this.index=e,this.x=r,this.y=n,this.viewEvent=h,this.type="graphic-double-click"})),b=function(){function i(t,e,r,n,h,s,o,c,l,u){(0,a.Z)(this,i),this.graphic=t,this.allGraphics=e,this.index=r,this.x=n,this.y=h,this.dx=s,this.dy=o,this.totalDx=c,this.totalDy=l,this.viewEvent=u,this.defaultPrevented=!1,this.type="graphic-move-start"}return(0,h.Z)(i,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),i}(),x=function(){function i(t,e,r,n,h,s,o,c,l,u){(0,a.Z)(this,i),this.graphic=t,this.allGraphics=e,this.index=r,this.x=n,this.y=h,this.dx=s,this.dy=o,this.totalDx=c,this.totalDy=l,this.viewEvent=u,this.defaultPrevented=!1,this.type="graphic-move"}return(0,h.Z)(i,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),i}(),Z=function(){function i(t,e,r,n,h,s,o,c,l,u){(0,a.Z)(this,i),this.graphic=t,this.allGraphics=e,this.index=r,this.x=n,this.y=h,this.dx=s,this.dy=o,this.totalDx=c,this.totalDy=l,this.viewEvent=u,this.defaultPrevented=!1,this.type="graphic-move-stop"}return(0,h.Z)(i,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),i}(),E=(0,h.Z)((function i(t,e,r,n,h){(0,a.Z)(this,i),this.graphic=t,this.index=e,this.x=r,this.y=n,this.viewEvent=h,this.type="graphic-pointer-over"})),O=(0,h.Z)((function i(t,e,r,n,h){(0,a.Z)(this,i),this.graphic=t,this.index=e,this.x=r,this.y=n,this.viewEvent=h,this.type="graphic-pointer-out"})),H=(0,h.Z)((function i(t,e,r,n,h){(0,a.Z)(this,i),this.graphic=t,this.index=e,this.x=r,this.y=n,this.viewEvent=h,this.type="graphic-pointer-down"})),P=(0,h.Z)((function i(t,e,r,n,h){(0,a.Z)(this,i),this.graphic=t,this.index=e,this.x=r,this.y=n,this.viewEvent=h,this.type="graphic-pointer-up"})),C=e(1614),D=e(2346),M=e(72612),T=e(16072),A=e(16851),U=e(61459),I="indicator-symbols",L=function(i){(0,s.Z)(e,i);var t=(0,o.Z)(e);function e(i){var r;return(0,a.Z)(this,e),(r=t.call(this,i))._activeGraphic=null,r._dragEvent=null,r._handles=new u.Z,r._hoverGraphic=null,r._indicators=[],r._initialDragGeometry=null,r._viewHandles=new u.Z,r._manipulators=[],r._layerViews=null,r.type="graphic-mover",r.callbacks={onGraphicClick:function(){},onGraphicDoubleClick:function(){},onGraphicMoveStart:function(){},onGraphicMove:function(){},onGraphicMoveStop:function(){},onGraphicPointerOver:function(){},onGraphicPointerOut:function(){},onGraphicPointerDown:function(){},onGraphicPointerUp:function(){}},r.enableMoveAllGraphics=!1,r.graphics=[],r.indicatorsEnabled=!1,r.layer=new g.Z({listMode:"hide",internal:!0,title:"GraphicMover highlight layer"}),r.view=null,r}return(0,h.Z)(e,[{key:"initialize",value:function(){var i=this;(0,m.p)(this.view,this.layer),this._highlightHelper=new w.Z({view:this.view}),this.refresh(),this._handles.add([(0,d.YP)((function(){var t;return[i.graphics,null===(t=i.graphics)||void 0===t?void 0:t.length]}),(function(){return i.refresh()})),(0,d.gx)((function(){var t;return null===(t=i.view)||void 0===t?void 0:t.ready}),(function(){i._viewHandles.add([i.view.on("immediate-click",(function(t){return i._clickHandler(t)}),C.f.TOOL),i.view.on("double-click",(function(t){return i._doubleClickHandler(t)}),C.f.TOOL),i.view.on("pointer-down",(function(t){return i._pointerDownHandler(t)}),C.f.TOOL),i.view.on("pointer-move",(function(t){return i._pointerMoveHandler(t)}),C.f.TOOL),i.view.on("pointer-up",(function(t){return i._pointerUpHandler(t)}),C.f.TOOL),i.view.on("drag",(function(t){return i._dragHandler(t)}),C.f.TOOL),i.view.on("key-down",(function(t){return i._keyDownHandler(t)}),C.f.TOOL)])}),{once:!0,initial:!0}),(0,d.YP)((function(){return i.view}),(function(t){i._highlightHelper.removeAll(),i._highlightHelper.view=t}))])}},{key:"destroy",value:function(){var i;this._removeIndicators(),null!==(i=this.view.map)&&void 0!==i&&i.remove(this.layer),this.layer.destroy(),this.reset(),this._manipulators.forEach((function(i){return i.destroy()})),this._manipulators=null,this._handles=(0,v.SC)(this._handles),this._viewHandles=(0,v.SC)(this._viewHandles)}},{key:"highlightsEnabled",set:function(i){var t,e;null!==(t=this._highlightHelper)&&void 0!==t&&t.removeAll(),this._set("highlightsEnabled",i),i&&(null===(e=this._highlightHelper)||void 0===e||e.add(this.graphics))}},{key:"state",get:function(){var i=!!this.get("view.ready"),t=!!this.get("graphics.length"),e=this._activeGraphic;return i&&t?e?"moving":"active":i?"ready":"disabled"}},{key:"refresh",value:function(){this.reset(),this._setup()}},{key:"reset",value:function(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null,this._highlightHelper.removeAll()}},{key:"updateGeometry",value:function(i,t){var e=this.graphics[i];e&&(e.set("geometry",t),this._setUpIndicators())}},{key:"_setup",value:function(){this._setUpHighlights(),this._setUpIndicators(),this._setUpManipulators(),this._syncLayerViews()}},{key:"_clickHandler",value:function(i){var t=this._findTargetGraphic((0,M.vT)(i));if(t){var e=new k(t,this.graphics.indexOf(t),i.x,i.y,i);this.emit("graphic-click",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e)}}},{key:"_doubleClickHandler",value:function(i){var t=this._findTargetGraphic((0,M.vT)(i));if(t){var e=new G(t,this.graphics.indexOf(t),i.x,i.y,i);this.emit("graphic-double-click",e),this.callbacks.onGraphicDoubleClick&&this.callbacks.onGraphicDoubleClick(e)}}},{key:"_pointerDownHandler",value:function(i){var t=this._findTargetGraphic((0,M.vT)(i));if(t){this._activeGraphic=t;var e=i.x,r=i.y,n=new H(t,this.graphics.indexOf(t),e,r,i);this.emit("graphic-pointer-down",n),this.callbacks.onGraphicPointerDown&&this.callbacks.onGraphicPointerDown(n)}else this._activeGraphic=null}},{key:"_pointerUpHandler",value:function(i){if(this._activeGraphic){var t=i.x,e=i.y,r=this.graphics.indexOf(this._activeGraphic),n=new P(this._activeGraphic,r,t,e,i);this.emit("graphic-pointer-up",n),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(n)}}},{key:"_pointerMoveHandler",value:function(i){if(!this._dragEvent){var t=this._findTargetGraphic((0,M.vT)(i));if(t){var e=i.x,r=i.y;if(this._hoverGraphic){if(this._hoverGraphic===t)return;var n=this.graphics.indexOf(this._hoverGraphic),a=new O(this.graphics[n],n,e,r,i);this._hoverGraphic=null,this.emit("graphic-pointer-out",a),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(a)}var h=this.graphics.indexOf(t),s=new E(t,h,e,r,i);return this._hoverGraphic=t,this.emit("graphic-pointer-over",s),void(this.callbacks.onGraphicPointerOver&&this.callbacks.onGraphicPointerOver(s))}if(this._hoverGraphic){var o=i.x,c=i.y,l=this.graphics.indexOf(this._hoverGraphic),u=new O(this.graphics[l],l,o,c,i);this._hoverGraphic=null,this.emit("graphic-pointer-out",u),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(u)}}}},{key:"_dragHandler",value:function(i){var t=this;if(("start"===i.action||this._dragEvent)&&this._activeGraphic&&this._activeGraphic.geometry){"start"===i.action&&this._removeIndicators(),i.stopPropagation();var e=i.action,r=i.x,n=i.y,a=this.graphics.indexOf(this._activeGraphic),h=this._dragEvent?r-this._dragEvent.x:0,s=this._dragEvent?n-this._dragEvent.y:0,o=r-i.origin.x,c=n-i.origin.y,l="start"===e?this._activeGraphic.geometry:this._initialDragGeometry,u=(0,_.e7)(l,o,c,this.view);if(this._activeGraphic.geometry=u,this.enableMoveAllGraphics&&this.graphics.forEach((function(i){i!==t._activeGraphic&&(i.geometry=(0,_.e7)(i.geometry,h,s,t.view))})),this._dragEvent=i,"start"===e){this._initialDragGeometry=(0,p.d9)(l);var v=new b(this._activeGraphic,this.graphics,a,r,n,h,s,o,c,i);this.emit("graphic-move-start",v),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(v),v.defaultPrevented&&this._activeGraphic.set("geometry",l)}else if("update"===e){var d=new x(this._activeGraphic,this.graphics,a,r,n,h,s,o,c,i);this.emit("graphic-move",d),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(d),d.defaultPrevented&&(this._activeGraphic.geometry=l)}else{var f=new Z(this._activeGraphic,this.graphics,a,r,n,h,s,o,c,i);this._dragEvent=null,this._activeGraphic=null,this._setUpIndicators(),this.emit("graphic-move-stop",f),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(f),f.defaultPrevented&&(this.graphics[a].set("geometry",this._initialDragGeometry),this._setUpIndicators()),this._initialDragGeometry=null}}}},{key:"_keyDownHandler",value:function(i){"a"!==i.key&&"d"!==i.key&&"n"!==i.key||"moving"!==this.state||i.stopPropagation()}},{key:"_findTargetGraphic",value:function(i){var t=this,e=this.view.toMap(i),r=null,n=Number.MAX_VALUE;this._syncLayerViews();var a=this._layerViews.flatMap((function(i){return"graphicsViews"in i?Array.from(i.graphicsViews(),(function(i){return i.hitTest(e)})).flat():i.graphicsView.hitTest(e)})).filter((function(i){return t.graphics.includes(i)}));return a.length?a[0]:(this._manipulators.forEach((function(t){var e=t.intersectionDistance(i);(0,v.pC)(e)&&e<n&&(n=e,r=t.graphic)})),r)}},{key:"_syncLayerViews",value:function(){this._layerViews=[];var i,t=new Set,e=(0,n.Z)(this.graphics);try{for(e.s();!(i=e.n()).done;){var a=i.value,h=(0,m.j)(this.view,a.layer);h&&t.add(h)}}catch(s){e.e(s)}finally{e.f()}this._layerViews=(0,r.Z)(t)}},{key:"_setUpManipulators",value:function(){var i=this.graphics,t=this.view;this._manipulators.forEach((function(i){return i.destroy()})),this._manipulators=null!==i&&void 0!==i&&i.length?i.map((function(i){return new D.L({graphic:i,view:t})})):[]}},{key:"_setUpHighlights",value:function(){this.highlightsEnabled&&this._highlightHelper.add(this.graphics)}},{key:"_setUpIndicators",value:function(){var i=this;if(this._removeIndicators(),this.indicatorsEnabled){var t,e=(0,n.Z)(this.graphics);try{var r=function(){var e=t.value,r=e.clone();r.symbol=i._getSymbolForIndicator(e),i._indicators.push(r),i._handles.add((0,d.YP)((function(){return e.symbol}),(function(){return i._setUpIndicators()})),I)};for(e.s();!(t=e.n()).done;)r()}catch(a){e.e(a)}finally{e.f()}this.layer.addMany(this._indicators)}}},{key:"_removeIndicators",value:function(){this._handles.remove(I),this._indicators.length&&(this.layer.removeMany(this._indicators),this._indicators.forEach((function(i){return i.destroy()})),this._indicators=[])}},{key:"_getSymbolForIndicator",value:function(i){if((0,v.Wi)(i.symbol))return null;switch(i.symbol.type){case"cim":return new T.Z({style:"circle",size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"picture-marker":var t=i.symbol,e=t.xoffset,r=t.yoffset,n=t.height,a=t.width,h=n===a?a:Math.max(n,a);return new T.Z({xoffset:e,yoffset:r,size:h,style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"simple-marker":var s=i.symbol,o=s.xoffset,c=s.yoffset,l=s.size,u=s.style;return new T.Z({xoffset:o,yoffset:c,style:"circle"===u?"circle":"square",size:l+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"simple-fill":return new U.Z({color:[0,0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case"simple-line":return new A.Z({color:[255,127,0,1],style:"dash",width:1});case"text":var p=i.symbol,d=p.xoffset,f=p.yoffset;return new T.Z({xoffset:d,yoffset:f,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});default:return null}}}]),e}(l.Z.EventedAccessor);(0,c._)([(0,f.Cb)()],L.prototype,"_activeGraphic",void 0),(0,c._)([(0,f.Cb)({readOnly:!0})],L.prototype,"type",void 0),(0,c._)([(0,f.Cb)()],L.prototype,"callbacks",void 0),(0,c._)([(0,f.Cb)()],L.prototype,"enableMoveAllGraphics",void 0),(0,c._)([(0,f.Cb)()],L.prototype,"graphics",void 0),(0,c._)([(0,f.Cb)({value:!1})],L.prototype,"highlightsEnabled",null),(0,c._)([(0,f.Cb)()],L.prototype,"indicatorsEnabled",void 0),(0,c._)([(0,f.Cb)()],L.prototype,"layer",void 0),(0,c._)([(0,f.Cb)({readOnly:!0})],L.prototype,"state",null),(0,c._)([(0,f.Cb)()],L.prototype,"view",void 0);var S=L=(0,c._)([(0,y.j)("esri.views.draw.support.GraphicMover")],L)},74982:function(i,t,e){e.d(t,{Z:function(){return d}});var r=e(15671),n=e(43144),a=e(60136),h=e(29388),s=e(27366),o=e(41691),c=e(49861),l=(e(25243),e(63780),e(69912)),u=e(83089),p=e(69787),v=function(i){(0,a.Z)(e,i);var t=(0,h.Z)(e);function e(i){var n;return(0,r.Z)(this,e),(n=t.call(this,i)).view=null,n}return(0,n.Z)(e,[{key:"count",get:function(){return this.handles.size}},{key:"add",value:function(i){var t=this,e=Array.isArray(i)?i:[i];null!=i&&e&&e.length&&e.forEach((function(i){return t._highlight(i)}))}},{key:"remove",value:function(i){var t=this,e=Array.isArray(i)?i:[i];null!=i&&e&&e.length&&e.forEach((function(i){return t._unhighlight(i)}))}},{key:"removeAll",value:function(){this.handles.removeAll()}},{key:"_highlight",value:function(i){var t=(0,u.j)(this.view,i.layer);(0,p.tl)(t)&&this.handles.add(t.highlight(i),"feature-".concat(i.getObjectId()))}},{key:"_unhighlight",value:function(i){i&&this.handles.remove("feature-".concat(i.getObjectId()))}}]),e}(o.r);(0,s._)([(0,c.Cb)({readOnly:!0})],v.prototype,"count",null),(0,s._)([(0,c.Cb)()],v.prototype,"view",void 0),(0,s._)([(0,c.Cb)()],v.prototype,"add",null);var d=v=(0,s._)([(0,l.j)("esri.views.draw.support.HighlightHelper")],v)}}]);
//# sourceMappingURL=3503.71e2fa79.chunk.js.map